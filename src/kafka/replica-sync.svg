<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: replica_sync Pages: 1 -->
<svg width="2663pt" height="474pt"
 viewBox="0.00 0.00 2663.00 474.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 470)">
<title>replica_sync</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-470 2659,-470 2659,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_BlockingSend</title>
<polygon fill="none" stroke="#000000" points="1449,-53 1449,-161 1617,-161 1617,-53 1449,-53"/>
<text text-anchor="middle" x="1533" y="-141" font-family="Times,serif" font-size="20.00" fill="#000000">BlockingSend</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_FetchSessionHandler</title>
<polygon fill="none" stroke="#000000" points="1193.5,-8 1193.5,-90 1378.5,-90 1378.5,-8 1193.5,-8"/>
<text text-anchor="middle" x="1286" y="-70" font-family="Times,serif" font-size="20.00" fill="#000000">FetchSessionHandler</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_fetcherThread</title>
<polygon fill="none" stroke="#000000" points="383,-98 383,-314 1377,-314 1377,-98 383,-98"/>
<text text-anchor="middle" x="880" y="-294" font-family="Times,serif" font-size="20.00" fill="#000000">ReplicaFetcherThread</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_replicaFetcherManager</title>
<polygon fill="none" stroke="#000000" points="162,-322 162,-458 689,-458 689,-322 162,-322"/>
<text text-anchor="middle" x="425.5" y="-438" font-family="Times,serif" font-size="20.00" fill="#000000">replicaFetcherManager</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_ZkServer</title>
<polygon fill="none" stroke="#000000" points="2493,-11 2493,-173 2647,-173 2647,-11 2493,-11"/>
<text text-anchor="middle" x="2570" y="-153" font-family="Times,serif" font-size="20.00" fill="#000000">ZkServer</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_log</title>
<polygon fill="none" stroke="#000000" points="2021.5,-192 2021.5,-274 2301,-274 2301,-192 2021.5,-192"/>
<text text-anchor="middle" x="2161.25" y="-254" font-family="Times,serif" font-size="20.00" fill="#000000">log</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_PartionLeaderBroker</title>
<polygon fill="none" stroke="#000000" points="1988,-30 1988,-184 2481,-184 2481,-30 1988,-30"/>
<text text-anchor="middle" x="2234.5" y="-164" font-family="Times,serif" font-size="20.00" fill="#000000">Broker: PartionLeader </text>
</g>
<g id="clust14" class="cluster">
<title>cluster_Partition</title>
<polygon fill="none" stroke="#000000" points="2202,-51 2202,-133 2473,-133 2473,-51 2202,-51"/>
<text text-anchor="middle" x="2337.5" y="-113" font-family="Times,serif" font-size="20.00" fill="#000000">Partition</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_ReplicaManager</title>
<polygon fill="none" stroke="#000000" points="1996,-38 1996,-146 2182,-146 2182,-38 1996,-38"/>
<text text-anchor="middle" x="2089" y="-126" font-family="Times,serif" font-size="20.00" fill="#000000">ReplicaManager</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_Partition</title>
<polygon fill="none" stroke="#000000" points="1398,-185 1398,-267 1976,-267 1976,-185 1398,-185"/>
<text text-anchor="middle" x="1687" y="-247" font-family="Times,serif" font-size="20.00" fill="#000000">Partition</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_replicaManager</title>
<polygon fill="none" stroke="#000000" points="0,-322 0,-404 142,-404 142,-322 0,-322"/>
<text text-anchor="middle" x="71" y="-384" font-family="Times,serif" font-size="20.00" fill="#000000">replicaManager</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_KafkaApi</title>
<polygon fill="none" stroke="#000000" points="1761,-55 1761,-137 1903,-137 1903,-55 1761,-55"/>
<text text-anchor="middle" x="1832" y="-117" font-family="Times,serif" font-size="20.00" fill="#000000">KafkaApi</text>
</g>
<!-- leaderEndpoint_sendRequest -->
<g id="node1" class="node">
<title>leaderEndpoint_sendRequest</title>
<polygon fill="none" stroke="#000000" points="1457,-61.5 1457,-122.5 1609,-122.5 1609,-61.5 1457,-61.5"/>
<text text-anchor="middle" x="1533" y="-107.3" font-family="Times,serif" font-size="14.00" fill="#000000">sendRequest</text>
<polyline fill="none" stroke="#000000" points="1457,-99.5 1609,-99.5 "/>
<text text-anchor="start" x="1465" y="-84.3" font-family="Times,serif" font-size="14.00" fill="#000000">向partionLeader </text>
<text text-anchor="middle" x="1533" y="-69.3" font-family="Times,serif" font-size="14.00" fill="#000000"> 发送fetchMessage请求</text>
</g>
<!-- handleFetchRequest -->
<g id="node27" class="node">
<title>handleFetchRequest</title>
<polygon fill="none" stroke="#000000" points="1895,-99 1769,-99 1769,-63 1895,-63 1895,-99"/>
<text text-anchor="middle" x="1832" y="-77.3" font-family="Times,serif" font-size="14.00" fill="#000000">handleFetchRequest</text>
</g>
<!-- leaderEndpoint_sendRequest&#45;&gt;handleFetchRequest -->
<g id="edge26" class="edge">
<title>leaderEndpoint_sendRequest&#45;&gt;handleFetchRequest</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1609.224,-89.1958C1655.0675,-87.5092 1713.124,-85.3734 1758.4758,-83.7049"/>
<polygon fill="#000000" stroke="#000000" points="1758.6724,-87.2001 1768.5369,-83.3348 1758.415,-80.2049 1758.6724,-87.2001"/>
</g>
<!-- FetchSessionHandler -->
<g id="node2" class="node">
<title>FetchSessionHandler</title>
<polygon fill="none" stroke="#000000" points="1351.5,-52 1220.5,-52 1220.5,-16 1351.5,-16 1351.5,-52"/>
<text text-anchor="middle" x="1286" y="-30.3" font-family="Times,serif" font-size="14.00" fill="#000000">FetchSessionHandler</text>
</g>
<!-- addPartitions -->
<g id="node3" class="node">
<title>addPartitions</title>
<polygon fill="none" stroke="#000000" points="479,-276 391,-276 391,-240 479,-240 479,-276"/>
<text text-anchor="middle" x="435" y="-254.3" font-family="Times,serif" font-size="14.00" fill="#000000">addPartitions</text>
</g>
<!-- ReplicaFetcherThread -->
<g id="node4" class="node">
<title>ReplicaFetcherThread</title>
<polygon fill="none" stroke="#000000" points="854,-276 717,-276 717,-240 854,-240 854,-276"/>
<text text-anchor="middle" x="785.5" y="-254.3" font-family="Times,serif" font-size="14.00" fill="#000000">ReplicaFetcherThread</text>
</g>
<!-- fetcherThread_start -->
<g id="node5" class="node">
<title>fetcherThread_start</title>
<polygon fill="none" stroke="#000000" points="644,-249 590,-249 590,-213 644,-213 644,-249"/>
<text text-anchor="middle" x="617" y="-227.3" font-family="Times,serif" font-size="14.00" fill="#000000">start</text>
</g>
<!-- doWork -->
<g id="node6" class="node">
<title>doWork</title>
<polygon fill="none" stroke="#000000" points="816.5,-222 754.5,-222 754.5,-186 816.5,-186 816.5,-222"/>
<text text-anchor="middle" x="785.5" y="-200.3" font-family="Times,serif" font-size="14.00" fill="#000000">doWork</text>
</g>
<!-- fetcherThread_start&#45;&gt;doWork -->
<g id="edge1" class="edge">
<title>fetcherThread_start&#45;&gt;doWork</title>
<path fill="none" stroke="#000000" d="M644.0724,-226.662C671.1527,-222.3227 713.1555,-215.5923 744.3593,-210.5923"/>
<polygon fill="#000000" stroke="#000000" points="745.17,-214.0071 754.4902,-208.9689 744.0624,-207.0953 745.17,-214.0071"/>
</g>
<!-- maybeTruncate -->
<g id="node8" class="node">
<title>maybeTruncate</title>
<polygon fill="none" stroke="#000000" points="991,-168 890,-168 890,-132 991,-132 991,-168"/>
<text text-anchor="middle" x="940.5" y="-146.3" font-family="Times,serif" font-size="14.00" fill="#000000">maybeTruncate</text>
</g>
<!-- doWork&#45;&gt;maybeTruncate -->
<g id="edge2" class="edge">
<title>doWork&#45;&gt;maybeTruncate</title>
<path fill="none" stroke="#000000" d="M816.8666,-193.0723C835.129,-186.7099 858.7651,-178.4754 880.472,-170.913"/>
<polygon fill="#000000" stroke="#000000" points="881.6665,-174.2032 889.9583,-167.6081 879.3635,-167.5929 881.6665,-174.2032"/>
</g>
<!-- maybeFetch -->
<g id="node9" class="node">
<title>maybeFetch</title>
<polygon fill="none" stroke="#000000" points="982,-222 899,-222 899,-186 982,-186 982,-222"/>
<text text-anchor="middle" x="940.5" y="-200.3" font-family="Times,serif" font-size="14.00" fill="#000000">maybeFetch</text>
</g>
<!-- doWork&#45;&gt;maybeFetch -->
<g id="edge3" class="edge">
<title>doWork&#45;&gt;maybeFetch</title>
<path fill="none" stroke="#000000" d="M816.8666,-204C837.4407,-204 864.835,-204 888.6076,-204"/>
<polygon fill="#000000" stroke="#000000" points="888.8896,-207.5001 898.8896,-204 888.8896,-200.5001 888.8896,-207.5001"/>
</g>
<!-- fetchFromLeader -->
<g id="node7" class="node">
<title>fetchFromLeader</title>
<polygon fill="#f38181" stroke="#000000" points="1218.5,-106.5 1218.5,-167.5 1353.5,-167.5 1353.5,-106.5 1218.5,-106.5"/>
<text text-anchor="middle" x="1286" y="-152.3" font-family="Times,serif" font-size="14.00" fill="#000000">fetchFromLeader</text>
<polyline fill="none" stroke="#000000" points="1218.5,-144.5 1353.5,-144.5 "/>
<text text-anchor="start" x="1226.5" y="-129.3" font-family="Times,serif" font-size="14.00" fill="#000000">向partionLeader发送</text>
<text text-anchor="start" x="1226.5" y="-114.3" font-family="Times,serif" font-size="14.00" fill="#000000"> fetchMessage请求</text>
</g>
<!-- fetchFromLeader&#45;&gt;leaderEndpoint_sendRequest -->
<g id="edge9" class="edge">
<title>fetchFromLeader&#45;&gt;leaderEndpoint_sendRequest</title>
<path fill="none" stroke="#000000" d="M1353.8205,-124.644C1382.4339,-119.4311 1416.0907,-113.2993 1446.4622,-107.766"/>
<polygon fill="#000000" stroke="#000000" points="1447.4135,-111.1504 1456.6242,-105.9146 1446.1588,-104.2637 1447.4135,-111.1504"/>
</g>
<!-- buildFetch -->
<g id="node10" class="node">
<title>buildFetch</title>
<polygon fill="none" stroke="#000000" points="1129.5,-155 1055.5,-155 1055.5,-119 1129.5,-119 1129.5,-155"/>
<text text-anchor="middle" x="1092.5" y="-133.3" font-family="Times,serif" font-size="14.00" fill="#000000">buildFetch</text>
</g>
<!-- maybeFetch&#45;&gt;buildFetch -->
<g id="edge4" class="edge">
<title>maybeFetch&#45;&gt;buildFetch</title>
<path fill="none" stroke="#000000" d="M981.6334,-185.8688C1001.6093,-177.0637 1025.6881,-166.45 1046.2948,-157.3667"/>
<polygon fill="#000000" stroke="#000000" points="1047.7525,-160.5492 1055.4913,-153.3131 1044.929,-154.1439 1047.7525,-160.5492"/>
</g>
<!-- processFetchRequest -->
<g id="node11" class="node">
<title>processFetchRequest</title>
<polygon fill="none" stroke="#000000" points="1158,-222 1027,-222 1027,-186 1158,-186 1158,-222"/>
<text text-anchor="middle" x="1092.5" y="-200.3" font-family="Times,serif" font-size="14.00" fill="#000000">processFetchRequest</text>
</g>
<!-- maybeFetch&#45;&gt;processFetchRequest -->
<g id="edge5" class="edge">
<title>maybeFetch&#45;&gt;processFetchRequest</title>
<path fill="none" stroke="#000000" d="M982.0347,-204C992.8161,-204 1004.7715,-204 1016.7196,-204"/>
<polygon fill="#000000" stroke="#000000" points="1016.7285,-207.5001 1026.7284,-204 1016.7284,-200.5001 1016.7285,-207.5001"/>
</g>
<!-- buildFetch&#45;&gt;FetchSessionHandler -->
<g id="edge10" class="edge">
<title>buildFetch&#45;&gt;FetchSessionHandler</title>
<path fill="none" stroke="#000000" d="M1126.6485,-118.8228C1159.0172,-101.5929 1207.7689,-75.6424 1242.8208,-56.9843"/>
<polygon fill="#000000" stroke="#000000" points="1244.6853,-59.9569 1251.868,-52.1685 1241.3961,-53.7777 1244.6853,-59.9569"/>
</g>
<!-- processFetchRequest&#45;&gt;fetchFromLeader -->
<g id="edge6" class="edge">
<title>processFetchRequest&#45;&gt;fetchFromLeader</title>
<path fill="none" stroke="#000000" d="M1144.609,-185.9571C1164.4031,-179.1033 1187.39,-171.144 1209.0033,-163.6603"/>
<polygon fill="#000000" stroke="#000000" points="1210.189,-166.9537 1218.4934,-160.3744 1207.8986,-160.339 1210.189,-166.9537"/>
</g>
<!-- processPartitionData -->
<g id="node12" class="node">
<title>processPartitionData</title>
<polygon fill="none" stroke="#000000" points="1350.5,-222 1221.5,-222 1221.5,-186 1350.5,-186 1350.5,-222"/>
<text text-anchor="middle" x="1286" y="-200.3" font-family="Times,serif" font-size="14.00" fill="#000000">processPartitionData</text>
</g>
<!-- processFetchRequest&#45;&gt;processPartitionData -->
<g id="edge7" class="edge">
<title>processFetchRequest&#45;&gt;processPartitionData</title>
<path fill="none" stroke="#000000" d="M1158.0103,-204C1175.0576,-204 1193.5545,-204 1211.0484,-204"/>
<polygon fill="#000000" stroke="#000000" points="1211.2142,-207.5001 1221.2142,-204 1211.2141,-200.5001 1211.2142,-207.5001"/>
</g>
<!-- handlePartitionsWithErrors -->
<g id="node13" class="node">
<title>handlePartitionsWithErrors</title>
<polygon fill="none" stroke="#000000" points="1369,-276 1203,-276 1203,-240 1369,-240 1369,-276"/>
<text text-anchor="middle" x="1286" y="-254.3" font-family="Times,serif" font-size="14.00" fill="#000000">handlePartitionsWithErrors</text>
</g>
<!-- processFetchRequest&#45;&gt;handlePartitionsWithErrors -->
<g id="edge8" class="edge">
<title>processFetchRequest&#45;&gt;handlePartitionsWithErrors</title>
<path fill="none" stroke="#000000" d="M1157.2017,-222.0563C1174.6294,-226.9198 1193.621,-232.2198 1211.5348,-237.219"/>
<polygon fill="#000000" stroke="#000000" points="1210.7865,-240.6438 1221.3593,-239.9607 1212.6681,-233.9015 1210.7865,-240.6438"/>
</g>
<!-- appendRecordsToFollowerOrFutureReplica -->
<g id="node14" class="node">
<title>appendRecordsToFollowerOrFutureReplica</title>
<polygon fill="none" stroke="#000000" points="1660,-229 1406,-229 1406,-193 1660,-193 1660,-229"/>
<text text-anchor="middle" x="1533" y="-207.3" font-family="Times,serif" font-size="14.00" fill="#000000">appendRecordsToFollowerOrFutureReplica</text>
</g>
<!-- processPartitionData&#45;&gt;appendRecordsToFollowerOrFutureReplica -->
<g id="edge11" class="edge">
<title>processPartitionData&#45;&gt;appendRecordsToFollowerOrFutureReplica</title>
<path fill="none" stroke="#000000" d="M1350.5737,-205.83C1364.5268,-206.2255 1379.7907,-206.658 1395.3584,-207.0992"/>
<polygon fill="#000000" stroke="#000000" points="1395.5265,-210.6053 1405.6216,-207.3901 1395.7248,-203.6081 1395.5265,-210.6053"/>
</g>
<!-- doAppendRecordsToFollowerOrFutureReplica -->
<g id="node25" class="node">
<title>doAppendRecordsToFollowerOrFutureReplica</title>
<polygon fill="none" stroke="#000000" points="1968,-229 1696,-229 1696,-193 1968,-193 1968,-229"/>
<text text-anchor="middle" x="1832" y="-207.3" font-family="Times,serif" font-size="14.00" fill="#000000">doAppendRecordsToFollowerOrFutureReplica</text>
</g>
<!-- appendRecordsToFollowerOrFutureReplica&#45;&gt;doAppendRecordsToFollowerOrFutureReplica -->
<g id="edge21" class="edge">
<title>appendRecordsToFollowerOrFutureReplica&#45;&gt;doAppendRecordsToFollowerOrFutureReplica</title>
<path fill="none" stroke="#000000" d="M1660.2365,-211C1668.6904,-211 1677.2415,-211 1685.7783,-211"/>
<polygon fill="#000000" stroke="#000000" points="1685.7866,-214.5001 1695.7866,-211 1685.7865,-207.5001 1685.7866,-214.5001"/>
</g>
<!-- addFetcherForPartitions -->
<g id="node15" class="node">
<title>addFetcherForPartitions</title>
<polygon fill="none" stroke="#000000" points="317,-366 170,-366 170,-330 317,-330 317,-366"/>
<text text-anchor="middle" x="243.5" y="-344.3" font-family="Times,serif" font-size="14.00" fill="#000000">addFetcherForPartitions</text>
</g>
<!-- addFetcherForPartitions&#45;&gt;addPartitions -->
<g id="edge12" class="edge">
<title>addFetcherForPartitions&#45;&gt;addPartitions</title>
<path fill="none" stroke="#000000" d="M282.2529,-329.7872C312.5917,-315.5287 354.9341,-295.6289 387.3452,-280.3965"/>
<polygon fill="#000000" stroke="#000000" points="389.0704,-283.4531 396.632,-276.032 386.0929,-277.1178 389.0704,-283.4531"/>
</g>
<!-- addAndStartFetcherThread -->
<g id="node16" class="node">
<title>addAndStartFetcherThread</title>
<polygon fill="none" stroke="#000000" points="517,-366 353,-366 353,-330 517,-330 517,-366"/>
<text text-anchor="middle" x="435" y="-344.3" font-family="Times,serif" font-size="14.00" fill="#000000">addAndStartFetcherThread</text>
</g>
<!-- addFetcherForPartitions&#45;&gt;addAndStartFetcherThread -->
<g id="edge13" class="edge">
<title>addFetcherForPartitions&#45;&gt;addAndStartFetcherThread</title>
<path fill="none" stroke="#000000" d="M317.265,-348C325.671,-348 334.3161,-348 342.9215,-348"/>
<polygon fill="#000000" stroke="#000000" points="342.9887,-351.5001 352.9887,-348 342.9886,-344.5001 342.9887,-351.5001"/>
</g>
<!-- addAndStartFetcherThread&#45;&gt;fetcherThread_start -->
<g id="edge14" class="edge">
<title>addAndStartFetcherThread&#45;&gt;fetcherThread_start</title>
<path fill="none" stroke="#000000" d="M492.6929,-329.9443C501.0795,-326.4548 509.429,-322.4702 517,-318 545.6892,-301.0608 573.9129,-275.4547 593.0213,-256.4029"/>
<polygon fill="#000000" stroke="#000000" points="595.5977,-258.775 600.1288,-249.198 590.6143,-253.8591 595.5977,-258.775"/>
</g>
<!-- createFetcherThread -->
<g id="node17" class="node">
<title>createFetcherThread</title>
<polygon fill="none" stroke="#000000" points="681,-366 553,-366 553,-330 681,-330 681,-366"/>
<text text-anchor="middle" x="617" y="-344.3" font-family="Times,serif" font-size="14.00" fill="#000000">createFetcherThread</text>
</g>
<!-- addAndStartFetcherThread&#45;&gt;createFetcherThread -->
<g id="edge15" class="edge">
<title>addAndStartFetcherThread&#45;&gt;createFetcherThread</title>
<path fill="none" stroke="#000000" d="M517.2143,-348C525.7197,-348 534.3285,-348 542.7396,-348"/>
<polygon fill="#000000" stroke="#000000" points="542.8811,-351.5001 552.8811,-348 542.8811,-344.5001 542.8811,-351.5001"/>
</g>
<!-- fetcherThreadMap -->
<g id="node18" class="node">
<title>fetcherThreadMap</title>
<polygon fill="#95e1d3" stroke="#000000" points="676,-420 562,-420 558,-416 558,-384 672,-384 676,-388 676,-420"/>
<polyline fill="none" stroke="#000000" points="672,-416 558,-416 "/>
<polyline fill="none" stroke="#000000" points="672,-416 672,-384 "/>
<polyline fill="none" stroke="#000000" points="672,-416 676,-420 "/>
<text text-anchor="middle" x="617" y="-398.3" font-family="Times,serif" font-size="14.00" fill="#000000">fetcherThreadMap</text>
</g>
<!-- addAndStartFetcherThread&#45;&gt;fetcherThreadMap -->
<g id="edge16" class="edge">
<title>addAndStartFetcherThread&#45;&gt;fetcherThreadMap</title>
<path fill="none" stroke="#000000" d="M495.8564,-366.0563C512.5284,-371.0029 530.7222,-376.4011 547.8234,-381.4751"/>
<polygon fill="#000000" stroke="#000000" points="547.1637,-384.9301 557.7462,-384.4192 549.1549,-378.2192 547.1637,-384.9301"/>
</g>
<!-- createFetcherThread&#45;&gt;ReplicaFetcherThread -->
<g id="edge17" class="edge">
<title>createFetcherThread&#45;&gt;ReplicaFetcherThread</title>
<path fill="none" stroke="#000000" d="M663.5964,-329.8811C672.1579,-326.188 680.9337,-322.1537 689,-318 710.1016,-307.1339 732.6831,-293.229 750.6928,-281.5415"/>
<polygon fill="#000000" stroke="#000000" points="752.6949,-284.4141 759.1401,-276.0052 748.8578,-278.5595 752.6949,-284.4141"/>
</g>
<!-- partitionState -->
<g id="node19" class="node">
<title>partitionState</title>
<polygon fill="#95e1d3" stroke="#000000" points="2501,-19.5 2501,-134.5 2639,-134.5 2639,-19.5 2501,-19.5"/>
<text text-anchor="middle" x="2570" y="-119.3" font-family="Times,serif" font-size="14.00" fill="#000000">partitionState</text>
<polyline fill="none" stroke="#000000" points="2501,-111.5 2639,-111.5 "/>
<text text-anchor="start" x="2509" y="-96.3" font-family="Times,serif" font-size="14.00" fill="#000000">ControllerEpoch int32</text>
<polyline fill="none" stroke="#000000" points="2501,-88.5 2639,-88.5 "/>
<text text-anchor="start" x="2509" y="-73.3" font-family="Times,serif" font-size="14.00" fill="#000000">leader int32</text>
<polyline fill="none" stroke="#000000" points="2501,-65.5 2639,-65.5 "/>
<text text-anchor="start" x="2509" y="-50.3" font-family="Times,serif" font-size="14.00" fill="#000000">leader_epoch int32</text>
<polyline fill="none" stroke="#000000" points="2501,-42.5 2639,-42.5 "/>
<text text-anchor="start" x="2509" y="-27.3" font-family="Times,serif" font-size="14.00" fill="#000000">isr []int32</text>
</g>
<!-- appendAsFollower -->
<g id="node20" class="node">
<title>appendAsFollower</title>
<polygon fill="none" stroke="#000000" points="2148.5,-236 2029.5,-236 2029.5,-200 2148.5,-200 2148.5,-236"/>
<text text-anchor="middle" x="2089" y="-214.3" font-family="Times,serif" font-size="14.00" fill="#000000">appendAsFollower</text>
</g>
<!-- append -->
<g id="node21" class="node">
<title>append</title>
<polygon fill="none" stroke="#000000" points="2293,-236 2237,-236 2237,-200 2293,-200 2293,-236"/>
<text text-anchor="middle" x="2265" y="-214.3" font-family="Times,serif" font-size="14.00" fill="#000000">append</text>
</g>
<!-- appendAsFollower&#45;&gt;append -->
<g id="edge18" class="edge">
<title>appendAsFollower&#45;&gt;append</title>
<path fill="none" stroke="#000000" d="M2148.5856,-218C2174.2405,-218 2203.5047,-218 2226.2743,-218"/>
<polygon fill="#000000" stroke="#000000" points="2226.5637,-221.5001 2236.5637,-218 2226.5636,-214.5001 2226.5637,-221.5001"/>
</g>
<!-- updateFetchState -->
<g id="node22" class="node">
<title>updateFetchState</title>
<polygon fill="none" stroke="#000000" points="2320,-95 2210,-95 2210,-59 2320,-59 2320,-95"/>
<text text-anchor="middle" x="2265" y="-73.3" font-family="Times,serif" font-size="14.00" fill="#000000">updateFetchState</text>
</g>
<!-- maybeExpandIsr -->
<g id="node23" class="node">
<title>maybeExpandIsr</title>
<polygon fill="none" stroke="#000000" points="2465,-95 2356,-95 2356,-59 2465,-59 2465,-95"/>
<text text-anchor="middle" x="2410.5" y="-73.3" font-family="Times,serif" font-size="14.00" fill="#000000">maybeExpandIsr</text>
</g>
<!-- updateFetchState&#45;&gt;maybeExpandIsr -->
<g id="edge19" class="edge">
<title>updateFetchState&#45;&gt;maybeExpandIsr</title>
<path fill="none" stroke="#000000" d="M2320.0073,-77C2328.4521,-77 2337.2366,-77 2345.8669,-77"/>
<polygon fill="#000000" stroke="#000000" points="2345.8975,-80.5001 2355.8975,-77 2345.8975,-73.5001 2345.8975,-80.5001"/>
</g>
<!-- maybeExpandIsr&#45;&gt;partitionState -->
<g id="edge20" class="edge">
<title>maybeExpandIsr&#45;&gt;partitionState</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M2465.3909,-77C2473.6164,-77 2482.2341,-77 2490.8425,-77"/>
<polygon fill="#000000" stroke="#000000" points="2490.9198,-80.5001 2500.9198,-77 2490.9197,-73.5001 2490.9198,-80.5001"/>
</g>
<!-- fetchMessages -->
<g id="node24" class="node">
<title>fetchMessages</title>
<polygon fill="#f38181" stroke="#000000" points="2004,-46.5 2004,-107.5 2174,-107.5 2174,-46.5 2004,-46.5"/>
<text text-anchor="middle" x="2089" y="-92.3" font-family="Times,serif" font-size="14.00" fill="#000000">fetchMessages</text>
<polyline fill="none" stroke="#000000" points="2004,-84.5 2174,-84.5 "/>
<text text-anchor="start" x="2012" y="-69.3" font-family="Times,serif" font-size="14.00" fill="#000000">在partionLeader的broker中</text>
<text text-anchor="start" x="2012" y="-54.3" font-family="Times,serif" font-size="14.00" fill="#000000"> 处理follower的fetch请求</text>
</g>
<!-- fetchMessages&#45;&gt;updateFetchState -->
<g id="edge24" class="edge">
<title>fetchMessages&#45;&gt;updateFetchState</title>
<path fill="none" stroke="#000000" d="M2174.1645,-77C2182.7729,-77 2191.4176,-77 2199.7685,-77"/>
<polygon fill="#000000" stroke="#000000" points="2199.7869,-80.5001 2209.7869,-77 2199.7869,-73.5001 2199.7869,-80.5001"/>
</g>
<!-- doAppendRecordsToFollowerOrFutureReplica&#45;&gt;appendAsFollower -->
<g id="edge22" class="edge">
<title>doAppendRecordsToFollowerOrFutureReplica&#45;&gt;appendAsFollower</title>
<path fill="none" stroke="#000000" d="M1968.0255,-214.705C1985.7049,-215.1865 2003.1937,-215.6629 2019.1471,-216.0974"/>
<polygon fill="#000000" stroke="#000000" points="2019.304,-219.6029 2029.3956,-216.3765 2019.4946,-212.6055 2019.304,-219.6029"/>
</g>
<!-- makeFollowers -->
<g id="node26" class="node">
<title>makeFollowers</title>
<polygon fill="none" stroke="#000000" points="121,-366 20,-366 20,-330 121,-330 121,-366"/>
<text text-anchor="middle" x="70.5" y="-344.3" font-family="Times,serif" font-size="14.00" fill="#000000">makeFollowers</text>
</g>
<!-- makeFollowers&#45;&gt;addFetcherForPartitions -->
<g id="edge23" class="edge">
<title>makeFollowers&#45;&gt;addFetcherForPartitions</title>
<path fill="none" stroke="#000000" d="M121.0038,-348C133.1635,-348 146.4782,-348 159.7083,-348"/>
<polygon fill="#000000" stroke="#000000" points="159.7885,-351.5001 169.7885,-348 159.7884,-344.5001 159.7885,-351.5001"/>
</g>
<!-- handleFetchRequest&#45;&gt;fetchMessages -->
<g id="edge25" class="edge">
<title>handleFetchRequest&#45;&gt;fetchMessages</title>
<path fill="none" stroke="#000000" d="M1895.1984,-80.0164C1924.8303,-79.5552 1960.7718,-78.9958 1993.6158,-78.4846"/>
<polygon fill="#000000" stroke="#000000" points="1993.7546,-81.9829 2003.6988,-78.3276 1993.6456,-74.9838 1993.7546,-81.9829"/>
</g>
</g>
</svg>
