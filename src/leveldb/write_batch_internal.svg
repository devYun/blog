<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: write_batch Pages: 1 -->
<svg width="881pt" height="346pt"
 viewBox="0.00 0.00 881.09 346.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 342)">
<title>write_batch</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-342 877.0928,-342 877.0928,4 -4,4"/>
<!-- rep_ -->
<g id="node1" class="node">
<title>rep_</title>
<polygon fill="none" stroke="#000000" points="371.3296,-184.5 371.3296,-250.5 494.2163,-250.5 494.2163,-184.5 371.3296,-184.5"/>
<text text-anchor="middle" x="432.7729" y="-235.3" font-family="Times,serif" font-size="14.00" fill="#000000">rep_</text>
<polyline fill="none" stroke="#000000" points="371.3296,-228.5 494.2163,-228.5 "/>
<polyline fill="none" stroke="#000000" points="371.3296,-228.5 494.2163,-228.5 "/>
<text text-anchor="start" x="379.3296" y="-213.3" font-family="Times,serif" font-size="14.00" fill="#000000">count: fixed32</text>
<polyline fill="none" stroke="#000000" points="371.3296,-206.5 494.2163,-206.5 "/>
<text text-anchor="middle" x="432.7729" y="-191.3" font-family="Times,serif" font-size="14.00" fill="#000000">data: record[count]</text>
</g>
<!-- record -->
<g id="node2" class="node">
<title>record</title>
<polygon fill="none" stroke="#000000" points="545.9834,-101.7 545.9834,-173.3 735.1787,-173.3 735.1787,-101.7 545.9834,-101.7"/>
<text text-anchor="middle" x="640.5811" y="-158.1" font-family="Times,serif" font-size="14.00" fill="#000000">record</text>
<polyline fill="none" stroke="#000000" points="545.9834,-151.3 735.1787,-151.3 "/>
<text text-anchor="start" x="553.9834" y="-136.1" font-family="Times,serif" font-size="14.00" fill="#000000">kTypeValue varstring varstring</text>
<polyline fill="none" stroke="#000000" points="545.9834,-129.3 735.1787,-129.3 "/>
<text text-anchor="start" x="553.9834" y="-114.1" font-family="Times,serif" font-size="14.00" fill="#000000">或者kTypeDeletion varstring</text>
</g>
<!-- rep_&#45;&gt;record -->
<g id="edge3" class="edge">
<title>rep_&#45;&gt;record</title>
<path fill="none" stroke="#000000" d="M494.2788,-193.8221C507.9254,-188.5685 522.7498,-182.8616 537.5506,-177.1637"/>
<polygon fill="#000000" stroke="#000000" points="539.1859,-180.2846 547.2608,-173.4256 536.671,-173.752 539.1859,-180.2846"/>
</g>
<!-- AddRecord -->
<g id="node12" class="node">
<title>AddRecord</title>
<polygon fill="none" stroke="#000000" points="583.5811,-192.7 583.5811,-242.3 697.5811,-242.3 697.5811,-192.7 583.5811,-192.7"/>
<text text-anchor="middle" x="640.5811" y="-227.1" font-family="Times,serif" font-size="14.00" fill="#000000">AddRecord</text>
<polyline fill="none" stroke="#000000" points="583.5811,-220.3 697.5811,-220.3 "/>
<text text-anchor="start" x="591.5811" y="-205.1" font-family="Times,serif" font-size="14.00" fill="#000000">将日志写入文件</text>
</g>
<!-- rep_&#45;&gt;AddRecord -->
<g id="edge6" class="edge">
<title>rep_&#45;&gt;AddRecord</title>
<path fill="none" stroke="#c0c0c0" stroke-dasharray="5,2" d="M494.2788,-217.5C519.1036,-217.5 547.8259,-217.5 573.2134,-217.5"/>
<polygon fill="#c0c0c0" stroke="#c0c0c0" points="573.4981,-221.0001 583.4981,-217.5 573.498,-214.0001 573.4981,-221.0001"/>
</g>
<!-- varstring -->
<g id="node3" class="node">
<title>varstring</title>
<polygon fill="none" stroke="#000000" points="771.1787,-72.5 771.1787,-138.5 873.0928,-138.5 873.0928,-72.5 771.1787,-72.5"/>
<text text-anchor="middle" x="822.1357" y="-123.3" font-family="Times,serif" font-size="14.00" fill="#000000">varstring</text>
<polyline fill="none" stroke="#000000" points="771.1787,-116.5 873.0928,-116.5 "/>
<text text-anchor="start" x="779.1787" y="-101.3" font-family="Times,serif" font-size="14.00" fill="#000000">len: varint32</text>
<polyline fill="none" stroke="#000000" points="771.1787,-94.5 873.0928,-94.5 "/>
<text text-anchor="start" x="779.1787" y="-79.3" font-family="Times,serif" font-size="14.00" fill="#000000">data: uint8[len]</text>
</g>
<!-- record&#45;&gt;varstring -->
<g id="edge4" class="edge">
<title>record&#45;&gt;varstring</title>
<path fill="none" stroke="#000000" d="M735.3465,-120.7971C744.0263,-119.2672 752.6574,-117.7459 760.9216,-116.2893"/>
<polygon fill="#000000" stroke="#000000" points="761.558,-119.7312 770.7987,-114.5484 760.3429,-112.8375 761.558,-119.7312"/>
</g>
<!-- rep__push_back -->
<g id="node4" class="node">
<title>rep__push_back</title>
<polygon fill="none" stroke="#000000" points="172.8149,-170.7 172.8149,-220.3 307.0288,-220.3 307.0288,-170.7 172.8149,-170.7"/>
<text text-anchor="middle" x="239.9219" y="-205.1" font-family="Times,serif" font-size="14.00" fill="#000000">rep__push_back</text>
<polyline fill="none" stroke="#000000" points="172.8149,-198.3 307.0288,-198.3 "/>
<text text-anchor="start" x="180.8149" y="-183.1" font-family="Times,serif" font-size="14.00" fill="#000000">在后面增加key类型</text>
</g>
<!-- rep__push_back&#45;&gt;rep_ -->
<g id="edge14" class="edge">
<title>rep__push_back&#45;&gt;rep_:data</title>
<path fill="none" stroke="#000000" d="M307.3366,-195.5C324.7,-195.5 343.5743,-195.5 361.582,-195.5"/>
<polygon fill="#000000" stroke="#000000" points="361.773,-199.0001 371.7729,-195.5 361.7729,-192.0001 361.773,-199.0001"/>
</g>
<!-- PutLengthPrefixedSlice -->
<g id="node5" class="node">
<title>PutLengthPrefixedSlice</title>
<polygon fill="none" stroke="#000000" points="355.5625,-48.7 355.5625,-98.3 509.9834,-98.3 509.9834,-48.7 355.5625,-48.7"/>
<text text-anchor="middle" x="432.7729" y="-83.1" font-family="Times,serif" font-size="14.00" fill="#000000">PutLengthPrefixedSlice</text>
<polyline fill="none" stroke="#000000" points="355.5625,-76.3 509.9834,-76.3 "/>
<text text-anchor="start" x="363.5625" y="-61.1" font-family="Times,serif" font-size="14.00" fill="#000000">将key/value追加在后面</text>
</g>
<!-- PutLengthPrefixedSlice&#45;&gt;varstring -->
<g id="edge5" class="edge">
<title>PutLengthPrefixedSlice&#45;&gt;varstring</title>
<path fill="none" stroke="#000000" d="M509.9881,-76.5265C571.1846,-79.365 658.8037,-84.4067 735.1787,-92.5 743.4705,-93.3787 752.1829,-94.4742 760.7589,-95.6542"/>
<polygon fill="#000000" stroke="#000000" points="760.3376,-99.1294 770.7303,-97.0701 761.3217,-92.1989 760.3376,-99.1294"/>
</g>
<!-- WriteBatch_Put -->
<g id="node6" class="node">
<title>WriteBatch_Put</title>
<polygon fill="none" stroke="#000000" points="8.9277,-101.7 8.9277,-151.3 115.3535,-151.3 115.3535,-101.7 8.9277,-101.7"/>
<text text-anchor="middle" x="62.1406" y="-136.1" font-family="Times,serif" font-size="14.00" fill="#000000">WriteBatch::Put</text>
<polyline fill="none" stroke="#000000" points="8.9277,-129.3 115.3535,-129.3 "/>
<text text-anchor="middle" x="62.1406" y="-114.1" font-family="Times,serif" font-size="14.00" fill="#000000">增加key/value</text>
</g>
<!-- WriteBatch_Put&#45;&gt;rep__push_back -->
<g id="edge7" class="edge">
<title>WriteBatch_Put&#45;&gt;rep__push_back</title>
<path fill="none" stroke="#000000" d="M115.4809,-147.2023C131.5322,-153.4321 149.4351,-160.3805 166.5465,-167.0217"/>
<polygon fill="#000000" stroke="#000000" points="165.3657,-170.3178 175.9546,-170.6732 167.8985,-163.792 165.3657,-170.3178"/>
</g>
<!-- WriteBatch_Put&#45;&gt;PutLengthPrefixedSlice -->
<g id="edge8" class="edge">
<title>WriteBatch_Put&#45;&gt;PutLengthPrefixedSlice</title>
<path fill="none" stroke="#000000" d="M115.4191,-105.1861C129.7735,-100.2353 145.4412,-95.5323 160.2813,-92.5 221.2811,-80.0358 291.3822,-75.3588 345.2059,-73.76"/>
<polygon fill="#000000" stroke="#000000" points="345.4998,-77.2535 355.4029,-73.4879 345.3131,-70.256 345.4998,-77.2535"/>
</g>
<!-- kTypeValue -->
<g id="node10" class="node">
<title>kTypeValue</title>
<polygon fill="none" stroke="#000000" points="198.5898,-.5 198.5898,-44.5 281.2539,-44.5 281.2539,-.5 198.5898,-.5"/>
<text text-anchor="middle" x="239.9219" y="-29.3" font-family="Times,serif" font-size="14.00" fill="#000000">kTypeValue</text>
<polyline fill="none" stroke="#000000" points="198.5898,-22.5 281.2539,-22.5 "/>
<text text-anchor="middle" x="239.9219" y="-7.3" font-family="Times,serif" font-size="14.00" fill="#000000">0x1</text>
</g>
<!-- WriteBatch_Put&#45;&gt;kTypeValue -->
<g id="edge9" class="edge">
<title>WriteBatch_Put&#45;&gt;kTypeValue</title>
<path fill="none" stroke="#000000" d="M95.7727,-101.5148C114.3221,-88.2581 138.0427,-72.1435 160.2813,-59.5 169.421,-54.3037 179.4158,-49.222 189.1417,-44.5703"/>
<polygon fill="#000000" stroke="#000000" points="190.7801,-47.6677 198.3474,-40.2524 187.8075,-41.3302 190.7801,-47.6677"/>
</g>
<!-- SetCount -->
<g id="node11" class="node">
<title>SetCount</title>
<polygon fill="none" stroke="#000000" points="274.0392,-274.5 205.8046,-274.5 205.8046,-238.5 274.0392,-238.5 274.0392,-274.5"/>
<text text-anchor="middle" x="239.9219" y="-252.3" font-family="Times,serif" font-size="14.00" fill="#000000">SetCount</text>
</g>
<!-- WriteBatch_Put&#45;&gt;SetCount -->
<g id="edge10" class="edge">
<title>WriteBatch_Put&#45;&gt;SetCount</title>
<path fill="none" stroke="#000000" d="M80.1558,-151.4352C98.0894,-174.6206 127.5963,-208.6325 160.2813,-229.5 171.1562,-236.443 184.0137,-241.81 196.1891,-245.8618"/>
<polygon fill="#000000" stroke="#000000" points="195.1682,-249.2095 205.7563,-248.8342 197.2451,-242.5247 195.1682,-249.2095"/>
</g>
<!-- SetSequence -->
<g id="node7" class="node">
<title>SetSequence</title>
<polygon fill="none" stroke="#000000" points="160.2813,-101.7 160.2813,-151.3 319.5625,-151.3 319.5625,-101.7 160.2813,-101.7"/>
<text text-anchor="middle" x="239.9219" y="-136.1" font-family="Times,serif" font-size="14.00" fill="#000000">WriteBatch::SetSequence</text>
<polyline fill="none" stroke="#000000" points="160.2813,-129.3 319.5625,-129.3 "/>
<text text-anchor="start" x="168.2813" y="-114.1" font-family="Times,serif" font-size="14.00" fill="#000000">这次batch的sequnce</text>
</g>
<!-- SetSequence&#45;&gt;rep_ -->
<g id="edge1" class="edge">
<title>SetSequence&#45;&gt;rep_:sequence</title>
<path fill="none" stroke="#000000" d="M319.7056,-123.403C408.7415,-122.1947 535.9893,-128.456 500.5449,-176.729"/>
<polygon fill="#000000" stroke="#000000" points="497.7041,-174.6615 493.7729,-184.5 502.9815,-179.2604 497.7041,-174.6615"/>
</g>
<!-- WriteBatch_Delete -->
<g id="node8" class="node">
<title>WriteBatch_Delete</title>
<polygon fill="none" stroke="#000000" points="0,-221.9001 0,-291.0999 124.2813,-291.0999 124.2813,-221.9001 0,-221.9001"/>
<text text-anchor="middle" x="62.1406" y="-275.8999" font-family="Times,serif" font-size="14.00" fill="#000000">WriteBatch::Delete</text>
<polyline fill="none" stroke="#000000" points="0,-269.0999 124.2813,-269.0999 "/>
<text text-anchor="start" x="8" y="-253.8999" font-family="Times,serif" font-size="14.00" fill="#000000">删除key 在日志中</text>
<text text-anchor="start" x="8" y="-234.3" font-family="Times,serif" font-size="14.00" fill="#000000"> 写入特殊标记key</text>
</g>
<!-- WriteBatch_Delete&#45;&gt;rep__push_back -->
<g id="edge11" class="edge">
<title>WriteBatch_Delete&#45;&gt;rep__push_back</title>
<path fill="none" stroke="#000000" d="M124.3199,-235.1652C136.7674,-230.8942 149.9853,-226.3589 162.8656,-221.9394"/>
<polygon fill="#000000" stroke="#000000" points="164.3084,-225.1447 172.6312,-218.5887 162.0366,-218.5236 164.3084,-225.1447"/>
</g>
<!-- kTypeDeletion -->
<g id="node9" class="node">
<title>kTypeDeletion</title>
<polygon fill="none" stroke="#000000" points="190.4243,-293.5 190.4243,-337.5 289.4194,-337.5 289.4194,-293.5 190.4243,-293.5"/>
<text text-anchor="middle" x="239.9219" y="-322.3" font-family="Times,serif" font-size="14.00" fill="#000000">kTypeDeletion</text>
<polyline fill="none" stroke="#000000" points="190.4243,-315.5 289.4194,-315.5 "/>
<text text-anchor="middle" x="239.9219" y="-300.3" font-family="Times,serif" font-size="14.00" fill="#000000">0x0</text>
</g>
<!-- WriteBatch_Delete&#45;&gt;kTypeDeletion -->
<g id="edge12" class="edge">
<title>WriteBatch_Delete&#45;&gt;kTypeDeletion</title>
<path fill="none" stroke="#000000" d="M124.3199,-277.1353C142.6532,-283.2196 162.6577,-289.8584 180.7936,-295.8772"/>
<polygon fill="#000000" stroke="#000000" points="179.7769,-299.2274 190.3704,-299.0554 181.9818,-292.5837 179.7769,-299.2274"/>
</g>
<!-- WriteBatch_Delete&#45;&gt;SetCount -->
<g id="edge13" class="edge">
<title>WriteBatch_Delete&#45;&gt;SetCount</title>
<path fill="none" stroke="#000000" d="M124.3199,-256.5C147.8115,-256.5 174.047,-256.5 195.5793,-256.5"/>
<polygon fill="#000000" stroke="#000000" points="195.7393,-260.0001 205.7392,-256.5 195.7392,-253.0001 195.7393,-260.0001"/>
</g>
<!-- SetCount&#45;&gt;rep_ -->
<g id="edge2" class="edge">
<title>SetCount&#45;&gt;rep_:count</title>
<path fill="none" stroke="#000000" d="M274.0021,-245.3242C302.854,-236.0056 342.5143,-223.5648 361.8613,-219.1437"/>
<polygon fill="#000000" stroke="#000000" points="362.4803,-222.5889 371.7729,-217.5 361.3351,-215.6832 362.4803,-222.5889"/>
</g>
</g>
</svg>
