<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Writer Pages: 1 -->
<svg width="1762pt" height="694pt"
 viewBox="0.00 0.00 1761.75 693.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 689.5)">
<title>Writer</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-689.5 1757.7451,-689.5 1757.7451,4 -4,4"/>
<g id="clust12" class="cluster">
<title>cluster_StateCV</title>
<path fill="none" stroke="#000000" d="M1230.4248,-8C1230.4248,-8 1657.3506,-8 1657.3506,-8 1663.3506,-8 1669.3506,-14 1669.3506,-20 1669.3506,-20 1669.3506,-76 1669.3506,-76 1669.3506,-82 1663.3506,-88 1657.3506,-88 1657.3506,-88 1230.4248,-88 1230.4248,-88 1224.4248,-88 1218.4248,-82 1218.4248,-76 1218.4248,-76 1218.4248,-20 1218.4248,-20 1218.4248,-14 1224.4248,-8 1230.4248,-8"/>
<text text-anchor="middle" x="1443.8877" y="-68" font-family="Times,serif" font-size="20.00" fill="#000000">StateCV</text>
</g>
<!-- WriteGroup -->
<g id="node1" class="node">
<title>WriteGroup</title>
<polygon fill="none" stroke="#000000" points="1191.647,-445 1191.647,-555 1392.2993,-555 1392.2993,-445 1191.647,-445"/>
<text text-anchor="middle" x="1291.9731" y="-539.8" font-family="Times,serif" font-size="14.00" fill="#000000">WriteGroup</text>
<polyline fill="none" stroke="#000000" points="1191.647,-533 1392.2993,-533 "/>
<text text-anchor="start" x="1199.647" y="-517.8" font-family="Times,serif" font-size="14.00" fill="#000000">Writer* leader = nullptr;</text>
<polyline fill="none" stroke="#000000" points="1191.647,-511 1392.2993,-511 "/>
<text text-anchor="start" x="1199.647" y="-495.8" font-family="Times,serif" font-size="14.00" fill="#000000">Writer* last_writer = nullptr;</text>
<polyline fill="none" stroke="#000000" points="1191.647,-489 1392.2993,-489 "/>
<text text-anchor="start" x="1199.647" y="-473.8" font-family="Times,serif" font-size="14.00" fill="#000000">SequenceNumber last_sequence;</text>
<polyline fill="none" stroke="#000000" points="1191.647,-467 1392.2993,-467 "/>
<text text-anchor="start" x="1199.647" y="-451.8" font-family="Times,serif" font-size="14.00" fill="#000000">Status status;</text>
<polyline fill="none" stroke="#000000" points="1191.647,-445 1392.2993,-445 "/>
</g>
<!-- Writer -->
<g id="node2" class="node">
<title>Writer</title>
<polygon fill="none" stroke="#000000" points="1474.4111,-244 1474.4111,-638 1753.7451,-638 1753.7451,-244 1474.4111,-244"/>
<text text-anchor="middle" x="1614.0781" y="-622.8" font-family="Times,serif" font-size="14.00" fill="#000000">Writer</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-616 1753.7451,-616 "/>
<text text-anchor="start" x="1482.4111" y="-600.8" font-family="Times,serif" font-size="14.00" fill="#000000">WriteBatch* batch;</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-594 1753.7451,-594 "/>
<text text-anchor="start" x="1482.4111" y="-578.8" font-family="Times,serif" font-size="14.00" fill="#000000">bool sync;</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-572 1753.7451,-572 "/>
<text text-anchor="start" x="1482.4111" y="-556.8" font-family="Times,serif" font-size="14.00" fill="#000000">bool no_slowdown;</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-550 1753.7451,-550 "/>
<text text-anchor="start" x="1482.4111" y="-534.8" font-family="Times,serif" font-size="14.00" fill="#000000">bool disable_wal;</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-528 1753.7451,-528 "/>
<text text-anchor="start" x="1482.4111" y="-512.8" font-family="Times,serif" font-size="14.00" fill="#000000">bool disable_memtable;</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-506 1753.7451,-506 "/>
<text text-anchor="start" x="1482.4111" y="-490.8" font-family="Times,serif" font-size="14.00" fill="#000000">size_t batch_cnt;</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-484 1753.7451,-484 "/>
<text text-anchor="start" x="1482.4111" y="-468.8" font-family="Times,serif" font-size="14.00" fill="#000000">PreReleaseCallback* pre_release_callback;</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-462 1753.7451,-462 "/>
<text text-anchor="start" x="1482.4111" y="-446.8" font-family="Times,serif" font-size="14.00" fill="#000000">uint64_t log_used;</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-440 1753.7451,-440 "/>
<text text-anchor="start" x="1482.4111" y="-424.8" font-family="Times,serif" font-size="14.00" fill="#000000">uint64_t log_ref;</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-418 1753.7451,-418 "/>
<text text-anchor="start" x="1482.4111" y="-402.8" font-family="Times,serif" font-size="14.00" fill="#000000">WriteCallback* callback;</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-396 1753.7451,-396 "/>
<text text-anchor="start" x="1482.4111" y="-380.8" font-family="Times,serif" font-size="14.00" fill="#000000">std::atomic&lt;uint8_t&gt; state;</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-374 1753.7451,-374 "/>
<text text-anchor="start" x="1482.4111" y="-358.8" font-family="Times,serif" font-size="14.00" fill="#000000">WriteGroup* write_group;</text>
<text text-anchor="start" x="1482.4111" y="-344.8" font-family="Times,serif" font-size="14.00" fill="#000000"> std::aligned_storage&lt;sizeof(std::mutex)&gt;</text>
<text text-anchor="start" x="1482.4111" y="-330.8" font-family="Times,serif" font-size="14.00" fill="#000000">::type state_mutex_bytes;</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-324 1753.7451,-324 "/>
<text text-anchor="start" x="1482.4111" y="-308.8" font-family="Times,serif" font-size="14.00" fill="#000000">std::aligned_storage&lt;sizeof(</text>
<text text-anchor="start" x="1482.4111" y="-294.8" font-family="Times,serif" font-size="14.00" fill="#000000">std::condition_variable)&gt;::type state_cv_bytes;</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-288 1753.7451,-288 "/>
<text text-anchor="start" x="1482.4111" y="-272.8" font-family="Times,serif" font-size="14.00" fill="#000000">Writer* link_older;</text>
<polyline fill="none" stroke="#000000" points="1474.4111,-266 1753.7451,-266 "/>
<text text-anchor="start" x="1482.4111" y="-250.8" font-family="Times,serif" font-size="14.00" fill="#000000">Writer* link_newer;</text>
</g>
<!-- WriteGroup&#45;&gt;Writer -->
<g id="edge1" class="edge">
<title>WriteGroup:Writer&#45;&gt;Writer</title>
<path fill="none" stroke="#000000" d="M1391.9731,-522C1416.0525,-522 1440.7599,-517.746 1464.5429,-511.1879"/>
<polygon fill="#000000" stroke="#000000" points="1465.6885,-514.4999 1474.3165,-508.351 1463.7372,-507.7773 1465.6885,-514.4999"/>
</g>
<!-- WriteThread -->
<g id="node3" class="node">
<title>WriteThread</title>
<polygon fill="none" stroke="#000000" points="1145.5352,-575 1145.5352,-685 1438.4111,-685 1438.4111,-575 1145.5352,-575"/>
<text text-anchor="middle" x="1291.9731" y="-669.8" font-family="Times,serif" font-size="14.00" fill="#000000">WriteThread</text>
<polyline fill="none" stroke="#000000" points="1145.5352,-663 1438.4111,-663 "/>
<text text-anchor="start" x="1153.5352" y="-647.8" font-family="Times,serif" font-size="14.00" fill="#000000">std::atomic&lt;Writer*&gt; newest_writer_;</text>
<polyline fill="none" stroke="#000000" points="1145.5352,-641 1438.4111,-641 "/>
<text text-anchor="start" x="1153.5352" y="-625.8" font-family="Times,serif" font-size="14.00" fill="#000000">std::atomic&lt;Writer*&gt; newest_memtable_writer_;</text>
<polyline fill="none" stroke="#000000" points="1145.5352,-619 1438.4111,-619 "/>
<text text-anchor="start" x="1153.5352" y="-603.8" font-family="Times,serif" font-size="14.00" fill="#000000">port::Mutex stall_mu_;</text>
<polyline fill="none" stroke="#000000" points="1145.5352,-597 1438.4111,-597 "/>
<text text-anchor="start" x="1153.5352" y="-581.8" font-family="Times,serif" font-size="14.00" fill="#000000">port::CondVar stall_cv_;</text>
</g>
<!-- WriteThread&#45;&gt;Writer -->
<g id="edge3" class="edge">
<title>WriteThread:Writer&#45;&gt;Writer</title>
<path fill="none" stroke="#000000" d="M1437.9731,-652C1453.4803,-652 1467.8884,-648.5993 1481.2265,-642.6613"/>
<polygon fill="#000000" stroke="#000000" points="1482.8935,-645.7413 1490.2901,-638.1557 1479.7775,-639.4731 1482.8935,-645.7413"/>
</g>
<!-- EnterAsBatchGroupLeader -->
<g id="node4" class="node">
<title>EnterAsBatchGroupLeader</title>
<polygon fill="none" stroke="#000000" points="561.249,-469.2 561.249,-518.8 761.5322,-518.8 761.5322,-469.2 561.249,-469.2"/>
<text text-anchor="middle" x="661.3906" y="-503.6" font-family="Times,serif" font-size="14.00" fill="#000000">EnterAsBatchGroupLeader</text>
<polyline fill="none" stroke="#000000" points="561.249,-496.8 761.5322,-496.8 "/>
<text text-anchor="start" x="569.249" y="-481.6" font-family="Times,serif" font-size="14.00" fill="#000000">将writer设置为group中的leader</text>
</g>
<!-- EnterAsBatchGroupLeader&#45;&gt;WriteGroup -->
<g id="edge30" class="edge">
<title>EnterAsBatchGroupLeader&#45;&gt;WriteGroup</title>
<path fill="none" stroke="#000000" d="M761.703,-511.4614C781.1459,-514.1853 801.4065,-516.5689 820.4873,-518 948.5932,-527.6081 981.2247,-524.3145 1109.5352,-518 1132.7607,-516.857 1157.5893,-514.9003 1181.2141,-512.6874"/>
<polygon fill="#000000" stroke="#000000" points="1181.6366,-516.163 1191.2571,-511.725 1180.9688,-509.195 1181.6366,-516.163"/>
</g>
<!-- CreateMissingNewerLinks -->
<g id="node26" class="node">
<title>CreateMissingNewerLinks</title>
<polygon fill="none" stroke="#000000" points="1048.3668,-509 881.6557,-509 881.6557,-473 1048.3668,-473 1048.3668,-509"/>
<text text-anchor="middle" x="965.0112" y="-486.8" font-family="Times,serif" font-size="14.00" fill="#000000">CreateMissingNewerLinks</text>
</g>
<!-- EnterAsBatchGroupLeader&#45;&gt;CreateMissingNewerLinks -->
<g id="edge31" class="edge">
<title>EnterAsBatchGroupLeader&#45;&gt;CreateMissingNewerLinks</title>
<path fill="none" stroke="#000000" d="M761.6488,-493.0094C797.0214,-492.6599 836.6313,-492.2685 871.43,-491.9247"/>
<polygon fill="#000000" stroke="#000000" points="871.621,-495.423 881.5859,-491.8243 871.5518,-488.4234 871.621,-495.423"/>
</g>
<!-- AllowWriteBatching -->
<g id="node27" class="node">
<title>AllowWriteBatching</title>
<polygon fill="none" stroke="#000000" points="1031.3717,-601 898.6508,-601 898.6508,-565 1031.3717,-565 1031.3717,-601"/>
<text text-anchor="middle" x="965.0112" y="-578.8" font-family="Times,serif" font-size="14.00" fill="#000000">AllowWriteBatching</text>
</g>
<!-- EnterAsBatchGroupLeader&#45;&gt;AllowWriteBatching -->
<g id="edge32" class="edge">
<title>EnterAsBatchGroupLeader&#45;&gt;AllowWriteBatching</title>
<path fill="none" stroke="#000000" d="M725.0398,-518.8814C753.9017,-529.6237 788.633,-541.8069 820.4873,-551 842.3272,-557.303 866.3288,-563.0706 888.3908,-567.9204"/>
<polygon fill="#000000" stroke="#000000" points="887.8619,-571.3869 898.3762,-570.0827 889.3435,-564.5455 887.8619,-571.3869"/>
</g>
<!-- DBImpl -->
<g id="node5" class="node">
<title>DBImpl</title>
<polygon fill="none" stroke="#000000" points="878.9653,-620 878.9653,-664 1051.0571,-664 1051.0571,-620 878.9653,-620"/>
<text text-anchor="middle" x="965.0112" y="-648.8" font-family="Times,serif" font-size="14.00" fill="#000000">DBImpl</text>
<polyline fill="none" stroke="#000000" points="878.9653,-642 1051.0571,-642 "/>
<text text-anchor="start" x="886.9653" y="-626.8" font-family="Times,serif" font-size="14.00" fill="#000000">WriteThread write_thread_;</text>
</g>
<!-- DBImpl&#45;&gt;WriteThread -->
<g id="edge2" class="edge">
<title>DBImpl:WriteThread&#45;&gt;WriteThread</title>
<path fill="none" stroke="#000000" d="M1051.0112,-631C1078.2099,-631 1107.1353,-630.9355 1135.1561,-630.8393"/>
<polygon fill="#000000" stroke="#000000" points="1135.4464,-634.3383 1145.4337,-630.8024 1135.4212,-627.3384 1135.4464,-634.3383"/>
</g>
<!-- DBImpl_WriteImpl -->
<g id="node6" class="node">
<title>DBImpl_WriteImpl</title>
<polygon fill="none" stroke="#000000" points="0,-201.2 0,-264.8 256.6797,-264.8 256.6797,-201.2 0,-201.2"/>
<text text-anchor="middle" x="128.3398" y="-249.6" font-family="Times,serif" font-size="14.00" fill="#000000">DBImpl_WriteImpl</text>
<polyline fill="none" stroke="#000000" points="0,-242.8 256.6797,-242.8 "/>
<text text-anchor="start" x="8" y="-227.6" font-family="Times,serif" font-size="14.00" fill="#000000">1.如果打开了enable_pipline_write则调用</text>
<text text-anchor="start" x="8" y="-208" font-family="Times,serif" font-size="14.00" fill="#000000"> PipelinedWriteImpl</text>
</g>
<!-- DBImpl_WriteImpl&#45;&gt;EnterAsBatchGroupLeader -->
<g id="edge4" class="edge">
<title>DBImpl_WriteImpl&#45;&gt;EnterAsBatchGroupLeader</title>
<path fill="none" stroke="#000000" d="M176.9373,-264.9085C251.8388,-312.9133 401.2108,-404.0369 538.2939,-460 543.2973,-462.0426 548.4638,-464.0044 553.7171,-465.8824"/>
<polygon fill="#000000" stroke="#000000" points="552.6555,-469.2185 563.2502,-469.1715 554.9386,-462.6013 552.6555,-469.2185"/>
</g>
<!-- JoinBatchGroup -->
<g id="node7" class="node">
<title>JoinBatchGroup</title>
<polygon fill="none" stroke="#000000" points="538.2939,-257.4001 538.2939,-326.5999 784.4873,-326.5999 784.4873,-257.4001 538.2939,-257.4001"/>
<text text-anchor="middle" x="661.3906" y="-311.3999" font-family="Times,serif" font-size="14.00" fill="#000000">JoinBatchGroup</text>
<polyline fill="none" stroke="#000000" points="538.2939,-304.5999 784.4873,-304.5999 "/>
<text text-anchor="start" x="546.2939" y="-289.3999" font-family="Times,serif" font-size="14.00" fill="#000000">1.加入batchGroup</text>
<text text-anchor="start" x="546.2939" y="-269.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 2.要么作为leader，要么等到目标状态</text>
</g>
<!-- DBImpl_WriteImpl&#45;&gt;JoinBatchGroup -->
<g id="edge5" class="edge">
<title>DBImpl_WriteImpl&#45;&gt;JoinBatchGroup</title>
<path fill="none" stroke="#000000" d="M209.0285,-264.917C235.2819,-273.8326 264.8354,-282.3488 292.6797,-287 369.865,-299.8934 457.4054,-301.6138 527.8137,-299.8915"/>
<polygon fill="#000000" stroke="#000000" points="528.1727,-303.3832 538.0742,-299.6134 527.983,-296.3857 528.1727,-303.3832"/>
</g>
<!-- CompleteParallelMemTableWriter -->
<g id="node8" class="node">
<title>CompleteParallelMemTableWriter</title>
<polygon fill="none" stroke="#000000" points="502.1014,-278 292.8722,-278 292.8722,-242 502.1014,-242 502.1014,-278"/>
<text text-anchor="middle" x="397.4868" y="-255.8" font-family="Times,serif" font-size="14.00" fill="#000000">CompleteParallelMemTableWriter</text>
</g>
<!-- DBImpl_WriteImpl&#45;&gt;CompleteParallelMemTableWriter -->
<g id="edge6" class="edge">
<title>DBImpl_WriteImpl&#45;&gt;CompleteParallelMemTableWriter</title>
<path fill="none" stroke="#000000" d="M257.0011,-245.9069C265.4567,-246.7551 273.9434,-247.6065 282.3274,-248.4476"/>
<polygon fill="#000000" stroke="#000000" points="282.1948,-251.9517 292.4942,-249.4675 282.8935,-244.9867 282.1948,-251.9517"/>
</g>
<!-- ExitAsBatchGroupFollower -->
<g id="node9" class="node">
<title>ExitAsBatchGroupFollower</title>
<polygon fill="none" stroke="#000000" points="748.2598,-131 574.5214,-131 574.5214,-95 748.2598,-95 748.2598,-131"/>
<text text-anchor="middle" x="661.3906" y="-108.8" font-family="Times,serif" font-size="14.00" fill="#000000">ExitAsBatchGroupFollower</text>
</g>
<!-- DBImpl_WriteImpl&#45;&gt;ExitAsBatchGroupFollower -->
<g id="edge7" class="edge">
<title>DBImpl_WriteImpl&#45;&gt;ExitAsBatchGroupFollower</title>
<path fill="none" stroke="#000000" d="M217.6568,-201.1299C241.8078,-193.2064 268.0747,-185.212 292.6797,-179 383.6103,-156.043 489.104,-138.0057 563.8949,-126.6308"/>
<polygon fill="#000000" stroke="#000000" points="564.8737,-130.0229 574.2397,-125.0702 563.8295,-123.1012 564.8737,-130.0229"/>
</g>
<!-- LaunchParallelMemTableWriters -->
<g id="node10" class="node">
<title>LaunchParallelMemTableWriters</title>
<polygon fill="none" stroke="#000000" points="498.5946,-108 296.379,-108 296.379,-72 498.5946,-72 498.5946,-108"/>
<text text-anchor="middle" x="397.4868" y="-85.8" font-family="Times,serif" font-size="14.00" fill="#000000">LaunchParallelMemTableWriters</text>
</g>
<!-- DBImpl_WriteImpl&#45;&gt;LaunchParallelMemTableWriters -->
<g id="edge8" class="edge">
<title>DBImpl_WriteImpl&#45;&gt;LaunchParallelMemTableWriters</title>
<path fill="none" stroke="#000000" d="M180.5538,-201.1221C212.5105,-182.0389 254.4698,-157.7376 292.6797,-138 309.9328,-129.0878 329.164,-120.0357 346.395,-112.2302"/>
<polygon fill="#000000" stroke="#000000" points="348.051,-115.3232 355.7368,-108.0308 345.1809,-108.9386 348.051,-115.3232"/>
</g>
<!-- DBImpl_PipelineWriteImpl -->
<g id="node11" class="node">
<title>DBImpl_PipelineWriteImpl</title>
<polygon fill="none" stroke="#000000" points="483.5168,-224 311.4569,-224 311.4569,-188 483.5168,-188 483.5168,-224"/>
<text text-anchor="middle" x="397.4868" y="-201.8" font-family="Times,serif" font-size="14.00" fill="#000000">DBImpl_PipelineWriteImpl</text>
</g>
<!-- DBImpl_WriteImpl&#45;&gt;DBImpl_PipelineWriteImpl -->
<g id="edge9" class="edge">
<title>DBImpl_WriteImpl&#45;&gt;DBImpl_PipelineWriteImpl</title>
<path fill="none" stroke="#000000" d="M257.0011,-220.0931C271.792,-218.6093 286.6783,-217.116 300.9434,-215.6849"/>
<polygon fill="#000000" stroke="#000000" points="301.61,-219.1357 311.2107,-214.655 300.9112,-212.1707 301.61,-219.1357"/>
</g>
<!-- LinkOne -->
<g id="node15" class="node">
<title>LinkOne</title>
<polygon fill="none" stroke="#000000" points="893.2524,-157.2 893.2524,-206.8 1036.77,-206.8 1036.77,-157.2 893.2524,-157.2"/>
<text text-anchor="middle" x="965.0112" y="-191.6" font-family="Times,serif" font-size="14.00" fill="#000000">LinkOne</text>
<polyline fill="none" stroke="#000000" points="893.2524,-184.8 1036.77,-184.8 "/>
<text text-anchor="middle" x="965.0112" y="-169.6" font-family="Times,serif" font-size="14.00" fill="#000000">尝试成为groupLeader</text>
</g>
<!-- JoinBatchGroup&#45;&gt;LinkOne -->
<g id="edge16" class="edge">
<title>JoinBatchGroup&#45;&gt;LinkOne</title>
<path fill="none" stroke="#000000" d="M767.0667,-257.3271C773.0717,-254.4062 778.9229,-251.2975 784.4873,-248 802.9037,-237.0863 801.4878,-225.8636 820.4873,-216 839.7427,-206.0036 861.9595,-198.9051 883.1088,-193.8796"/>
<polygon fill="#000000" stroke="#000000" points="884.0708,-197.2509 893.0608,-191.6446 882.5369,-190.421 884.0708,-197.2509"/>
</g>
<!-- SetState -->
<g id="node16" class="node">
<title>SetState</title>
<polygon fill="none" stroke="#000000" points="995.8942,-85 934.1283,-85 934.1283,-49 995.8942,-49 995.8942,-85"/>
<text text-anchor="middle" x="965.0112" y="-62.8" font-family="Times,serif" font-size="14.00" fill="#000000">SetState</text>
</g>
<!-- JoinBatchGroup&#45;&gt;SetState -->
<g id="edge17" class="edge">
<title>JoinBatchGroup&#45;&gt;SetState</title>
<path fill="none" stroke="#000000" d="M774.6457,-257.3983C778.164,-254.5127 781.4652,-251.3867 784.4873,-248 831.2867,-195.5551 769.6805,-142.5728 820.4873,-94 847.7072,-67.977 891.5532,-62.9808 923.8215,-63.4188"/>
<polygon fill="#000000" stroke="#000000" points="923.7513,-66.9182 933.8557,-63.7322 923.9699,-59.9216 923.7513,-66.9182"/>
</g>
<!-- AwaitState -->
<g id="node17" class="node">
<title>AwaitState</title>
<polygon fill="none" stroke="#000000" points="820.4873,-225.6001 820.4873,-400.3999 1109.5352,-400.3999 1109.5352,-225.6001 820.4873,-225.6001"/>
<text text-anchor="middle" x="965.0112" y="-385.1999" font-family="Times,serif" font-size="14.00" fill="#000000">AwaitState</text>
<polyline fill="none" stroke="#000000" points="820.4873,-378.3999 1109.5352,-378.3999 "/>
<text text-anchor="start" x="828.4873" y="-363.1999" font-family="Times,serif" font-size="14.00" fill="#000000">AwaitState(w, </text>
<text text-anchor="start" x="828.4873" y="-349.1999" font-family="Times,serif" font-size="14.00" fill="#000000">STATE_GROUP_LEADER </text>
<text text-anchor="start" x="828.4873" y="-335.1999" font-family="Times,serif" font-size="14.00" fill="#000000">| STATE_MEMTABLE_WRITER_LEADER </text>
<text text-anchor="start" x="828.4873" y="-321.1999" font-family="Times,serif" font-size="14.00" fill="#000000">| STATE_PARALLEL_MEMTABLE_WRITER </text>
<text text-anchor="start" x="828.4873" y="-307.1999" font-family="Times,serif" font-size="14.00" fill="#000000">| STATE_COMPLETED)</text>
<text text-anchor="start" x="828.4873" y="-293.1999" font-family="Times,serif" font-size="14.00" fill="#000000"> 1.轮询两百次直到state变为目标状态</text>
<polyline fill="none" stroke="#000000" points="820.4873,-280.8 1109.5352,-280.8 "/>
<text text-anchor="start" x="828.4873" y="-265.6" font-family="Times,serif" font-size="14.00" fill="#000000">2.使用thread yield</text>
<polyline fill="none" stroke="#000000" points="820.4873,-253.2 1109.5352,-253.2 "/>
<text text-anchor="start" x="828.4873" y="-238" font-family="Times,serif" font-size="14.00" fill="#000000">3.等待condVar</text>
</g>
<!-- JoinBatchGroup&#45;&gt;AwaitState -->
<g id="edge18" class="edge">
<title>JoinBatchGroup&#45;&gt;AwaitState</title>
<path fill="none" stroke="#000000" d="M784.8847,-300.5415C793.2629,-301.121 801.7604,-301.7087 810.2702,-302.2973"/>
<polygon fill="#000000" stroke="#000000" points="810.0415,-305.7897 820.2592,-302.9882 810.5245,-298.8064 810.0415,-305.7897"/>
</g>
<!-- LaunchParallelMemTableWriters&#45;&gt;SetState -->
<g id="edge37" class="edge">
<title>LaunchParallelMemTableWriters&#45;&gt;SetState</title>
<path fill="none" stroke="#000000" d="M498.6216,-85.9013C624.9407,-80.782 835.2112,-72.2604 923.7315,-68.6729"/>
<polygon fill="#000000" stroke="#000000" points="924.0592,-72.1626 933.9093,-68.2605 923.7757,-65.1684 924.0592,-72.1626"/>
</g>
<!-- DBImpl_PipelineWriteImpl&#45;&gt;EnterAsBatchGroupLeader -->
<g id="edge10" class="edge">
<title>DBImpl_PipelineWriteImpl&#45;&gt;EnterAsBatchGroupLeader</title>
<path fill="none" stroke="#000000" d="M483.6259,-218.8184C490.5962,-222.5119 496.9845,-227.1614 502.2939,-233 571.0191,-308.5739 470.2271,-383.8326 538.2939,-460 542.4109,-464.6069 547.0903,-468.6138 552.1607,-472.0966"/>
<polygon fill="#000000" stroke="#000000" points="550.6674,-475.2843 561.0329,-477.4766 554.297,-469.2987 550.6674,-475.2843"/>
</g>
<!-- DBImpl_PipelineWriteImpl&#45;&gt;JoinBatchGroup -->
<g id="edge11" class="edge">
<title>DBImpl_PipelineWriteImpl&#45;&gt;JoinBatchGroup</title>
<path fill="none" stroke="#000000" d="M472.8657,-224.0363C482.8271,-226.8227 492.8518,-229.8347 502.2939,-233 518.7284,-238.5094 522.1276,-241.7475 538.2939,-248 543.3212,-249.9443 548.4751,-251.9066 553.6889,-253.8667"/>
<polygon fill="#000000" stroke="#000000" points="552.5315,-257.1705 563.1241,-257.3883 554.9793,-250.6124 552.5315,-257.1705"/>
</g>
<!-- DBImpl_PipelineWriteImpl&#45;&gt;ExitAsBatchGroupFollower -->
<g id="edge12" class="edge">
<title>DBImpl_PipelineWriteImpl&#45;&gt;ExitAsBatchGroupFollower</title>
<path fill="none" stroke="#000000" d="M452.814,-187.9611C469.1423,-181.8254 486.7843,-174.3733 502.2939,-166 519.6611,-156.6239 520.2784,-148.0604 538.2939,-140 546.6538,-136.2597 555.5709,-133.0207 564.6395,-130.219"/>
<polygon fill="#000000" stroke="#000000" points="565.8943,-133.4992 574.5203,-127.3475 563.9408,-126.7773 565.8943,-133.4992"/>
</g>
<!-- WaitForPendingWrites -->
<g id="node12" class="node">
<title>WaitForPendingWrites</title>
<polygon fill="none" stroke="#000000" points="733.5851,-239 589.1962,-239 589.1962,-203 733.5851,-203 733.5851,-239"/>
<text text-anchor="middle" x="661.3906" y="-216.8" font-family="Times,serif" font-size="14.00" fill="#000000">WaitForPendingWrites</text>
</g>
<!-- DBImpl_PipelineWriteImpl&#45;&gt;WaitForPendingWrites -->
<g id="edge13" class="edge">
<title>DBImpl_PipelineWriteImpl&#45;&gt;WaitForPendingWrites</title>
<path fill="none" stroke="#000000" d="M483.5336,-210.8908C514.21,-212.6344 548.6678,-214.593 579.0271,-216.3185"/>
<polygon fill="#000000" stroke="#000000" points="578.9719,-219.821 589.1544,-216.8942 579.3692,-212.8322 578.9719,-219.821"/>
</g>
<!-- ExitAsMemTableWriter -->
<g id="node13" class="node">
<title>ExitAsMemTableWriter</title>
<polygon fill="none" stroke="#000000" points="737.2015,-185 585.5798,-185 585.5798,-149 737.2015,-149 737.2015,-185"/>
<text text-anchor="middle" x="661.3906" y="-162.8" font-family="Times,serif" font-size="14.00" fill="#000000">ExitAsMemTableWriter</text>
</g>
<!-- DBImpl_PipelineWriteImpl&#45;&gt;ExitAsMemTableWriter -->
<g id="edge14" class="edge">
<title>DBImpl_PipelineWriteImpl&#45;&gt;ExitAsMemTableWriter</title>
<path fill="none" stroke="#000000" d="M483.5336,-193.2839C513.0002,-188.9293 545.9558,-184.0591 575.4166,-179.7053"/>
<polygon fill="#000000" stroke="#000000" points="576.2992,-183.113 585.6801,-178.1886 575.2758,-176.1882 576.2992,-183.113"/>
</g>
<!-- EnterAsMemTableWriter -->
<g id="node14" class="node">
<title>EnterAsMemTableWriter</title>
<polygon fill="none" stroke="#000000" points="740.6878,-451 582.0935,-451 582.0935,-415 740.6878,-415 740.6878,-451"/>
<text text-anchor="middle" x="661.3906" y="-428.8" font-family="Times,serif" font-size="14.00" fill="#000000">EnterAsMemTableWriter</text>
</g>
<!-- DBImpl_PipelineWriteImpl&#45;&gt;EnterAsMemTableWriter -->
<g id="edge15" class="edge">
<title>DBImpl_PipelineWriteImpl&#45;&gt;EnterAsMemTableWriter</title>
<path fill="none" stroke="#000000" d="M483.5996,-220.3652C490.3978,-223.7575 496.7607,-227.9136 502.2939,-233 537.9952,-265.818 510.1243,-296.5275 538.2939,-336 560.0202,-366.4438 593.9059,-392.1609 620.6287,-409.4497"/>
<polygon fill="#000000" stroke="#000000" points="619.0652,-412.6019 629.3887,-414.9844 622.8042,-406.6841 619.0652,-412.6019"/>
</g>
<!-- ExitAsMemTableWriter&#45;&gt;SetState -->
<g id="edge35" class="edge">
<title>ExitAsMemTableWriter&#45;&gt;SetState</title>
<path fill="none" stroke="#000000" d="M737.1818,-158.9332C753.6252,-154.9054 770.3183,-148.9096 784.4873,-140 806.4645,-126.1805 798.297,-107.4747 820.4873,-94 851.7138,-75.0383 893.1982,-68.8394 923.7099,-67.0593"/>
<polygon fill="#000000" stroke="#000000" points="924.1756,-70.5421 934.0099,-66.6003 923.8639,-63.5491 924.1756,-70.5421"/>
</g>
<!-- newest_memtable_writer_ -->
<g id="node29" class="node">
<title>newest_memtable_writer_</title>
<polygon fill="none" stroke="#000000" points="1047.0159,-139 883.0066,-139 883.0066,-103 1047.0159,-103 1047.0159,-139"/>
<text text-anchor="middle" x="965.0112" y="-116.8" font-family="Times,serif" font-size="14.00" fill="#000000">newest_memtable_writer_</text>
</g>
<!-- ExitAsMemTableWriter&#45;&gt;newest_memtable_writer_ -->
<g id="edge36" class="edge">
<title>ExitAsMemTableWriter&#45;&gt;newest_memtable_writer_</title>
<path fill="none" stroke="#000000" d="M737.2237,-155.5109C778.3691,-149.2772 829.547,-141.5235 872.9642,-134.9456"/>
<polygon fill="#000000" stroke="#000000" points="873.5976,-138.3896 882.9604,-133.4311 872.549,-131.4686 873.5976,-138.3896"/>
</g>
<!-- EnterAsMemTableWriter&#45;&gt;CreateMissingNewerLinks -->
<g id="edge33" class="edge">
<title>EnterAsMemTableWriter&#45;&gt;CreateMissingNewerLinks</title>
<path fill="none" stroke="#000000" d="M740.6737,-448.5737C766.152,-453.5449 794.5042,-459.0416 820.4873,-464 836.9402,-467.1397 854.4544,-470.4439 871.4048,-473.6219"/>
<polygon fill="#000000" stroke="#000000" points="870.8341,-477.0758 881.3075,-475.4763 872.1226,-470.1954 870.8341,-477.0758"/>
</g>
<!-- HasMerge -->
<g id="node28" class="node">
<title>HasMerge</title>
<polygon fill="none" stroke="#000000" points="1002.0757,-455 927.9467,-455 927.9467,-419 1002.0757,-419 1002.0757,-455"/>
<text text-anchor="middle" x="965.0112" y="-432.8" font-family="Times,serif" font-size="14.00" fill="#000000">HasMerge</text>
</g>
<!-- EnterAsMemTableWriter&#45;&gt;HasMerge -->
<g id="edge34" class="edge">
<title>EnterAsMemTableWriter&#45;&gt;HasMerge</title>
<path fill="none" stroke="#000000" d="M740.7668,-434.0457C796.9589,-434.786 870.4449,-435.7542 917.6957,-436.3766"/>
<polygon fill="#000000" stroke="#000000" points="917.9022,-439.8796 927.9475,-436.5117 917.9945,-432.8802 917.9022,-439.8796"/>
</g>
<!-- newest_writer_ -->
<g id="node18" class="node">
<title>newest_writer_</title>
<polygon fill="none" stroke="#000000" points="1343.2773,-224 1240.669,-224 1240.669,-188 1343.2773,-188 1343.2773,-224"/>
<text text-anchor="middle" x="1291.9731" y="-201.8" font-family="Times,serif" font-size="14.00" fill="#000000">newest_writer_</text>
</g>
<!-- LinkOne&#45;&gt;newest_writer_ -->
<g id="edge19" class="edge">
<title>LinkOne&#45;&gt;newest_writer_</title>
<path fill="none" stroke="#000000" d="M1037.1692,-187.2966C1095.1181,-191.5502 1175.6075,-197.4584 1230.5163,-201.4889"/>
<polygon fill="#000000" stroke="#000000" points="1230.5717,-205.0023 1240.8011,-202.2438 1231.0842,-198.0211 1230.5717,-205.0023"/>
</g>
<!-- stall_cv_Wait -->
<g id="node19" class="node">
<title>stall_cv_Wait</title>
<polygon fill="none" stroke="#000000" points="1338.1115,-170 1245.8347,-170 1245.8347,-134 1338.1115,-134 1338.1115,-170"/>
<text text-anchor="middle" x="1291.9731" y="-147.8" font-family="Times,serif" font-size="14.00" fill="#000000">stall_cv_Wait</text>
</g>
<!-- LinkOne&#45;&gt;stall_cv_Wait -->
<g id="edge20" class="edge">
<title>LinkOne&#45;&gt;stall_cv_Wait</title>
<path fill="none" stroke="#000000" d="M1037.1692,-175.3792C1096.8849,-169.9001 1180.5363,-162.2248 1235.4658,-157.1848"/>
<polygon fill="#000000" stroke="#000000" points="1236.0759,-160.6436 1245.7142,-156.2444 1235.4362,-153.6729 1236.0759,-160.6436"/>
</g>
<!-- SetState&#45;&gt;Writer -->
<g id="edge28" class="edge">
<title>SetState&#45;&gt;Writer</title>
<path fill="none" stroke="#000000" d="M995.9649,-71.5303C1031.895,-76.7324 1092.9509,-85.3975 1145.5352,-92 1210.5203,-100.1595 1387.5662,-83.7151 1438.4111,-125 1478.0173,-157.1593 1451.932,-188.2009 1474.4111,-234 1474.5633,-234.3101 1474.716,-234.6203 1474.869,-234.9306"/>
<polygon fill="#000000" stroke="#000000" points="1471.7873,-236.5929 1479.4156,-243.9454 1478.0374,-233.4406 1471.7873,-236.5929"/>
</g>
<!-- StateCV_noitfy_one -->
<g id="node25" class="node">
<title>StateCV_noitfy_one</title>
<polygon fill="none" stroke="#000000" points="1357.5699,-52 1226.3764,-52 1226.3764,-16 1357.5699,-16 1357.5699,-52"/>
<text text-anchor="middle" x="1291.9731" y="-29.8" font-family="Times,serif" font-size="14.00" fill="#000000">StateCV_noitfy_one</text>
</g>
<!-- SetState&#45;&gt;StateCV_noitfy_one -->
<g id="edge29" class="edge">
<title>SetState&#45;&gt;StateCV_noitfy_one</title>
<path fill="none" stroke="#000000" d="M996.0658,-63.8657C1046.2035,-58.8053 1146.4119,-48.6914 1216.2509,-41.6426"/>
<polygon fill="#000000" stroke="#000000" points="1216.7272,-45.1124 1226.3251,-40.6258 1216.0242,-38.1478 1216.7272,-45.1124"/>
</g>
<!-- AwaitState&#45;&gt;Writer -->
<g id="edge21" class="edge">
<title>AwaitState&#45;&gt;Writer</title>
<path fill="none" stroke="#000000" d="M1109.8059,-335.7822C1121.8871,-337.5845 1133.9175,-339.3456 1145.5352,-341 1275.4824,-359.5049 1310.735,-348.5448 1438.4111,-379 1447.0746,-381.0665 1455.907,-383.406 1464.7718,-385.9356"/>
<polygon fill="#000000" stroke="#000000" points="1463.8167,-389.3028 1474.3972,-388.7513 1465.7821,-382.5844 1463.8167,-389.3028"/>
</g>
<!-- AsmVolatilePause -->
<g id="node20" class="node">
<title>AsmVolatilePause</title>
<polygon fill="none" stroke="#000000" points="1351.3762,-278 1232.5701,-278 1232.5701,-242 1351.3762,-242 1351.3762,-278"/>
<text text-anchor="middle" x="1291.9731" y="-255.8" font-family="Times,serif" font-size="14.00" fill="#000000">AsmVolatilePause</text>
</g>
<!-- AwaitState&#45;&gt;AsmVolatilePause -->
<g id="edge22" class="edge">
<title>AwaitState&#45;&gt;AsmVolatilePause</title>
<path fill="none" stroke="#000000" d="M1109.8493,-289.522C1149.0136,-283.1735 1189.624,-276.5906 1222.5313,-271.2564"/>
<polygon fill="#000000" stroke="#000000" points="1223.1755,-274.6978 1232.4865,-269.6427 1222.0553,-267.788 1223.1755,-274.6978"/>
</g>
<!-- std_this_thread_yield -->
<g id="node21" class="node">
<title>std_this_thread_yield</title>
<polygon fill="none" stroke="#000000" points="1360.012,-424 1223.9343,-424 1223.9343,-388 1360.012,-388 1360.012,-424"/>
<text text-anchor="middle" x="1291.9731" y="-401.8" font-family="Times,serif" font-size="14.00" fill="#000000">std_this_thread_yield</text>
</g>
<!-- AwaitState&#45;&gt;std_this_thread_yield -->
<g id="edge23" class="edge">
<title>AwaitState&#45;&gt;std_this_thread_yield</title>
<path fill="none" stroke="#000000" d="M1109.9093,-363.5172C1121.9118,-367.2269 1133.8994,-370.7734 1145.5352,-374 1167.499,-380.0905 1191.575,-385.7592 1213.7469,-390.5819"/>
<polygon fill="#000000" stroke="#000000" points="1213.2738,-394.06 1223.7856,-392.7366 1214.7429,-387.2159 1213.2738,-394.06"/>
</g>
<!-- BlockingAwaitState -->
<g id="node22" class="node">
<title>BlockingAwaitState</title>
<polygon fill="none" stroke="#000000" points="1356.2263,-332 1227.72,-332 1227.72,-296 1356.2263,-296 1356.2263,-332"/>
<text text-anchor="middle" x="1291.9731" y="-309.8" font-family="Times,serif" font-size="14.00" fill="#000000">BlockingAwaitState</text>
</g>
<!-- AwaitState&#45;&gt;BlockingAwaitState -->
<g id="edge24" class="edge">
<title>AwaitState&#45;&gt;BlockingAwaitState</title>
<path fill="none" stroke="#000000" d="M1109.8493,-313.443C1146.9952,-313.5566 1185.442,-313.6742 1217.3834,-313.7719"/>
<polygon fill="#000000" stroke="#000000" points="1217.5048,-317.2722 1227.5155,-313.8029 1217.5263,-310.2722 1217.5048,-317.2722"/>
</g>
<!-- BlockingAwaitState&#45;&gt;Writer -->
<g id="edge25" class="edge">
<title>BlockingAwaitState&#45;&gt;Writer</title>
<path fill="none" stroke="#000000" d="M1356.1568,-323.9832C1382.1625,-329.0626 1412.1849,-336.2645 1438.4111,-346 1447.2166,-349.2687 1456.1255,-352.9094 1465.0174,-356.8067"/>
<polygon fill="#000000" stroke="#000000" points="1463.7158,-360.0588 1474.2726,-360.9563 1466.5796,-353.6714 1463.7158,-360.0588"/>
</g>
<!-- CreateMutex -->
<g id="node23" class="node">
<title>CreateMutex</title>
<polygon fill="none" stroke="#000000" points="1658.6612,-225 1569.4951,-225 1569.4951,-189 1658.6612,-189 1658.6612,-225"/>
<text text-anchor="middle" x="1614.0781" y="-202.8" font-family="Times,serif" font-size="14.00" fill="#000000">CreateMutex</text>
</g>
<!-- BlockingAwaitState&#45;&gt;CreateMutex -->
<g id="edge26" class="edge">
<title>BlockingAwaitState&#45;&gt;CreateMutex</title>
<path fill="none" stroke="#000000" d="M1356.1323,-312.8595C1383.3026,-309.7855 1414.2027,-302.6466 1438.4111,-287 1462.0186,-271.7418 1450.9228,-250.441 1474.4111,-235 1499.3316,-218.6175 1531.7665,-211.4562 1559.1062,-208.4639"/>
<polygon fill="#000000" stroke="#000000" points="1559.6777,-211.9258 1569.3087,-207.5106 1559.0264,-204.9562 1559.6777,-211.9258"/>
</g>
<!-- StateCV_wait -->
<g id="node24" class="node">
<title>StateCV_wait</title>
<polygon fill="none" stroke="#000000" points="1661.1241,-52 1567.0321,-52 1567.0321,-16 1661.1241,-16 1661.1241,-52"/>
<text text-anchor="middle" x="1614.0781" y="-29.8" font-family="Times,serif" font-size="14.00" fill="#000000">StateCV_wait</text>
</g>
<!-- BlockingAwaitState&#45;&gt;StateCV_wait -->
<g id="edge27" class="edge">
<title>BlockingAwaitState&#45;&gt;StateCV_wait</title>
<path fill="none" stroke="#000000" d="M1356.2343,-316.1445C1384.3931,-313.8369 1416.0463,-306.3905 1438.4111,-287 1476.3214,-254.1314 1448.4471,-222.9348 1474.4111,-180 1503.8206,-131.3678 1551.9485,-85.8124 1583.321,-58.9193"/>
<polygon fill="#000000" stroke="#000000" points="1585.929,-61.2976 1591.3047,-52.1678 1581.4089,-55.9525 1585.929,-61.2976"/>
</g>
<!-- StateCV_noitfy_one&#45;&gt;StateCV_wait -->
<g id="edge38" class="edge">
<title>StateCV_noitfy_one&#45;&gt;StateCV_wait</title>
<path fill="none" stroke="#000000" d="M1357.5441,-34C1416.0739,-34 1500.9356,-34 1556.7938,-34"/>
<polygon fill="#000000" stroke="#000000" points="1556.8734,-37.5001 1566.8734,-34 1556.8734,-30.5001 1556.8734,-37.5001"/>
</g>
</g>
</svg>
