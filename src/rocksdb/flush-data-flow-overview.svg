<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: flush_data_flow_overview Pages: 1 -->
<svg width="1215pt" height="351pt"
 viewBox="0.00 0.00 1215.39 351.10" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 347.0999)">
<title>flush_data_flow_overview</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-347.0999 1211.3936,-347.0999 1211.3936,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_ColumnFamilyData</title>
<polygon fill="none" stroke="#000000" points="615.5098,-8 615.5098,-156 1044.0479,-156 1044.0479,-8 615.5098,-8"/>
<text text-anchor="middle" x="829.7788" y="-136" font-family="Times,serif" font-size="20.00" fill="#000000">ColumnFamilyData</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_Disk</title>
<polygon fill="none" stroke="#000000" points="394.3066,-164 394.3066,-258 1199.3936,-258 1199.3936,-164 394.3066,-164"/>
<text text-anchor="middle" x="796.8501" y="-238" font-family="Times,serif" font-size="20.00" fill="#000000">Disk</text>
</g>
<!-- WriteInteralBatch -->
<g id="node1" class="node">
<title>WriteInteralBatch</title>
<polygon fill="none" stroke="#000000" points="156.2275,-101.2 156.2275,-164.8 283.4277,-164.8 283.4277,-101.2 156.2275,-101.2"/>
<text text-anchor="middle" x="219.8276" y="-149.6" font-family="Times,serif" font-size="14.00" fill="#000000">WriteInteralBatch</text>
<polyline fill="none" stroke="#000000" points="156.2275,-142.8 283.4277,-142.8 "/>
<text text-anchor="start" x="164.2275" y="-127.6" font-family="Times,serif" font-size="14.00" fill="#000000">将put/delete等写入</text>
<text text-anchor="start" x="164.2275" y="-108" font-family="Times,serif" font-size="14.00" fill="#000000"> Rep buffer</text>
</g>
<!-- MemTableInsertor -->
<g id="node2" class="node">
<title>MemTableInsertor</title>
<polygon fill="none" stroke="#000000" points="319.4277,-61.4001 319.4277,-130.5999 587.5098,-130.5999 587.5098,-61.4001 319.4277,-61.4001"/>
<text text-anchor="middle" x="453.4688" y="-115.3999" font-family="Times,serif" font-size="14.00" fill="#000000">MemTableInsertor</text>
<polyline fill="none" stroke="#000000" points="319.4277,-108.5999 587.5098,-108.5999 "/>
<text text-anchor="start" x="327.4277" y="-93.3999" font-family="Times,serif" font-size="14.00" fill="#000000">遍历WriterInternalBatch</text>
<text text-anchor="middle" x="453.4688" y="-73.8" font-family="Times,serif" font-size="14.00" fill="#000000"> Buffer插入columnFamilyData的mem_table</text>
</g>
<!-- WriteInteralBatch&#45;&gt;MemTableInsertor -->
<g id="edge3" class="edge">
<title>WriteInteralBatch&#45;&gt;MemTableInsertor</title>
<path fill="none" stroke="#666666" d="M283.6711,-122.8896C291.8189,-121.5993 300.403,-120.2399 309.2074,-118.8456"/>
<polygon fill="#666666" stroke="#666666" points="309.9007,-122.2795 319.2301,-117.2584 308.8057,-115.3657 309.9007,-122.2795"/>
</g>
<!-- WALLog -->
<g id="node7" class="node">
<title>WALLog</title>
<polygon fill="none" stroke="#000000" points="402.3066,-172.2 402.3066,-221.8 504.6309,-221.8 504.6309,-172.2 402.3066,-172.2"/>
<text text-anchor="middle" x="453.4688" y="-206.6" font-family="Times,serif" font-size="14.00" fill="#000000">WALLog</text>
<polyline fill="none" stroke="#000000" points="402.3066,-199.8 504.6309,-199.8 "/>
<text text-anchor="middle" x="453.4688" y="-184.6" font-family="Times,serif" font-size="14.00" fill="#000000">写入WAL日志</text>
</g>
<!-- WriteInteralBatch&#45;&gt;WALLog -->
<g id="edge11" class="edge">
<title>WriteInteralBatch&#45;&gt;WALLog</title>
<path fill="none" stroke="#666666" d="M283.6711,-150.4883C317.6114,-159.7854 359.1209,-171.1558 392.6021,-180.3271"/>
<polygon fill="#666666" stroke="#666666" points="391.698,-183.7084 402.2674,-182.9747 393.5474,-176.9571 391.698,-183.7084"/>
</g>
<!-- ColumnFamilyData_mem -->
<g id="node3" class="node">
<title>ColumnFamilyData_mem</title>
<polygon fill="none" stroke="#000000" points="623.5098,-26.6001 623.5098,-115.3999 844.458,-115.3999 844.458,-26.6001 623.5098,-26.6001"/>
<text text-anchor="middle" x="733.9839" y="-100.1999" font-family="Times,serif" font-size="14.00" fill="#000000">ColumnFamilyData_mem</text>
<polyline fill="none" stroke="#000000" points="623.5098,-93.3999 844.458,-93.3999 "/>
<text text-anchor="start" x="631.5098" y="-78.1999" font-family="Times,serif" font-size="14.00" fill="#000000">先插入mem_，如果mem_满了</text>
<text text-anchor="start" x="631.5098" y="-58.6" font-family="Times,serif" font-size="14.00" fill="#000000"> 将mem_转为imm, 加入imm_list中</text>
<text text-anchor="start" x="631.5098" y="-39" font-family="Times,serif" font-size="14.00" fill="#000000"> 并创建新的mem</text>
</g>
<!-- MemTableInsertor&#45;&gt;ColumnFamilyData_mem -->
<g id="edge4" class="edge">
<title>MemTableInsertor&#45;&gt;ColumnFamilyData_mem</title>
<path fill="none" stroke="#666666" d="M587.5644,-84.0492C596.1702,-83.2822 604.807,-82.5125 613.3448,-81.7516"/>
<polygon fill="#666666" stroke="#666666" points="613.6645,-85.237 623.3143,-80.8631 613.0431,-78.2647 613.6645,-85.237"/>
</g>
<!-- ColumnFamilyData_imm_list -->
<g id="node4" class="node">
<title>ColumnFamilyData_imm_list</title>
<polygon fill="none" stroke="#000000" points="880.458,-16.6001 880.458,-119.3999 1036.0479,-119.3999 1036.0479,-16.6001 880.458,-16.6001"/>
<text text-anchor="middle" x="958.2529" y="-104.1999" font-family="Times,serif" font-size="14.00" fill="#000000">imm_</text>
<polyline fill="none" stroke="#000000" points="880.458,-97.3999 1036.0479,-97.3999 "/>
<text text-anchor="start" x="888.458" y="-82.1999" font-family="Times,serif" font-size="14.00" fill="#000000">imm_table list</text>
<text text-anchor="start" x="888.458" y="-68.1999" font-family="Times,serif" font-size="14.00" fill="#000000"> 通过SchedulWorke,将</text>
<text text-anchor="start" x="888.458" y="-48.6" font-family="Times,serif" font-size="14.00" fill="#000000"> columnFaimlyData放入</text>
<text text-anchor="start" x="888.458" y="-29" font-family="Times,serif" font-size="14.00" fill="#000000"> flush_queue中</text>
</g>
<!-- ColumnFamilyData_mem&#45;&gt;ColumnFamilyData_imm_list -->
<g id="edge1" class="edge">
<title>ColumnFamilyData_mem&#45;&gt;ColumnFamilyData_imm_list</title>
<path fill="none" stroke="#666666" d="M844.4759,-69.522C853.0438,-69.4074 861.6245,-69.2926 870.0179,-69.1803"/>
<polygon fill="#666666" stroke="#666666" points="870.1974,-72.6783 880.1496,-69.0448 870.1037,-65.6789 870.1974,-72.6783"/>
</g>
<!-- flush_queue_ -->
<g id="node9" class="node">
<title>flush_queue_</title>
<polygon fill="#95e1d3" stroke="#000000" points="1072.0479,-43.2 1072.0479,-92.8 1192.2754,-92.8 1192.2754,-43.2 1072.0479,-43.2"/>
<text text-anchor="middle" x="1132.1616" y="-77.6" font-family="Times,serif" font-size="14.00" fill="#000000">flush_queue_</text>
<polyline fill="none" stroke="#000000" points="1072.0479,-70.8 1192.2754,-70.8 "/>
<text text-anchor="middle" x="1132.1616" y="-55.6" font-family="Times,serif" font-size="14.00" fill="#000000">FlushRequest队列</text>
</g>
<!-- ColumnFamilyData_imm_list&#45;&gt;flush_queue_ -->
<g id="edge5" class="edge">
<title>ColumnFamilyData_imm_list&#45;&gt;flush_queue_</title>
<path fill="none" stroke="#666666" d="M1036.0514,-68C1044.6027,-68 1053.2735,-68 1061.7279,-68"/>
<polygon fill="#666666" stroke="#666666" points="1061.9106,-71.5001 1071.9106,-68 1061.9105,-64.5001 1061.9106,-71.5001"/>
</g>
<!-- BackgrounFlush -->
<g id="node5" class="node">
<title>BackgrounFlush</title>
<polygon fill="none" stroke="#000000" points="162.8276,-259.4001 162.8276,-342.5999 276.8276,-342.5999 276.8276,-259.4001 162.8276,-259.4001"/>
<text text-anchor="middle" x="219.8276" y="-327.3999" font-family="Times,serif" font-size="14.00" fill="#000000">BackgrounFlush</text>
<polyline fill="none" stroke="#000000" points="162.8276,-320.5999 276.8276,-320.5999 "/>
<text text-anchor="start" x="170.8276" y="-305.3999" font-family="Times,serif" font-size="14.00" fill="#000000">后台线程将队列</text>
<text text-anchor="start" x="170.8276" y="-285.8" font-family="Times,serif" font-size="14.00" fill="#000000"> FlushRequest</text>
<text text-anchor="start" x="170.8276" y="-271.8" font-family="Times,serif" font-size="14.00" fill="#000000"> 刷盘</text>
</g>
<!-- FlushJob -->
<g id="node12" class="node">
<title>FlushJob</title>
<polygon fill="none" stroke="#000000" points="486.5424,-319 420.3951,-319 420.3951,-283 486.5424,-283 486.5424,-319"/>
<text text-anchor="middle" x="453.4688" y="-296.8" font-family="Times,serif" font-size="14.00" fill="#000000">FlushJob</text>
</g>
<!-- BackgrounFlush&#45;&gt;FlushJob -->
<g id="edge7" class="edge">
<title>BackgrounFlush&#45;&gt;FlushJob</title>
<path fill="none" stroke="#666666" d="M276.9827,-301C318.1036,-301 372.7069,-301 410.2289,-301"/>
<polygon fill="#666666" stroke="#666666" points="410.3337,-304.5001 420.3337,-301 410.3337,-297.5001 410.3337,-304.5001"/>
</g>
<!-- WriteLevel0Table -->
<g id="node6" class="node">
<title>WriteLevel0Table</title>
<polygon fill="none" stroke="#000000" points="659.0122,-266.4001 659.0122,-335.5999 808.9556,-335.5999 808.9556,-266.4001 659.0122,-266.4001"/>
<text text-anchor="middle" x="733.9839" y="-320.3999" font-family="Times,serif" font-size="14.00" fill="#000000">WriteLevel0Table</text>
<polyline fill="none" stroke="#000000" points="659.0122,-313.5999 808.9556,-313.5999 "/>
<text text-anchor="start" x="667.0122" y="-298.3999" font-family="Times,serif" font-size="14.00" fill="#000000">调用TableBuilder将</text>
<text text-anchor="start" x="667.0122" y="-278.8" font-family="Times,serif" font-size="14.00" fill="#000000"> MemTable写入文件中</text>
</g>
<!-- TableBuilder -->
<g id="node13" class="node">
<title>TableBuilder</title>
<polygon fill="none" stroke="#000000" points="1002.6378,-310 913.8681,-310 913.8681,-274 1002.6378,-274 1002.6378,-310"/>
<text text-anchor="middle" x="958.2529" y="-287.8" font-family="Times,serif" font-size="14.00" fill="#000000">TableBuilder</text>
</g>
<!-- WriteLevel0Table&#45;&gt;TableBuilder -->
<g id="edge9" class="edge">
<title>WriteLevel0Table&#45;&gt;TableBuilder</title>
<path fill="none" stroke="#666666" d="M808.974,-297.9906C839.9349,-296.7481 875.1547,-295.3348 903.6063,-294.193"/>
<polygon fill="#666666" stroke="#666666" points="903.9103,-297.6837 913.7619,-293.7854 903.6295,-290.6893 903.9103,-297.6837"/>
</g>
<!-- SSTableFile -->
<g id="node8" class="node">
<title>SSTableFile</title>
<polygon fill="none" stroke="#000000" points="1072.9297,-172.2 1072.9297,-221.8 1191.3936,-221.8 1191.3936,-172.2 1072.9297,-172.2"/>
<text text-anchor="middle" x="1132.1616" y="-206.6" font-family="Times,serif" font-size="14.00" fill="#000000">SSTableFile</text>
<polyline fill="none" stroke="#000000" points="1072.9297,-199.8 1191.3936,-199.8 "/>
<text text-anchor="middle" x="1132.1616" y="-184.6" font-family="Times,serif" font-size="14.00" fill="#000000">最终SSTable文件</text>
</g>
<!-- flush_queue_2 -->
<g id="node10" class="node">
<title>flush_queue_2</title>
<polygon fill="#95e1d3" stroke="#000000" points="0,-276.2 0,-325.8 120.2275,-325.8 120.2275,-276.2 0,-276.2"/>
<text text-anchor="middle" x="60.1138" y="-310.6" font-family="Times,serif" font-size="14.00" fill="#000000">flush_queue_</text>
<polyline fill="none" stroke="#000000" points="0,-303.8 120.2275,-303.8 "/>
<text text-anchor="middle" x="60.1138" y="-288.6" font-family="Times,serif" font-size="14.00" fill="#000000">FlushRequest队列</text>
</g>
<!-- flush_queue_2&#45;&gt;BackgrounFlush -->
<g id="edge6" class="edge">
<title>flush_queue_2&#45;&gt;BackgrounFlush</title>
<path fill="none" stroke="#666666" d="M120.4947,-301C131.0047,-301 141.9939,-301 152.6723,-301"/>
<polygon fill="#666666" stroke="#666666" points="152.7892,-304.5001 162.7891,-301 152.7891,-297.5001 152.7892,-304.5001"/>
</g>
<!-- WriteImpl -->
<g id="node11" class="node">
<title>WriteImpl</title>
<polygon fill="none" stroke="#000000" points="96.871,-151 23.3565,-151 23.3565,-115 96.871,-115 96.871,-151"/>
<text text-anchor="middle" x="60.1138" y="-128.8" font-family="Times,serif" font-size="14.00" fill="#000000">WriteImpl</text>
</g>
<!-- WriteImpl&#45;&gt;WriteInteralBatch -->
<g id="edge2" class="edge">
<title>WriteImpl&#45;&gt;WriteInteralBatch</title>
<path fill="none" stroke="#666666" d="M97.1568,-133C111.6561,-133 128.8289,-133 145.6627,-133"/>
<polygon fill="#666666" stroke="#666666" points="146.0734,-136.5001 156.0734,-133 146.0733,-129.5001 146.0734,-136.5001"/>
</g>
<!-- FlushJob&#45;&gt;WriteLevel0Table -->
<g id="edge8" class="edge">
<title>FlushJob&#45;&gt;WriteLevel0Table</title>
<path fill="none" stroke="#666666" d="M486.7491,-301C526.4385,-301 594.2655,-301 648.848,-301"/>
<polygon fill="#666666" stroke="#666666" points="648.8758,-304.5001 658.8758,-301 648.8758,-297.5001 648.8758,-304.5001"/>
</g>
<!-- TableBuilder&#45;&gt;SSTableFile -->
<g id="edge10" class="edge">
<title>TableBuilder&#45;&gt;SSTableFile</title>
<path fill="none" stroke="#666666" d="M1002.8111,-284.5C1016.501,-281.1742 1031.3073,-276.4948 1044.0479,-270 1064.7329,-259.4552 1084.8964,-243.3232 1100.7031,-228.9035"/>
<polygon fill="#666666" stroke="#666666" points="1103.1798,-231.3794 1108.096,-221.9943 1098.4002,-226.2652 1103.1798,-231.3794"/>
</g>
</g>
</svg>
