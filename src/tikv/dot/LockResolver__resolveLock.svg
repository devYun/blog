<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.1 (20210417.1919)
 -->
<!-- Title: dig Pages: 1 -->
<svg width="1440pt" height="520pt"
 viewBox="0.00 0.00 1440.00 520.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 516)">
<title>dig</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-516 1436,-516 1436,4 -4,4"/>
<!-- LockResolver__resolveLocks -->
<g id="node1" class="node">
<title>LockResolver__resolveLocks</title>
<path fill="none" stroke="#1c2123" d="M12,-399C12,-399 155,-399 155,-399 161,-399 167,-405 167,-411 167,-411 167,-463 167,-463 167,-469 161,-475 155,-475 155,-475 12,-475 12,-475 6,-475 0,-469 0,-463 0,-463 0,-411 0,-411 0,-405 6,-399 12,-399"/>
<text text-anchor="start" x="8" y="-459.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">LockResolver::resolvelocks</text>
<polyline fill="none" stroke="#1c2123" points="0,-452 167,-452 "/>
<text text-anchor="start" x="8" y="-436.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">遍历locks</text>
<text text-anchor="start" x="8" y="-421.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 对于每个Lock</text>
<text text-anchor="start" x="8" y="-406.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 调用resolve方法</text>
</g>
<!-- cleanRegions -->
<g id="node2" class="node">
<title>cleanRegions</title>
<path fill="#feed9b" stroke="#f7e495" d="M1123,-365C1123,-365 1264,-365 1264,-365 1270,-365 1276,-371 1276,-377 1276,-377 1276,-399 1276,-399 1276,-405 1270,-411 1264,-411 1264,-411 1123,-411 1123,-411 1117,-411 1111,-405 1111,-399 1111,-399 1111,-377 1111,-377 1111,-371 1117,-365 1123,-365"/>
<text text-anchor="start" x="1119" y="-395.8" font-family="Times,serif" font-size="14.00" fill="#40575d">cleanRegions</text>
<polyline fill="none" stroke="#f7e495" points="1111,-388 1276,-388 "/>
<text text-anchor="start" x="1119" y="-372.8" font-family="Times,serif" font-size="14.00" fill="#40575d">map[RegionVerID]struct{}</text>
</g>
<!-- LockResolver__resolveLocks&#45;&gt;cleanRegions -->
<g id="edge1" class="edge">
<title>LockResolver__resolveLocks&#45;&gt;cleanRegions</title>
<path fill="none" stroke="#666666" d="M167.2,-467.07C231.96,-487.94 324.78,-512 408.5,-512 408.5,-512 408.5,-512 878,-512 981.56,-512 1091.76,-453.1 1150.26,-416.48"/>
<polygon fill="#666666" stroke="#666666" points="1152.28,-419.35 1158.85,-411.03 1148.53,-413.43 1152.28,-419.35"/>
</g>
<!-- cleanTxns -->
<g id="node3" class="node">
<title>cleanTxns</title>
<path fill="#feed9b" stroke="#f7e495" d="M305,-437C305,-437 514,-437 514,-437 520,-437 526,-443 526,-449 526,-449 526,-471 526,-471 526,-477 520,-483 514,-483 514,-483 305,-483 305,-483 299,-483 293,-477 293,-471 293,-471 293,-449 293,-449 293,-443 299,-437 305,-437"/>
<text text-anchor="start" x="301" y="-467.8" font-family="Times,serif" font-size="14.00" fill="#40575d">cleanTxns</text>
<polyline fill="none" stroke="#f7e495" points="293,-460 526,-460 "/>
<text text-anchor="middle" x="409.5" y="-444.8" font-family="Times,serif" font-size="14.00" fill="#40575d">map[uint64]map[RegionVerID]struct{}</text>
</g>
<!-- LockResolver__resolveLocks&#45;&gt;cleanTxns -->
<g id="edge2" class="edge">
<title>LockResolver__resolveLocks&#45;&gt;cleanTxns</title>
<path fill="none" stroke="#666666" d="M167.1,-442.86C202.12,-445.35 243.72,-448.3 282.44,-451.05"/>
<polygon fill="#666666" stroke="#666666" points="282.52,-454.57 292.74,-451.78 283.02,-447.58 282.52,-454.57"/>
</g>
<!-- locks -->
<g id="node4" class="node">
<title>locks</title>
<path fill="none" stroke="#1c2123" d="M245,-432C245,-432 215,-432 215,-432 209,-432 203,-426 203,-420 203,-420 203,-408 203,-408 203,-402 209,-396 215,-396 215,-396 245,-396 245,-396 251,-396 257,-402 257,-408 257,-408 257,-420 257,-420 257,-426 251,-432 245,-432"/>
<text text-anchor="middle" x="230" y="-410.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">locks</text>
</g>
<!-- LockResolver__resolveLocks&#45;&gt;locks -->
<g id="edge3" class="edge">
<title>LockResolver__resolveLocks&#45;&gt;locks</title>
<path fill="none" stroke="#666666" d="M167.3,-423.82C176.24,-422.4 184.97,-421.01 192.91,-419.74"/>
<polygon fill="#666666" stroke="#666666" points="193.52,-423.19 202.85,-418.16 192.42,-416.28 193.52,-423.19"/>
</g>
<!-- resolve -->
<g id="node5" class="node">
<title>resolve</title>
<path fill="none" stroke="#1c2123" d="M375,-345C375,-345 444,-345 444,-345 450,-345 456,-351 456,-357 456,-357 456,-379 456,-379 456,-385 450,-391 444,-391 444,-391 375,-391 375,-391 369,-391 363,-385 363,-379 363,-379 363,-357 363,-357 363,-351 369,-345 375,-345"/>
<text text-anchor="start" x="371" y="-375.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">resolve</text>
<polyline fill="none" stroke="#1c2123" points="363,-368 456,-368 "/>
<text text-anchor="start" x="371" y="-352.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">处理单个key</text>
</g>
<!-- LockResolver__resolveLocks&#45;&gt;resolve -->
<g id="edge4" class="edge">
<title>LockResolver__resolveLocks&#45;&gt;resolve</title>
<path fill="none" stroke="#666666" d="M165.61,-398.95C177.93,-394.29 190.65,-390.1 203,-387 252.66,-374.55 310.91,-370.07 352.68,-368.56"/>
<polygon fill="#666666" stroke="#666666" points="353.05,-372.05 362.93,-368.23 352.83,-365.05 353.05,-372.05"/>
</g>
<!-- cleanTxns&#45;&gt;cleanRegions -->
<g id="edge7" class="edge">
<title>cleanTxns&#45;&gt;cleanRegions</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M526.22,-469.1C642.46,-475.87 826.34,-480.14 983,-455 1032.39,-447.07 1086.09,-429.72 1126.76,-414.65"/>
<polygon fill="green" stroke="green" points="1128.15,-417.87 1136.28,-411.08 1125.69,-411.32 1128.15,-417.87"/>
</g>
<!-- locks&#45;&gt;resolve -->
<g id="edge5" class="edge">
<title>locks&#45;&gt;resolve</title>
<path fill="none" stroke="#666666" d="M257.19,-407.21C282.36,-400.69 321.19,-390.63 353.21,-382.33"/>
<polygon fill="#666666" stroke="#666666" points="354.1,-385.71 362.9,-379.82 352.35,-378.94 354.1,-385.71"/>
</g>
<!-- LockResolver__resolveLock -->
<g id="node6" class="node">
<title>LockResolver__resolveLock</title>
<path fill="none" stroke="#1c2123" d="M723,-251C723,-251 574,-251 574,-251 568,-251 562,-245 562,-239 562,-239 562,-227 562,-227 562,-221 568,-215 574,-215 574,-215 723,-215 723,-215 729,-215 735,-221 735,-227 735,-227 735,-239 735,-239 735,-245 729,-251 723,-251"/>
<text text-anchor="middle" x="648.5" y="-229.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">LockResolver__resolveLock</text>
</g>
<!-- resolve&#45;&gt;LockResolver__resolveLock -->
<g id="edge6" class="edge">
<title>resolve&#45;&gt;LockResolver__resolveLock</title>
<path fill="none" stroke="#666666" d="M450.97,-344.95C494.42,-320.2 563.06,-281.1 606.65,-256.27"/>
<polygon fill="#666666" stroke="#666666" points="608.6,-259.19 615.55,-251.2 605.13,-253.11 608.6,-259.19"/>
</g>
<!-- LockResolver__resolveLock&#45;&gt;cleanRegions -->
<g id="edge12" class="edge">
<title>LockResolver__resolveLock&#45;&gt;cleanRegions</title>
<path fill="none" stroke="#666666" d="M687.33,-251.01C710.93,-261.64 742.21,-274.6 771,-283 862.89,-309.81 890.1,-297.93 983,-321 1028.54,-332.31 1078.62,-348.2 1118.4,-361.66"/>
<polygon fill="#666666" stroke="#666666" points="1117.43,-365.03 1128.02,-364.94 1119.68,-358.4 1117.43,-365.03"/>
</g>
<!-- KvStore__SendReq -->
<g id="node7" class="node">
<title>KvStore__SendReq</title>
<path fill="none" stroke="#1c2123" d="M1243.5,-236C1243.5,-236 1143.5,-236 1143.5,-236 1137.5,-236 1131.5,-230 1131.5,-224 1131.5,-224 1131.5,-212 1131.5,-212 1131.5,-206 1137.5,-200 1143.5,-200 1143.5,-200 1243.5,-200 1243.5,-200 1249.5,-200 1255.5,-206 1255.5,-212 1255.5,-212 1255.5,-224 1255.5,-224 1255.5,-230 1249.5,-236 1243.5,-236"/>
<text text-anchor="middle" x="1193.5" y="-214.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">KvStore__SendReq</text>
</g>
<!-- LockResolver__resolveLock&#45;&gt;KvStore__SendReq -->
<g id="edge13" class="edge">
<title>LockResolver__resolveLock&#45;&gt;KvStore__SendReq</title>
<path fill="none" stroke="#666666" d="M735.13,-230.11C747.17,-229.72 759.4,-229.34 771,-229 894.1,-225.37 1037.43,-221.76 1121.25,-219.71"/>
<polygon fill="#666666" stroke="#666666" points="1121.51,-223.21 1131.42,-219.46 1121.34,-216.21 1121.51,-223.21"/>
</g>
<!-- ReadTimeoutShort -->
<g id="node8" class="node">
<title>ReadTimeoutShort</title>
<path fill="none" stroke="#1c2123" d="M1420,-213C1420,-213 1324,-213 1324,-213 1318,-213 1312,-207 1312,-201 1312,-201 1312,-189 1312,-189 1312,-183 1318,-177 1324,-177 1324,-177 1420,-177 1420,-177 1426,-177 1432,-183 1432,-189 1432,-189 1432,-201 1432,-201 1432,-207 1426,-213 1420,-213"/>
<text text-anchor="middle" x="1372" y="-191.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ReadTimeoutShort</text>
</g>
<!-- LockResolver__resolveLock&#45;&gt;ReadTimeoutShort -->
<g id="edge14" class="edge">
<title>LockResolver__resolveLock&#45;&gt;ReadTimeoutShort</title>
<path fill="none" stroke="#666666" d="M735.11,-223.61C747.15,-222.35 759.39,-221.12 771,-220 921.96,-205.49 959.48,-197.45 1111,-191 1184.27,-187.88 1202.68,-189.46 1276,-191 1284.36,-191.18 1293.14,-191.44 1301.83,-191.75"/>
<polygon fill="#666666" stroke="#666666" points="1301.85,-195.25 1311.97,-192.13 1302.11,-188.26 1301.85,-195.25"/>
</g>
<!-- RegionCache__LocateKey -->
<g id="node9" class="node">
<title>RegionCache__LocateKey</title>
<path fill="none" stroke="#1c2123" d="M946,-274C946,-274 808,-274 808,-274 802,-274 796,-268 796,-262 796,-262 796,-250 796,-250 796,-244 802,-238 808,-238 808,-238 946,-238 946,-238 952,-238 958,-244 958,-250 958,-250 958,-262 958,-262 958,-268 952,-274 946,-274"/>
<text text-anchor="middle" x="877" y="-252.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RegionCache__LocateKey</text>
</g>
<!-- LockResolver__resolveLock&#45;&gt;RegionCache__LocateKey -->
<g id="edge15" class="edge">
<title>LockResolver__resolveLock&#45;&gt;RegionCache__LocateKey</title>
<path fill="none" stroke="#666666" d="M735.13,-241.7C751.63,-243.37 768.95,-245.13 785.59,-246.82"/>
<polygon fill="#666666" stroke="#666666" points="785.55,-250.33 795.85,-247.86 786.26,-243.37 785.55,-250.33"/>
</g>
<!-- ResolveLockRequest -->
<g id="node11" class="node">
<title>ResolveLockRequest</title>
<path fill="none" stroke="#1c2123" d="M930.5,-144C930.5,-144 823.5,-144 823.5,-144 817.5,-144 811.5,-138 811.5,-132 811.5,-132 811.5,-120 811.5,-120 811.5,-114 817.5,-108 823.5,-108 823.5,-108 930.5,-108 930.5,-108 936.5,-108 942.5,-114 942.5,-120 942.5,-120 942.5,-132 942.5,-132 942.5,-138 936.5,-144 930.5,-144"/>
<text text-anchor="middle" x="877" y="-122.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ResolveLockRequest</text>
</g>
<!-- LockResolver__resolveLock&#45;&gt;ResolveLockRequest -->
<g id="edge16" class="edge">
<title>LockResolver__resolveLock&#45;&gt;ResolveLockRequest</title>
<path fill="none" stroke="#666666" d="M674.5,-214.9C698.35,-198.29 735.76,-173.92 771,-158 780.77,-153.58 791.32,-149.56 801.84,-145.98"/>
<polygon fill="#666666" stroke="#666666" points="803.05,-149.26 811.46,-142.81 800.86,-142.61 803.05,-149.26"/>
</g>
<!-- CmdResolveLock -->
<g id="node12" class="node">
<title>CmdResolveLock</title>
<path fill="none" stroke="#1c2123" d="M922.5,-90C922.5,-90 831.5,-90 831.5,-90 825.5,-90 819.5,-84 819.5,-78 819.5,-78 819.5,-66 819.5,-66 819.5,-60 825.5,-54 831.5,-54 831.5,-54 922.5,-54 922.5,-54 928.5,-54 934.5,-60 934.5,-66 934.5,-66 934.5,-78 934.5,-78 934.5,-84 928.5,-90 922.5,-90"/>
<text text-anchor="middle" x="877" y="-68.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">CmdResolveLock</text>
</g>
<!-- LockResolver__resolveLock&#45;&gt;CmdResolveLock -->
<g id="edge17" class="edge">
<title>LockResolver__resolveLock&#45;&gt;CmdResolveLock</title>
<path fill="none" stroke="#666666" d="M660.88,-214.72C679.96,-185.63 721.26,-129.02 771,-99 782.74,-91.92 796.29,-86.68 809.68,-82.81"/>
<polygon fill="#666666" stroke="#666666" points="810.61,-86.18 819.37,-80.23 808.81,-79.42 810.61,-86.18"/>
</g>
<!-- GetRegionError -->
<g id="node13" class="node">
<title>GetRegionError</title>
<path fill="none" stroke="#1c2123" d="M917,-36C917,-36 837,-36 837,-36 831,-36 825,-30 825,-24 825,-24 825,-12 825,-12 825,-6 831,0 837,0 837,0 917,0 917,0 923,0 929,-6 929,-12 929,-12 929,-24 929,-24 929,-30 923,-36 917,-36"/>
<text text-anchor="middle" x="877" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">GetRegionError</text>
</g>
<!-- LockResolver__resolveLock&#45;&gt;GetRegionError -->
<g id="edge18" class="edge">
<title>LockResolver__resolveLock&#45;&gt;GetRegionError</title>
<path fill="none" stroke="#666666" d="M655.99,-214.78C670.42,-176.96 708.89,-89.75 771,-45 783.84,-35.75 799.57,-29.66 814.91,-25.66"/>
<polygon fill="#666666" stroke="#666666" points="815.97,-29.01 824.9,-23.32 814.37,-22.19 815.97,-29.01"/>
</g>
<!-- Backoffer__Backoff -->
<g id="node14" class="node">
<title>Backoffer__Backoff</title>
<path fill="none" stroke="#1c2123" d="M820.5,-384.5C820.5,-384.5 933.5,-384.5 933.5,-384.5 939.5,-384.5 945.5,-390.5 945.5,-396.5 945.5,-396.5 945.5,-433.5 945.5,-433.5 945.5,-439.5 939.5,-445.5 933.5,-445.5 933.5,-445.5 820.5,-445.5 820.5,-445.5 814.5,-445.5 808.5,-439.5 808.5,-433.5 808.5,-433.5 808.5,-396.5 808.5,-396.5 808.5,-390.5 814.5,-384.5 820.5,-384.5"/>
<text text-anchor="start" x="816.5" y="-430.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Backoffer__Backoff</text>
<polyline fill="none" stroke="#1c2123" points="808.5,-422.5 945.5,-422.5 "/>
<text text-anchor="start" x="816.5" y="-407.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">对于regionError重试</text>
<text text-anchor="start" x="816.5" y="-392.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 重新LocKey</text>
</g>
<!-- LockResolver__resolveLock&#45;&gt;Backoffer__Backoff -->
<g id="edge19" class="edge">
<title>LockResolver__resolveLock&#45;&gt;Backoffer__Backoff</title>
<path fill="none" stroke="#666666" d="M660.72,-251.25C679.88,-281.04 721.66,-340.25 771,-375 779.67,-381.11 789.39,-386.42 799.33,-391.01"/>
<polygon fill="#666666" stroke="#666666" points="797.93,-394.21 808.49,-395.02 800.73,-387.8 797.93,-394.21"/>
</g>
<!-- cleanRegions__loc__Region__clear -->
<g id="node15" class="node">
<title>cleanRegions__loc__Region__clear</title>
<path fill="none" stroke="#1c2123" d="M971,-366C971,-366 783,-366 783,-366 777,-366 771,-360 771,-354 771,-354 771,-342 771,-342 771,-336 777,-330 783,-330 783,-330 971,-330 971,-330 977,-330 983,-336 983,-342 983,-342 983,-354 983,-354 983,-360 977,-366 971,-366"/>
<text text-anchor="middle" x="877" y="-344.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">cleanRegions__loc__Region__clear</text>
</g>
<!-- LockResolver__resolveLock&#45;&gt;cleanRegions__loc__Region__clear -->
<g id="edge20" class="edge">
<title>LockResolver__resolveLock&#45;&gt;cleanRegions__loc__Region__clear</title>
<path fill="none" stroke="#666666" d="M671.52,-251.11C694.95,-269.61 733.69,-298.09 771,-316 779.07,-319.88 787.72,-323.41 796.46,-326.59"/>
<polygon fill="#666666" stroke="#666666" points="795.37,-329.91 805.96,-329.91 797.67,-323.31 795.37,-329.91"/>
</g>
<!-- KvStore__SendReq&#45;&gt;ReadTimeoutShort -->
<g id="edge8" class="edge">
<title>KvStore__SendReq&#45;&gt;ReadTimeoutShort</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1255.74,-210.02C1270.54,-208.09 1286.47,-206.02 1301.62,-204.04"/>
<polygon fill="green" stroke="green" points="1302.49,-207.46 1311.95,-202.69 1301.59,-200.52 1302.49,-207.46"/>
</g>
<!-- Region -->
<g id="node10" class="node">
<title>Region</title>
<path fill="none" stroke="#1c2123" d="M1063,-274C1063,-274 1031,-274 1031,-274 1025,-274 1019,-268 1019,-262 1019,-262 1019,-250 1019,-250 1019,-244 1025,-238 1031,-238 1031,-238 1063,-238 1063,-238 1069,-238 1075,-244 1075,-250 1075,-250 1075,-262 1075,-262 1075,-268 1069,-274 1063,-274"/>
<text text-anchor="middle" x="1047" y="-252.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Region</text>
</g>
<!-- RegionCache__LocateKey&#45;&gt;Region -->
<g id="edge9" class="edge">
<title>RegionCache__LocateKey&#45;&gt;Region</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M958.06,-256C975.61,-256 993.38,-256 1008.32,-256"/>
<polygon fill="green" stroke="green" points="1008.65,-259.5 1018.65,-256 1008.65,-252.5 1008.65,-259.5"/>
</g>
<!-- Region&#45;&gt;cleanRegions -->
<g id="edge11" class="edge">
<title>Region&#45;&gt;cleanRegions</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1067.79,-274.08C1091.39,-295.63 1131.18,-331.99 1159.47,-357.83"/>
<polygon fill="green" stroke="green" points="1157.38,-360.66 1167.12,-364.82 1162.1,-355.49 1157.38,-360.66"/>
</g>
<!-- Region&#45;&gt;KvStore__SendReq -->
<g id="edge10" class="edge">
<title>Region&#45;&gt;KvStore__SendReq</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1075.18,-248.85C1088.44,-245.37 1105.07,-240.99 1121.6,-236.64"/>
<polygon fill="green" stroke="green" points="1122.52,-240.02 1131.3,-234.09 1120.74,-233.25 1122.52,-240.02"/>
</g>
</g>
</svg>
