<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.0 (20210316.0004)
 -->
<!-- Title: peer_storage_do_snapshot Pages: 1 -->
<svg width="1258pt" height="683pt"
 viewBox="0.00 0.00 1258.00 682.66" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 678.66)">
<title>peer_storage_do_snapshot</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-678.66 1254,-678.66 1254,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_SnapManager</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M124,-528.96C124,-528.96 914.5,-528.96 914.5,-528.96 920.5,-528.96 926.5,-534.96 926.5,-540.96 926.5,-540.96 926.5,-598.96 926.5,-598.96 926.5,-604.96 920.5,-610.96 914.5,-610.96 914.5,-610.96 124,-610.96 124,-610.96 118,-610.96 112,-604.96 112,-598.96 112,-598.96 112,-540.96 112,-540.96 112,-534.96 118,-528.96 124,-528.96"/>
<text text-anchor="middle" x="519.25" y="-590.96" font-family="Times,serif" font-size="20.00">SnapManager</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_metadata</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M847,-103.96C847,-103.96 1115.5,-103.96 1115.5,-103.96 1121.5,-103.96 1127.5,-109.96 1127.5,-115.96 1127.5,-115.96 1127.5,-281.96 1127.5,-281.96 1127.5,-287.96 1121.5,-293.96 1115.5,-293.96 1115.5,-293.96 847,-293.96 847,-293.96 841,-293.96 835,-287.96 835,-281.96 835,-281.96 835,-115.96 835,-115.96 835,-109.96 841,-103.96 847,-103.96"/>
<text text-anchor="middle" x="981.25" y="-273.96" font-family="Times,serif" font-size="20.00">metadata</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_snap_data</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M591.5,-312.96C591.5,-312.96 1146,-312.96 1146,-312.96 1152,-312.96 1158,-318.96 1158,-324.96 1158,-324.96 1158,-508.96 1158,-508.96 1158,-514.96 1152,-520.96 1146,-520.96 1146,-520.96 591.5,-520.96 591.5,-520.96 585.5,-520.96 579.5,-514.96 579.5,-508.96 579.5,-508.96 579.5,-324.96 579.5,-324.96 579.5,-318.96 585.5,-312.96 591.5,-312.96"/>
<text text-anchor="middle" x="868.75" y="-500.96" font-family="Times,serif" font-size="20.00">snap kv数据</text>
</g>
<!-- register -->
<g id="node1" class="node">
<title>register</title>
<path fill="none" stroke="#1c2123" d="M906.5,-572.96C906.5,-572.96 873.5,-572.96 873.5,-572.96 867.5,-572.96 861.5,-566.96 861.5,-560.96 861.5,-560.96 861.5,-548.96 861.5,-548.96 861.5,-542.96 867.5,-536.96 873.5,-536.96 873.5,-536.96 906.5,-536.96 906.5,-536.96 912.5,-536.96 918.5,-542.96 918.5,-548.96 918.5,-548.96 918.5,-560.96 918.5,-560.96 918.5,-566.96 912.5,-572.96 906.5,-572.96"/>
<text text-anchor="middle" x="890" y="-551.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">register</text>
</g>
<!-- get_snapshot_for_building -->
<g id="node2" class="node">
<title>get_snapshot_for_building</title>
<path fill="none" stroke="#1c2123" d="M269,-572.96C269,-572.96 132,-572.96 132,-572.96 126,-572.96 120,-566.96 120,-560.96 120,-560.96 120,-548.96 120,-548.96 120,-542.96 126,-536.96 132,-536.96 132,-536.96 269,-536.96 269,-536.96 275,-536.96 281,-542.96 281,-548.96 281,-548.96 281,-560.96 281,-560.96 281,-566.96 275,-572.96 269,-572.96"/>
<text text-anchor="middle" x="200.5" y="-551.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">get_snapshot_for_building</text>
</g>
<!-- build -->
<g id="node13" class="node">
<title>build</title>
<path fill="none" stroke="#1c2123" d="M361.5,-384.96C361.5,-384.96 486.5,-384.96 486.5,-384.96 492.5,-384.96 498.5,-390.96 498.5,-396.96 498.5,-396.96 498.5,-456.96 498.5,-456.96 498.5,-462.96 492.5,-468.96 486.5,-468.96 486.5,-468.96 361.5,-468.96 361.5,-468.96 355.5,-468.96 349.5,-462.96 349.5,-456.96 349.5,-456.96 349.5,-396.96 349.5,-396.96 349.5,-390.96 355.5,-384.96 361.5,-384.96"/>
<text text-anchor="middle" x="424" y="-453.76" font-family="Times,serif" font-size="14.00" fill="#2f3638">build</text>
<polyline fill="none" stroke="#1c2123" points="349.5,-445.96 498.5,-445.96 "/>
<text text-anchor="start" x="357.5" y="-430.76" font-family="Times,serif" font-size="14.00" fill="#2f3638">store/snap.rs</text>
<polyline fill="none" stroke="#1c2123" points="349.5,-422.96 498.5,-422.96 "/>
<text text-anchor="start" x="357.5" y="-407.76" font-family="Times,serif" font-size="14.00" fill="#2f3638">生成snapshot数据部分</text>
<text text-anchor="start" x="357.5" y="-392.76" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 应该是写到cf文件中</text>
</g>
<!-- get_snapshot_for_building&#45;&gt;build -->
<g id="edge13" class="edge">
<title>get_snapshot_for_building&#45;&gt;build</title>
<path fill="none" stroke="#666666" d="M232.77,-536.89C260.92,-520.62 303.55,-495.98 341.33,-474.15"/>
<polygon fill="#666666" stroke="#666666" points="343.4,-477 350.31,-468.96 339.9,-470.94 343.4,-477"/>
</g>
<!-- set_index -->
<g id="node3" class="node">
<title>set_index</title>
<path fill="none" stroke="#1c2123" d="M912,-201.96C912,-201.96 868,-201.96 868,-201.96 862,-201.96 856,-195.96 856,-189.96 856,-189.96 856,-177.96 856,-177.96 856,-171.96 862,-165.96 868,-165.96 868,-165.96 912,-165.96 912,-165.96 918,-165.96 924,-171.96 924,-177.96 924,-177.96 924,-189.96 924,-189.96 924,-195.96 918,-201.96 912,-201.96"/>
<text text-anchor="middle" x="890" y="-180.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">set_index</text>
</g>
<!-- metadata -->
<g id="node6" class="node">
<title>metadata</title>
<path fill="none" stroke="#1c2123" d="M1107.5,-228.96C1107.5,-228.96 1065.5,-228.96 1065.5,-228.96 1059.5,-228.96 1053.5,-222.96 1053.5,-216.96 1053.5,-216.96 1053.5,-204.96 1053.5,-204.96 1053.5,-198.96 1059.5,-192.96 1065.5,-192.96 1065.5,-192.96 1107.5,-192.96 1107.5,-192.96 1113.5,-192.96 1119.5,-198.96 1119.5,-204.96 1119.5,-204.96 1119.5,-216.96 1119.5,-216.96 1119.5,-222.96 1113.5,-228.96 1107.5,-228.96"/>
<text text-anchor="middle" x="1086.5" y="-207.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">metadata</text>
</g>
<!-- set_index&#45;&gt;metadata -->
<g id="edge1" class="edge">
<title>set_index&#45;&gt;metadata</title>
<path fill="none" stroke="#666666" d="M924.44,-188.6C957.35,-193.17 1007.74,-200.16 1043.38,-205.11"/>
<polygon fill="#666666" stroke="#666666" points="1043.08,-208.6 1053.47,-206.51 1044.04,-201.67 1043.08,-208.6"/>
</g>
<!-- set_term -->
<g id="node4" class="node">
<title>set_term</title>
<path fill="none" stroke="#1c2123" d="M910,-255.96C910,-255.96 870,-255.96 870,-255.96 864,-255.96 858,-249.96 858,-243.96 858,-243.96 858,-231.96 858,-231.96 858,-225.96 864,-219.96 870,-219.96 870,-219.96 910,-219.96 910,-219.96 916,-219.96 922,-225.96 922,-231.96 922,-231.96 922,-243.96 922,-243.96 922,-249.96 916,-255.96 910,-255.96"/>
<text text-anchor="middle" x="890" y="-234.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">set_term</text>
</g>
<!-- set_term&#45;&gt;metadata -->
<g id="edge2" class="edge">
<title>set_term&#45;&gt;metadata</title>
<path fill="none" stroke="#666666" d="M922.25,-233.62C954.99,-229.07 1006.63,-221.91 1043.05,-216.85"/>
<polygon fill="#666666" stroke="#666666" points="1043.93,-220.26 1053.36,-215.42 1042.97,-213.33 1043.93,-220.26"/>
</g>
<!-- set_conf_state -->
<g id="node5" class="node">
<title>set_conf_state</title>
<path fill="none" stroke="#1c2123" d="M925,-147.96C925,-147.96 855,-147.96 855,-147.96 849,-147.96 843,-141.96 843,-135.96 843,-135.96 843,-123.96 843,-123.96 843,-117.96 849,-111.96 855,-111.96 855,-111.96 925,-111.96 925,-111.96 931,-111.96 937,-117.96 937,-123.96 937,-123.96 937,-135.96 937,-135.96 937,-141.96 931,-147.96 925,-147.96"/>
<text text-anchor="middle" x="890" y="-126.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">set_conf_state</text>
</g>
<!-- set_conf_state&#45;&gt;metadata -->
<g id="edge3" class="edge">
<title>set_conf_state&#45;&gt;metadata</title>
<path fill="none" stroke="#666666" d="M937.13,-140.65C953.18,-144.97 971.13,-150.47 987,-156.96 1007.75,-165.44 1029.73,-177.19 1047.65,-187.57"/>
<polygon fill="#666666" stroke="#666666" points="1046.23,-190.79 1056.62,-192.84 1049.78,-184.76 1046.23,-190.79"/>
</g>
<!-- snapshot -->
<g id="node19" class="node">
<title>snapshot</title>
<path fill="none" stroke="#1c2123" d="M1238,-300.96C1238,-300.96 1198,-300.96 1198,-300.96 1192,-300.96 1186,-294.96 1186,-288.96 1186,-288.96 1186,-276.96 1186,-276.96 1186,-270.96 1192,-264.96 1198,-264.96 1198,-264.96 1238,-264.96 1238,-264.96 1244,-264.96 1250,-270.96 1250,-276.96 1250,-276.96 1250,-288.96 1250,-288.96 1250,-294.96 1244,-300.96 1238,-300.96"/>
<text text-anchor="middle" x="1218" y="-279.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">snapshot</text>
</g>
<!-- metadata&#45;&gt;snapshot -->
<g id="edge29" class="edge">
<title>metadata&#45;&gt;snapshot</title>
<path fill="none" stroke="#666666" d="M1119.51,-228.75C1136.89,-238.42 1158.54,-250.45 1177.02,-260.73"/>
<polygon fill="#666666" stroke="#666666" points="1175.36,-263.81 1185.8,-265.61 1178.76,-257.69 1175.36,-263.81"/>
</g>
<!-- do_snapshot -->
<g id="node7" class="node">
<title>do_snapshot</title>
<path fill="none" stroke="#1c2123" d="M72,-244.96C72,-244.96 12,-244.96 12,-244.96 6,-244.96 0,-238.96 0,-232.96 0,-232.96 0,-220.96 0,-220.96 0,-214.96 6,-208.96 12,-208.96 12,-208.96 72,-208.96 72,-208.96 78,-208.96 84,-214.96 84,-220.96 84,-220.96 84,-232.96 84,-232.96 84,-238.96 78,-244.96 72,-244.96"/>
<text text-anchor="middle" x="42" y="-223.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">do_snapshot</text>
</g>
<!-- do_snapshot&#45;&gt;register -->
<g id="edge4" class="edge">
<title>do_snapshot&#45;&gt;register</title>
<path fill="none" stroke="#666666" d="M43.65,-245.18C46.45,-311.41 59.73,-537.79 112,-581.96 333.33,-768.99 729.89,-623.34 852.12,-571.45"/>
<polygon fill="#666666" stroke="#666666" points="853.63,-574.61 861.43,-567.45 850.86,-568.18 853.63,-574.61"/>
</g>
<!-- do_snapshot&#45;&gt;get_snapshot_for_building -->
<g id="edge5" class="edge">
<title>do_snapshot&#45;&gt;get_snapshot_for_building</title>
<path fill="none" stroke="#666666" d="M50.52,-245.01C62.86,-274.37 88.36,-334.21 112,-383.96 136.42,-435.36 167.17,-494.22 184.95,-527.75"/>
<polygon fill="#666666" stroke="#666666" points="182.04,-529.72 189.82,-536.91 188.22,-526.44 182.04,-529.72"/>
</g>
<!-- SnapKey_new -->
<g id="node8" class="node">
<title>SnapKey_new</title>
<path fill="none" stroke="#1c2123" d="M579,-195.96C579,-195.96 745,-195.96 745,-195.96 751,-195.96 757,-201.96 757,-207.96 757,-207.96 757,-251.96 757,-251.96 757,-257.96 751,-263.96 745,-263.96 745,-263.96 579,-263.96 579,-263.96 573,-263.96 567,-257.96 567,-251.96 567,-251.96 567,-207.96 567,-207.96 567,-201.96 573,-195.96 579,-195.96"/>
<text text-anchor="start" x="575" y="-248.76" font-family="Times,serif" font-size="14.00" fill="#2f3638">SnapKey::new(</text>
<text text-anchor="start" x="575" y="-233.76" font-family="Times,serif" font-size="14.00" fill="#2f3638"> region_id,</text>
<text text-anchor="start" x="575" y="-218.76" font-family="Times,serif" font-size="14.00" fill="#2f3638"> last_applied_index_term</text>
<text text-anchor="start" x="575" y="-203.76" font-family="Times,serif" font-size="14.00" fill="#2f3638"> apply_state.get_applied_index)</text>
</g>
<!-- do_snapshot&#45;&gt;SnapKey_new -->
<g id="edge6" class="edge">
<title>do_snapshot&#45;&gt;SnapKey_new</title>
<path fill="none" stroke="#666666" d="M82.04,-245.02C91.64,-248.68 102.03,-252 112,-253.96 294.74,-289.82 345.75,-275.99 531,-256.96 539.5,-256.08 548.26,-254.9 557.03,-253.51"/>
<polygon fill="#666666" stroke="#666666" points="557.63,-256.96 566.92,-251.86 556.48,-250.05 557.63,-256.96"/>
</g>
<!-- kv_snap_get_msg_cf_CF_RAFT -->
<g id="node9" class="node">
<title>kv_snap_get_msg_cf_CF_RAFT</title>
<path fill="none" stroke="#1c2123" d="M329,-156.96C329,-156.96 519,-156.96 519,-156.96 525,-156.96 531,-162.96 531,-168.96 531,-168.96 531,-180.96 531,-180.96 531,-186.96 525,-192.96 519,-192.96 519,-192.96 329,-192.96 329,-192.96 323,-192.96 317,-186.96 317,-180.96 317,-180.96 317,-168.96 317,-168.96 317,-162.96 323,-156.96 329,-156.96"/>
<text text-anchor="middle" x="424" y="-171.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">kv_snap.get_msg_cf(CF_RAFT, ...)</text>
</g>
<!-- do_snapshot&#45;&gt;kv_snap_get_msg_cf_CF_RAFT -->
<g id="edge7" class="edge">
<title>do_snapshot&#45;&gt;kv_snap_get_msg_cf_CF_RAFT</title>
<path fill="none" stroke="#666666" d="M83.24,-208.94C92.52,-205.43 102.47,-202.15 112,-199.96 175.37,-185.35 247.7,-178.94 306.65,-176.26"/>
<polygon fill="#666666" stroke="#666666" points="306.9,-179.75 316.74,-175.83 306.6,-172.76 306.9,-179.75"/>
</g>
<!-- apply_state_key -->
<g id="node10" class="node">
<title>apply_state_key</title>
<path fill="none" stroke="#1c2123" d="M240.5,-244.96C240.5,-244.96 160.5,-244.96 160.5,-244.96 154.5,-244.96 148.5,-238.96 148.5,-232.96 148.5,-232.96 148.5,-220.96 148.5,-220.96 148.5,-214.96 154.5,-208.96 160.5,-208.96 160.5,-208.96 240.5,-208.96 240.5,-208.96 246.5,-208.96 252.5,-214.96 252.5,-220.96 252.5,-220.96 252.5,-232.96 252.5,-232.96 252.5,-238.96 246.5,-244.96 240.5,-244.96"/>
<text text-anchor="middle" x="200.5" y="-223.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">apply_state_key</text>
</g>
<!-- do_snapshot&#45;&gt;apply_state_key -->
<g id="edge8" class="edge">
<title>do_snapshot&#45;&gt;apply_state_key</title>
<path fill="none" stroke="#666666" d="M84.12,-226.96C100.62,-226.96 120,-226.96 138.11,-226.96"/>
<polygon fill="#666666" stroke="#666666" points="138.3,-230.46 148.3,-226.96 138.3,-223.46 138.3,-230.46"/>
</g>
<!-- region_state_key -->
<g id="node11" class="node">
<title>region_state_key</title>
<path fill="none" stroke="#1c2123" d="M243,-99.96C243,-99.96 158,-99.96 158,-99.96 152,-99.96 146,-93.96 146,-87.96 146,-87.96 146,-75.96 146,-75.96 146,-69.96 152,-63.96 158,-63.96 158,-63.96 243,-63.96 243,-63.96 249,-63.96 255,-69.96 255,-75.96 255,-75.96 255,-87.96 255,-87.96 255,-93.96 249,-99.96 243,-99.96"/>
<text text-anchor="middle" x="200.5" y="-78.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">region_state_key</text>
</g>
<!-- do_snapshot&#45;&gt;region_state_key -->
<g id="edge9" class="edge">
<title>do_snapshot&#45;&gt;region_state_key</title>
<path fill="none" stroke="#666666" d="M49.67,-208.68C59.59,-183.89 80.53,-139.75 112,-113.96 119.17,-108.08 127.51,-103.24 136.14,-99.25"/>
<polygon fill="#666666" stroke="#666666" points="137.73,-102.38 145.57,-95.26 135,-95.93 137.73,-102.38"/>
</g>
<!-- conf_state_from_region -->
<g id="node12" class="node">
<title>conf_state_from_region</title>
<path fill="none" stroke="#1c2123" d="M598.5,-51.46C598.5,-51.46 725.5,-51.46 725.5,-51.46 731.5,-51.46 737.5,-57.46 737.5,-63.46 737.5,-63.46 737.5,-100.46 737.5,-100.46 737.5,-106.46 731.5,-112.46 725.5,-112.46 725.5,-112.46 598.5,-112.46 598.5,-112.46 592.5,-112.46 586.5,-106.46 586.5,-100.46 586.5,-100.46 586.5,-63.46 586.5,-63.46 586.5,-57.46 592.5,-51.46 598.5,-51.46"/>
<text text-anchor="middle" x="662" y="-97.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">conf_state_from_region</text>
<polyline fill="none" stroke="#1c2123" points="586.5,-89.46 737.5,-89.46 "/>
<text text-anchor="start" x="594.5" y="-74.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">从region的peers信息中</text>
<text text-anchor="start" x="594.5" y="-59.26" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 创建ConfState</text>
</g>
<!-- do_snapshot&#45;&gt;conf_state_from_region -->
<g id="edge10" class="edge">
<title>do_snapshot&#45;&gt;conf_state_from_region</title>
<path fill="none" stroke="#666666" d="M43.99,-208.86C47.07,-172.34 59.76,-90.28 112,-54.96 252.12,39.81 461.43,-9.61 576.92,-48.97"/>
<polygon fill="#666666" stroke="#666666" points="575.84,-52.3 586.43,-52.27 578.13,-45.69 575.84,-52.3"/>
</g>
<!-- do_snapshot&#45;&gt;build -->
<g id="edge11" class="edge">
<title>do_snapshot&#45;&gt;build</title>
<path fill="none" stroke="#666666" d="M59.55,-244.98C72.77,-258.61 92.29,-277.12 112,-289.96 183.94,-336.83 274.59,-374.68 339.43,-398.62"/>
<polygon fill="#666666" stroke="#666666" points="338.61,-402.05 349.21,-402.2 341.02,-395.48 338.61,-402.05"/>
</g>
<!-- get_applied_index -->
<g id="node14" class="node">
<title>get_applied_index</title>
<path fill="none" stroke="#1c2123" d="M708,-176.96C708,-176.96 616,-176.96 616,-176.96 610,-176.96 604,-170.96 604,-164.96 604,-164.96 604,-152.96 604,-152.96 604,-146.96 610,-140.96 616,-140.96 616,-140.96 708,-140.96 708,-140.96 714,-140.96 720,-146.96 720,-152.96 720,-152.96 720,-164.96 720,-164.96 720,-170.96 714,-176.96 708,-176.96"/>
<text text-anchor="middle" x="662" y="-155.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">get_applied_index</text>
</g>
<!-- do_snapshot&#45;&gt;get_applied_index -->
<g id="edge12" class="edge">
<title>do_snapshot&#45;&gt;get_applied_index</title>
<path fill="none" stroke="#666666" d="M60.54,-208.76C73.53,-196.49 92.32,-181.11 112,-172.96 284.35,-101.57 344.61,-140.09 531,-147.96 551.42,-148.82 573.6,-150.44 593.77,-152.18"/>
<polygon fill="#666666" stroke="#666666" points="593.52,-155.67 603.79,-153.07 594.14,-148.7 593.52,-155.67"/>
</g>
<!-- SnapKey_new&#45;&gt;register -->
<g id="edge26" class="edge">
<title>SnapKey_new&#45;&gt;register</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M716.85,-264.31C732.08,-276.6 747.17,-291.74 757,-308.96 805.23,-393.49 729.08,-451.57 793,-524.96 807.45,-541.55 830.94,-549.08 851.07,-552.44"/>
<polygon fill="green" stroke="green" points="850.84,-555.94 861.22,-553.85 851.8,-549.01 850.84,-555.94"/>
</g>
<!-- SnapKey_new&#45;&gt;set_index -->
<g id="edge27" class="edge">
<title>SnapKey_new&#45;&gt;set_index</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M757.21,-210.78C788.08,-204.5 820.87,-197.82 846.03,-192.7"/>
<polygon fill="green" stroke="green" points="846.86,-196.11 855.96,-190.68 845.47,-189.25 846.86,-196.11"/>
</g>
<!-- SnapKey_new&#45;&gt;set_term -->
<g id="edge28" class="edge">
<title>SnapKey_new&#45;&gt;set_term</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M757.21,-233.29C788.68,-234.41 822.16,-235.59 847.5,-236.49"/>
<polygon fill="green" stroke="green" points="847.71,-240 857.83,-236.85 847.96,-233 847.71,-240"/>
</g>
<!-- apply_state_key&#45;&gt;kv_snap_get_msg_cf_CF_RAFT -->
<g id="edge15" class="edge">
<title>apply_state_key&#45;&gt;kv_snap_get_msg_cf_CF_RAFT</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M252.59,-214.96C277.4,-209.14 307.88,-201.98 336.18,-195.34"/>
<polygon fill="green" stroke="green" points="337.15,-198.71 346.09,-193.01 335.55,-191.89 337.15,-198.71"/>
</g>
<!-- apply_state -->
<g id="node16" class="node">
<title>apply_state</title>
<path fill="none" stroke="#1c2123" d="M451,-247.96C451,-247.96 397,-247.96 397,-247.96 391,-247.96 385,-241.96 385,-235.96 385,-235.96 385,-223.96 385,-223.96 385,-217.96 391,-211.96 397,-211.96 397,-211.96 451,-211.96 451,-211.96 457,-211.96 463,-217.96 463,-223.96 463,-223.96 463,-235.96 463,-235.96 463,-241.96 457,-247.96 451,-247.96"/>
<text text-anchor="middle" x="424" y="-226.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">apply_state</text>
</g>
<!-- apply_state_key&#45;&gt;apply_state -->
<g id="edge16" class="edge">
<title>apply_state_key&#45;&gt;apply_state</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M252.59,-227.65C289.34,-228.15 338.57,-228.81 374.67,-229.3"/>
<polygon fill="green" stroke="green" points="374.91,-232.81 384.95,-229.44 375,-225.81 374.91,-232.81"/>
</g>
<!-- region_state_key&#45;&gt;kv_snap_get_msg_cf_CF_RAFT -->
<g id="edge17" class="edge">
<title>region_state_key&#45;&gt;kv_snap_get_msg_cf_CF_RAFT</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M244.47,-100C280.42,-115.09 331.86,-136.69 370.3,-152.83"/>
<polygon fill="green" stroke="green" points="369.2,-156.16 379.77,-156.81 371.91,-149.71 369.2,-156.16"/>
</g>
<!-- region_state -->
<g id="node17" class="node">
<title>region_state</title>
<path fill="none" stroke="#1c2123" d="M453.5,-99.96C453.5,-99.96 394.5,-99.96 394.5,-99.96 388.5,-99.96 382.5,-93.96 382.5,-87.96 382.5,-87.96 382.5,-75.96 382.5,-75.96 382.5,-69.96 388.5,-63.96 394.5,-63.96 394.5,-63.96 453.5,-63.96 453.5,-63.96 459.5,-63.96 465.5,-69.96 465.5,-75.96 465.5,-75.96 465.5,-87.96 465.5,-87.96 465.5,-93.96 459.5,-99.96 453.5,-99.96"/>
<text text-anchor="middle" x="424" y="-78.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">region_state</text>
</g>
<!-- region_state_key&#45;&gt;region_state -->
<g id="edge18" class="edge">
<title>region_state_key&#45;&gt;region_state</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M255.12,-81.96C290.78,-81.96 337.32,-81.96 372.35,-81.96"/>
<polygon fill="green" stroke="green" points="372.37,-85.46 382.37,-81.96 372.37,-78.46 372.37,-85.46"/>
</g>
<!-- conf_state_from_region&#45;&gt;set_conf_state -->
<g id="edge21" class="edge">
<title>conf_state_from_region&#45;&gt;set_conf_state</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M737.63,-97.81C768.68,-104.4 804.12,-111.93 832.9,-118.04"/>
<polygon fill="green" stroke="green" points="832.27,-121.49 842.78,-120.14 833.73,-114.64 832.27,-121.49"/>
</g>
<!-- snap_data -->
<g id="node15" class="node">
<title>snap_data</title>
<path fill="none" stroke="#1c2123" d="M599.5,-321.46C599.5,-321.46 724.5,-321.46 724.5,-321.46 730.5,-321.46 736.5,-327.46 736.5,-333.46 736.5,-333.46 736.5,-470.46 736.5,-470.46 736.5,-476.46 730.5,-482.46 724.5,-482.46 724.5,-482.46 599.5,-482.46 599.5,-482.46 593.5,-482.46 587.5,-476.46 587.5,-470.46 587.5,-470.46 587.5,-333.46 587.5,-333.46 587.5,-327.46 593.5,-321.46 599.5,-321.46"/>
<text text-anchor="middle" x="662" y="-467.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">snap_data</text>
<polyline fill="none" stroke="#1c2123" points="587.5,-459.46 736.5,-459.46 "/>
<text text-anchor="start" x="595.5" y="-444.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftSnapshotData</text>
<polyline fill="none" stroke="#1c2123" points="587.5,-436.46 736.5,-436.46 "/>
<text text-anchor="start" x="595.5" y="-421.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">Region</text>
<polyline fill="none" stroke="#1c2123" points="587.5,-413.46 736.5,-413.46 "/>
<text text-anchor="start" x="595.5" y="-398.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">file_size: u64</text>
<polyline fill="none" stroke="#1c2123" points="587.5,-390.46 736.5,-390.46 "/>
<text text-anchor="start" x="595.5" y="-375.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">data: repeated KeyValue</text>
<polyline fill="none" stroke="#1c2123" points="587.5,-367.46 736.5,-367.46 "/>
<text text-anchor="start" x="595.5" y="-352.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">version: u64</text>
<polyline fill="none" stroke="#1c2123" points="587.5,-344.46 736.5,-344.46 "/>
<text text-anchor="start" x="595.5" y="-329.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">meta: SnapshotMeta</text>
</g>
<!-- build&#45;&gt;snap_data -->
<g id="edge14" class="edge">
<title>build&#45;&gt;snap_data</title>
<path fill="none" stroke="#666666" d="M498.7,-419.15C523.65,-416.51 551.7,-413.54 577.37,-410.82"/>
<polygon fill="#666666" stroke="#666666" points="577.88,-414.28 587.45,-409.75 577.14,-407.32 577.88,-414.28"/>
</g>
<!-- get_applied_index&#45;&gt;set_index -->
<g id="edge23" class="edge">
<title>get_applied_index&#45;&gt;set_index</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M720.03,-165.27C759.07,-169.58 810.03,-175.22 845.73,-179.17"/>
<polygon fill="green" stroke="green" points="845.51,-182.67 855.84,-180.29 846.28,-175.71 845.51,-182.67"/>
</g>
<!-- snap_data&#45;&gt;snapshot -->
<g id="edge30" class="edge">
<title>snap_data&#45;&gt;snapshot</title>
<path fill="none" stroke="#666666" d="M736.62,-374.71C754.88,-368.6 774.51,-362.57 793,-357.96 952.5,-318.14 997.07,-331.58 1158,-297.96 1163.83,-296.74 1169.96,-295.33 1175.96,-293.87"/>
<polygon fill="#666666" stroke="#666666" points="1177.03,-297.21 1185.88,-291.4 1175.33,-290.42 1177.03,-297.21"/>
</g>
<!-- SnapshotMeta -->
<g id="node20" class="node">
<title>SnapshotMeta</title>
<path fill="none" stroke="#1c2123" d="M805,-367.46C805,-367.46 975,-367.46 975,-367.46 981,-367.46 987,-373.46 987,-379.46 987,-379.46 987,-424.46 987,-424.46 987,-430.46 981,-436.46 975,-436.46 975,-436.46 805,-436.46 805,-436.46 799,-436.46 793,-430.46 793,-424.46 793,-424.46 793,-379.46 793,-379.46 793,-373.46 799,-367.46 805,-367.46"/>
<text text-anchor="middle" x="890" y="-421.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">SnapshotMeta</text>
<polyline fill="none" stroke="#1c2123" points="793,-413.46 987,-413.46 "/>
<text text-anchor="start" x="801" y="-398.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">cf_files repeated SnapshotCfFile</text>
<polyline fill="none" stroke="#1c2123" points="793,-390.46 987,-390.46 "/>
<text text-anchor="start" x="801" y="-375.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">for_balance: bool</text>
</g>
<!-- snap_data&#45;&gt;SnapshotMeta -->
<g id="edge32" class="edge">
<title>snap_data&#45;&gt;SnapshotMeta</title>
<path fill="none" stroke="#666666" d="M736.69,-401.96C751.38,-401.96 767.08,-401.96 782.61,-401.96"/>
<polygon fill="#666666" stroke="#666666" points="782.78,-405.46 792.78,-401.96 782.78,-398.46 782.78,-405.46"/>
</g>
<!-- apply_state&#45;&gt;SnapKey_new -->
<g id="edge19" class="edge">
<title>apply_state&#45;&gt;SnapKey_new</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M463.18,-229.96C488.6,-229.96 523.32,-229.96 556.58,-229.96"/>
<polygon fill="green" stroke="green" points="556.85,-233.46 566.84,-229.96 556.84,-226.46 556.85,-233.46"/>
</g>
<!-- apply_state&#45;&gt;get_applied_index -->
<g id="edge22" class="edge">
<title>apply_state&#45;&gt;get_applied_index</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M463.23,-221.86C483.6,-217.14 508.93,-210.61 531,-202.96 547.54,-197.22 550.58,-193.02 567,-186.96 575.77,-183.72 585.11,-180.58 594.36,-177.65"/>
<polygon fill="green" stroke="green" points="595.43,-180.98 603.94,-174.67 593.36,-174.29 595.43,-180.98"/>
</g>
<!-- region_state&#45;&gt;conf_state_from_region -->
<g id="edge20" class="edge">
<title>region_state&#45;&gt;conf_state_from_region</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M465.57,-81.96C495.81,-81.96 538.19,-81.96 575.76,-81.96"/>
<polygon fill="green" stroke="green" points="576.21,-85.46 586.21,-81.96 576.21,-78.46 576.21,-85.46"/>
</g>
<!-- last_applied_index_term -->
<g id="node18" class="node">
<title>last_applied_index_term</title>
<path fill="none" stroke="#1c2123" d="M329,-304.46C329,-304.46 519,-304.46 519,-304.46 525,-304.46 531,-310.46 531,-316.46 531,-316.46 531,-353.46 531,-353.46 531,-359.46 525,-365.46 519,-365.46 519,-365.46 329,-365.46 329,-365.46 323,-365.46 317,-359.46 317,-353.46 317,-353.46 317,-316.46 317,-316.46 317,-310.46 323,-304.46 329,-304.46"/>
<text text-anchor="middle" x="424" y="-350.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">last_applied_index_term</text>
<polyline fill="none" stroke="#1c2123" points="317,-342.46 531,-342.46 "/>
<text text-anchor="start" x="325" y="-327.26" font-family="Times,serif" font-size="14.00" fill="#2f3638">在ApplyFsm.handle_snapshot设置</text>
<text text-anchor="start" x="325" y="-312.26" font-family="Times,serif" font-size="14.00" fill="#2f3638"> ApplyDelegate.applied_index_term</text>
</g>
<!-- last_applied_index_term&#45;&gt;set_term -->
<g id="edge25" class="edge">
<title>last_applied_index_term&#45;&gt;set_term</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M531.11,-315.52C627.18,-297.9 754.17,-274.6 757,-273.96 787.77,-266.95 822.16,-257.52 848.12,-250.07"/>
<polygon fill="green" stroke="green" points="849.35,-253.35 857.98,-247.21 847.4,-246.63 849.35,-253.35"/>
</g>
<!-- last_applied_index_term&#45;&gt;SnapKey_new -->
<g id="edge24" class="edge">
<title>last_applied_index_term&#45;&gt;SnapKey_new</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M497.83,-304.39C508.96,-299.61 520.31,-294.69 531,-289.96 546.58,-283.06 563.14,-275.55 579.03,-268.26"/>
<polygon fill="green" stroke="green" points="580.68,-271.35 588.3,-263.99 577.75,-264.99 580.68,-271.35"/>
</g>
<!-- SnapshotCfFile -->
<g id="node21" class="node">
<title>SnapshotCfFile</title>
<path fill="none" stroke="#1c2123" d="M1035,-363.96C1035,-363.96 1138,-363.96 1138,-363.96 1144,-363.96 1150,-369.96 1150,-375.96 1150,-375.96 1150,-427.96 1150,-427.96 1150,-433.96 1144,-439.96 1138,-439.96 1138,-439.96 1035,-439.96 1035,-439.96 1029,-439.96 1023,-433.96 1023,-427.96 1023,-427.96 1023,-375.96 1023,-375.96 1023,-369.96 1029,-363.96 1035,-363.96"/>
<text text-anchor="middle" x="1086.5" y="-424.76" font-family="Times,serif" font-size="14.00" fill="#2f3638">SnapshotCfFile</text>
<polyline fill="none" stroke="#1c2123" points="1023,-416.96 1150,-416.96 "/>
<text text-anchor="start" x="1031" y="-401.76" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub cf: string</text>
<text text-anchor="start" x="1031" y="-386.76" font-family="Times,serif" font-size="14.00" fill="#2f3638"> pub size: u64</text>
<text text-anchor="start" x="1031" y="-371.76" font-family="Times,serif" font-size="14.00" fill="#2f3638"> pub checksum: u32</text>
</g>
<!-- SnapshotMeta&#45;&gt;SnapshotCfFile -->
<g id="edge31" class="edge">
<title>SnapshotMeta&#45;&gt;SnapshotCfFile</title>
<path fill="none" stroke="#666666" d="M987.11,-401.96C995.75,-401.96 1004.4,-401.96 1012.8,-401.96"/>
<polygon fill="#666666" stroke="#666666" points="1012.89,-405.46 1022.89,-401.96 1012.89,-398.46 1012.89,-405.46"/>
</g>
</g>
</svg>
