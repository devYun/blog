<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.47.0 (20210316.0004)
 -->
<!-- Title: raft_client Pages: 1 -->
<svg width="2228pt" height="1146pt"
 viewBox="0.00 0.00 2228.00 1146.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1142)">
<title>raft_client</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1142 2224,-1142 2224,4 -4,4"/>
<!-- ServerTransport -->
<g id="node1" class="node">
<title>ServerTransport</title>
<path fill="none" stroke="#1c2123" d="M229,-373.5C229,-373.5 381,-373.5 381,-373.5 387,-373.5 393,-379.5 393,-385.5 393,-385.5 393,-407.5 393,-407.5 393,-413.5 387,-419.5 381,-419.5 381,-419.5 229,-419.5 229,-419.5 223,-419.5 217,-413.5 217,-407.5 217,-407.5 217,-385.5 217,-385.5 217,-379.5 223,-373.5 229,-373.5"/>
<text text-anchor="middle" x="305" y="-404.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ServerTransport</text>
<polyline fill="none" stroke="#1c2123" points="217,-396.5 393,-396.5 "/>
<text text-anchor="start" x="225" y="-381.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">raft_client: RaftClient&lt;S, T&gt;</text>
</g>
<!-- RaftClient -->
<g id="node2" class="node">
<title>RaftClient</title>
<path fill="none" stroke="#1c2123" d="M441,-627C441,-627 693,-627 693,-627 699,-627 705,-633 705,-639 705,-639 705,-814 705,-814 705,-820 699,-826 693,-826 693,-826 441,-826 441,-826 435,-826 429,-820 429,-814 429,-814 429,-639 429,-639 429,-633 435,-627 441,-627"/>
<text text-anchor="middle" x="567" y="-810.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftClient</text>
<polyline fill="none" stroke="#1c2123" points="429,-803 705,-803 "/>
<text text-anchor="start" x="437" y="-787.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">管理connection</text>
<text text-anchor="start" x="437" y="-772.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 发消息时，先调用send，最后flush</text>
<polyline fill="none" stroke="#1c2123" points="429,-765 705,-765 "/>
<text text-anchor="start" x="437" y="-749.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pool: Arc&lt;Mutex&lt;ConnectionPool&gt;&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="429,-742 705,-742 "/>
<text text-anchor="start" x="437" y="-726.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">cache: LruCache&lt;(u64, usize), CachedQueue&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="429,-719 705,-719 "/>
<text text-anchor="start" x="437" y="-703.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">need_flush: Vec&lt;(u64, usize)&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="429,-696 705,-696 "/>
<text text-anchor="start" x="437" y="-680.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">full_stores: Vec&lt;(u64, usize)&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="429,-673 705,-673 "/>
<text text-anchor="start" x="437" y="-657.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">future_pool: Arc&lt;ThreadPool&lt;TaskCell&gt;&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="429,-650 705,-650 "/>
<text text-anchor="start" x="437" y="-634.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">builder: ConnectionBuilder&lt;S, R&gt;,</text>
</g>
<!-- ServerTransport&#45;&gt;RaftClient -->
<g id="edge6" class="edge">
<title>ServerTransport&#45;&gt;RaftClient</title>
<path fill="none" stroke="#666666" d="M324.28,-419.7C356.45,-460.53 425.05,-547.61 480.98,-618.6"/>
<polygon fill="#666666" stroke="#666666" points="478.45,-621.04 487.39,-626.73 483.95,-616.71 478.45,-621.04"/>
</g>
<!-- StoreAddrResolver -->
<g id="node12" class="node">
<title>StoreAddrResolver</title>
<path fill="none" stroke="#1c2123" d="M1443.5,-101.5C1443.5,-101.5 1574.5,-101.5 1574.5,-101.5 1580.5,-101.5 1586.5,-107.5 1586.5,-113.5 1586.5,-113.5 1586.5,-135.5 1586.5,-135.5 1586.5,-141.5 1580.5,-147.5 1574.5,-147.5 1574.5,-147.5 1443.5,-147.5 1443.5,-147.5 1437.5,-147.5 1431.5,-141.5 1431.5,-135.5 1431.5,-135.5 1431.5,-113.5 1431.5,-113.5 1431.5,-107.5 1437.5,-101.5 1443.5,-101.5"/>
<text text-anchor="middle" x="1509" y="-132.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">StoreAddrResolver</text>
<polyline fill="none" stroke="#1c2123" points="1431.5,-124.5 1586.5,-124.5 "/>
<text text-anchor="middle" x="1509" y="-109.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">解析store_id对应的addr</text>
</g>
<!-- ServerTransport&#45;&gt;StoreAddrResolver -->
<g id="edge7" class="edge">
<title>ServerTransport&#45;&gt;StoreAddrResolver</title>
<path fill="none" stroke="#666666" d="M359.72,-373.34C484,-321.05 802.12,-194.39 1082,-143.5 1197.95,-122.42 1334.43,-120.21 1421.07,-121.55"/>
<polygon fill="#666666" stroke="#666666" points="1421.06,-125.05 1431.12,-121.73 1421.18,-118.05 1421.06,-125.05"/>
</g>
<!-- RaftStoreRouter -->
<g id="node23" class="node">
<title>RaftStoreRouter</title>
<path fill="none" stroke="#1c2123" d="M1549.5,-439.5C1549.5,-439.5 1468.5,-439.5 1468.5,-439.5 1462.5,-439.5 1456.5,-433.5 1456.5,-427.5 1456.5,-427.5 1456.5,-415.5 1456.5,-415.5 1456.5,-409.5 1462.5,-403.5 1468.5,-403.5 1468.5,-403.5 1549.5,-403.5 1549.5,-403.5 1555.5,-403.5 1561.5,-409.5 1561.5,-415.5 1561.5,-415.5 1561.5,-427.5 1561.5,-427.5 1561.5,-433.5 1555.5,-439.5 1549.5,-439.5"/>
<text text-anchor="middle" x="1509" y="-417.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftStoreRouter</text>
</g>
<!-- ServerTransport&#45;&gt;RaftStoreRouter -->
<g id="edge8" class="edge">
<title>ServerTransport&#45;&gt;RaftStoreRouter</title>
<path fill="none" stroke="#666666" d="M393.41,-398.32C624.42,-403.12 1246.98,-416.07 1445.95,-420.21"/>
<polygon fill="#666666" stroke="#666666" points="1446.15,-423.71 1456.22,-420.42 1446.3,-416.72 1446.15,-423.71"/>
</g>
<!-- ConnectionPool -->
<g id="node3" class="node">
<title>ConnectionPool</title>
<path fill="none" stroke="#1c2123" d="M753,-950C753,-950 1034,-950 1034,-950 1040,-950 1046,-956 1046,-962 1046,-962 1046,-1045 1046,-1045 1046,-1051 1040,-1057 1034,-1057 1034,-1057 753,-1057 753,-1057 747,-1057 741,-1051 741,-1045 741,-1045 741,-962 741,-962 741,-956 747,-950 753,-950"/>
<text text-anchor="middle" x="893.5" y="-1041.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">ConnectionPool</text>
<polyline fill="none" stroke="#1c2123" points="741,-1034 1046,-1034 "/>
<text text-anchor="start" x="749" y="-1018.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">管理连接池</text>
<text text-anchor="start" x="749" y="-1003.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> key为store_id, conn_id</text>
<polyline fill="none" stroke="#1c2123" points="741,-996 1046,-996 "/>
<text text-anchor="start" x="749" y="-980.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">connections: HashMap&lt;(u64, usize), Arc&lt;Queue&gt;&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="741,-973 1046,-973 "/>
<text text-anchor="start" x="749" y="-957.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">tombstone_stores: HashSet&lt;u64&gt;,</text>
</g>
<!-- RaftClient&#45;&gt;ConnectionPool -->
<g id="edge9" class="edge">
<title>RaftClient&#45;&gt;ConnectionPool</title>
<path fill="none" stroke="#666666" d="M635.46,-826.26C664.61,-864.03 701.18,-905.19 741,-935.5 745.05,-938.59 749.27,-941.57 753.61,-944.45"/>
<polygon fill="#666666" stroke="#666666" points="751.77,-947.43 762.08,-949.87 755.54,-941.53 751.77,-947.43"/>
</g>
<!-- CachedQueue -->
<g id="node4" class="node">
<title>CachedQueue</title>
<path fill="none" stroke="#1c2123" d="M1151.5,-856.5C1151.5,-856.5 1258.5,-856.5 1258.5,-856.5 1264.5,-856.5 1270.5,-862.5 1270.5,-868.5 1270.5,-868.5 1270.5,-974.5 1270.5,-974.5 1270.5,-980.5 1264.5,-986.5 1258.5,-986.5 1258.5,-986.5 1151.5,-986.5 1151.5,-986.5 1145.5,-986.5 1139.5,-980.5 1139.5,-974.5 1139.5,-974.5 1139.5,-868.5 1139.5,-868.5 1139.5,-862.5 1145.5,-856.5 1151.5,-856.5"/>
<text text-anchor="middle" x="1205" y="-971.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">CachedQueue</text>
<polyline fill="none" stroke="#1c2123" points="1139.5,-963.5 1270.5,-963.5 "/>
<text text-anchor="start" x="1147.5" y="-948.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果dirty/full会</text>
<text text-anchor="start" x="1147.5" y="-933.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 调用queue的notify</text>
<polyline fill="none" stroke="#1c2123" points="1139.5,-925.5 1270.5,-925.5 "/>
<text text-anchor="start" x="1147.5" y="-910.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">queue: Arc&lt;Queue&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1139.5,-902.5 1270.5,-902.5 "/>
<text text-anchor="start" x="1147.5" y="-887.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">dirty: bool,</text>
<polyline fill="none" stroke="#1c2123" points="1139.5,-879.5 1270.5,-879.5 "/>
<text text-anchor="start" x="1147.5" y="-864.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">full: bool,</text>
</g>
<!-- RaftClient&#45;&gt;CachedQueue -->
<g id="edge10" class="edge">
<title>RaftClient&#45;&gt;CachedQueue</title>
<path fill="none" stroke="#666666" d="M641.34,-826.34C668.97,-856.3 703.01,-885.65 741,-902.5 808.3,-932.35 1016.05,-929.23 1129.01,-925.02"/>
<polygon fill="#666666" stroke="#666666" points="1129.44,-928.51 1139.3,-924.63 1129.17,-921.52 1129.44,-928.51"/>
</g>
<!-- ConnectionBuilder -->
<g id="node6" class="node">
<title>ConnectionBuilder</title>
<path fill="none" stroke="#1c2123" d="M1099.5,-153.5C1099.5,-153.5 1310.5,-153.5 1310.5,-153.5 1316.5,-153.5 1322.5,-159.5 1322.5,-165.5 1322.5,-165.5 1322.5,-355.5 1322.5,-355.5 1322.5,-361.5 1316.5,-367.5 1310.5,-367.5 1310.5,-367.5 1099.5,-367.5 1099.5,-367.5 1093.5,-367.5 1087.5,-361.5 1087.5,-355.5 1087.5,-355.5 1087.5,-165.5 1087.5,-165.5 1087.5,-159.5 1093.5,-153.5 1099.5,-153.5"/>
<text text-anchor="middle" x="1205" y="-352.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ConnectionBuilder</text>
<polyline fill="none" stroke="#1c2123" points="1087.5,-344.5 1322.5,-344.5 "/>
<text text-anchor="start" x="1095.5" y="-329.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">resolve store addr</text>
<text text-anchor="start" x="1095.5" y="-314.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 用于创建connection</text>
<text text-anchor="start" x="1095.5" y="-299.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 创建grpc channel</text>
<polyline fill="none" stroke="#1c2123" points="1087.5,-291.5 1322.5,-291.5 "/>
<text text-anchor="start" x="1095.5" y="-276.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">env: Arc&lt;Environment&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1087.5,-268.5 1322.5,-268.5 "/>
<text text-anchor="start" x="1095.5" y="-253.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">cfg: Arc&lt;Config&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1087.5,-245.5 1322.5,-245.5 "/>
<text text-anchor="start" x="1095.5" y="-230.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">security_mgr: Arc&lt;SecurityManager&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1087.5,-222.5 1322.5,-222.5 "/>
<text text-anchor="start" x="1095.5" y="-207.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">resolver: S,</text>
<polyline fill="none" stroke="#1c2123" points="1087.5,-199.5 1322.5,-199.5 "/>
<text text-anchor="start" x="1095.5" y="-184.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">router: R,</text>
<polyline fill="none" stroke="#1c2123" points="1087.5,-176.5 1322.5,-176.5 "/>
<text text-anchor="start" x="1095.5" y="-161.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">snap_scheduler: Scheduler&lt;SnapTask&gt;,</text>
</g>
<!-- RaftClient&#45;&gt;ConnectionBuilder -->
<g id="edge11" class="edge">
<title>RaftClient&#45;&gt;ConnectionBuilder</title>
<path fill="none" stroke="#666666" d="M612.28,-626.71C641.83,-569.65 685.44,-500.34 741,-453.5 839.1,-370.79 977.66,-319.36 1077.6,-290.59"/>
<polygon fill="#666666" stroke="#666666" points="1078.79,-293.89 1087.45,-287.79 1076.87,-287.16 1078.79,-293.89"/>
</g>
<!-- TaskCell -->
<g id="node9" class="node">
<title>TaskCell</title>
<path fill="none" stroke="#1c2123" d="M1117.5,-1053.5C1117.5,-1053.5 1292.5,-1053.5 1292.5,-1053.5 1298.5,-1053.5 1304.5,-1059.5 1304.5,-1065.5 1304.5,-1065.5 1304.5,-1087.5 1304.5,-1087.5 1304.5,-1093.5 1298.5,-1099.5 1292.5,-1099.5 1292.5,-1099.5 1117.5,-1099.5 1117.5,-1099.5 1111.5,-1099.5 1105.5,-1093.5 1105.5,-1087.5 1105.5,-1087.5 1105.5,-1065.5 1105.5,-1065.5 1105.5,-1059.5 1111.5,-1053.5 1117.5,-1053.5"/>
<text text-anchor="middle" x="1205" y="-1084.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">TaskCell</text>
<polyline fill="none" stroke="#1c2123" points="1105.5,-1076.5 1304.5,-1076.5 "/>
<text text-anchor="start" x="1113.5" y="-1061.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub struct TaskCell(Arc&lt;Task&gt;);</text>
</g>
<!-- RaftClient&#45;&gt;TaskCell -->
<g id="edge12" class="edge">
<title>RaftClient&#45;&gt;TaskCell</title>
<path fill="none" stroke="#666666" d="M589.26,-826.33C612.09,-906.37 657.02,-1013.75 741,-1066.5 851.09,-1135.65 1006.82,-1121.44 1106.62,-1101.58"/>
<polygon fill="#666666" stroke="#666666" points="1107.61,-1104.95 1116.7,-1099.52 1106.2,-1098.09 1107.61,-1104.95"/>
</g>
<!-- LruCache -->
<g id="node10" class="node">
<title>LruCache</title>
<path fill="none" stroke="#1c2123" d="M784,-710C784,-710 1003,-710 1003,-710 1009,-710 1015,-716 1015,-722 1015,-722 1015,-881 1015,-881 1015,-887 1009,-893 1003,-893 1003,-893 784,-893 784,-893 778,-893 772,-887 772,-881 772,-881 772,-722 772,-722 772,-716 778,-710 784,-710"/>
<text text-anchor="middle" x="893.5" y="-877.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">LruCache</text>
<polyline fill="none" stroke="#1c2123" points="772,-870 1015,-870 "/>
<text text-anchor="start" x="780" y="-854.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">key为store_id, conn_id</text>
<text text-anchor="start" x="780" y="-839.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> value为cached queue</text>
<polyline fill="none" stroke="#1c2123" points="772,-832 1015,-832 "/>
<text text-anchor="start" x="780" y="-816.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">在发消息时先从cache中获取</text>
<text text-anchor="start" x="780" y="-801.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> store_id, conn_id对应的queue</text>
<text text-anchor="start" x="780" y="-786.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 成功话，就把消息push到queue中</text>
<polyline fill="none" stroke="#1c2123" points="772,-779 1015,-779 "/>
<text text-anchor="start" x="780" y="-763.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">map: HashMap&lt;K, ValueEntry&lt;K, V&gt;&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="772,-756 1015,-756 "/>
<text text-anchor="start" x="780" y="-740.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">trace: Trace&lt;K&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="772,-733 1015,-733 "/>
<text text-anchor="start" x="780" y="-717.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">capacity: usize,</text>
</g>
<!-- RaftClient&#45;&gt;LruCache -->
<g id="edge13" class="edge">
<title>RaftClient&#45;&gt;LruCache</title>
<path fill="none" stroke="#666666" d="M705.15,-758.2C723.91,-762.54 743.14,-766.98 761.79,-771.29"/>
<polygon fill="#666666" stroke="#666666" points="761.25,-774.76 771.78,-773.6 762.83,-767.94 761.25,-774.76"/>
</g>
<!-- StreamBackEnd -->
<g id="node11" class="node">
<title>StreamBackEnd</title>
<path fill="none" stroke="#1c2123" d="M801,-463.5C801,-463.5 986,-463.5 986,-463.5 992,-463.5 998,-469.5 998,-475.5 998,-475.5 998,-581.5 998,-581.5 998,-587.5 992,-593.5 986,-593.5 986,-593.5 801,-593.5 801,-593.5 795,-593.5 789,-587.5 789,-581.5 789,-581.5 789,-475.5 789,-475.5 789,-469.5 795,-463.5 801,-463.5"/>
<text text-anchor="middle" x="893.5" y="-578.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">StreamBackEnd</text>
<polyline fill="none" stroke="#1c2123" points="789,-570.5 998,-570.5 "/>
<text text-anchor="start" x="797" y="-555.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">watches lifetime of a connection</text>
<text text-anchor="start" x="797" y="-540.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> and handles reconnecting</text>
<polyline fill="none" stroke="#1c2123" points="789,-532.5 998,-532.5 "/>
<text text-anchor="start" x="797" y="-517.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">store_id: u64,</text>
<polyline fill="none" stroke="#1c2123" points="789,-509.5 998,-509.5 "/>
<text text-anchor="start" x="797" y="-494.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">queue: Arc&lt;Queue&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="789,-486.5 998,-486.5 "/>
<text text-anchor="start" x="797" y="-471.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">builder: ConnectionBuilder&lt;S, R&gt;,</text>
</g>
<!-- RaftClient&#45;&gt;StreamBackEnd -->
<g id="edge28" class="edge">
<title>RaftClient&#45;&gt;StreamBackEnd</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M705.19,-627.98C717.17,-620.16 729.21,-612.57 741,-605.5 753.33,-598.1 766.47,-590.73 779.64,-583.64"/>
<polygon fill="green" stroke="green" points="781.58,-586.57 788.76,-578.78 778.29,-580.39 781.58,-586.57"/>
</g>
<!-- ThreadPool -->
<g id="node21" class="node">
<title>ThreadPool</title>
<path fill="none" stroke="#1c2123" d="M817.5,-614.5C817.5,-614.5 969.5,-614.5 969.5,-614.5 975.5,-614.5 981.5,-620.5 981.5,-626.5 981.5,-626.5 981.5,-678.5 981.5,-678.5 981.5,-684.5 975.5,-690.5 969.5,-690.5 969.5,-690.5 817.5,-690.5 817.5,-690.5 811.5,-690.5 805.5,-684.5 805.5,-678.5 805.5,-678.5 805.5,-626.5 805.5,-626.5 805.5,-620.5 811.5,-614.5 817.5,-614.5"/>
<text text-anchor="middle" x="893.5" y="-675.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">ThreadPool</text>
<polyline fill="none" stroke="#1c2123" points="805.5,-667.5 981.5,-667.5 "/>
<text text-anchor="start" x="813.5" y="-652.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">驱动RaftCall的poll</text>
<text text-anchor="start" x="813.5" y="-637.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 从queue中取raft msg</text>
<text text-anchor="start" x="813.5" y="-622.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 然后使用grpc channel发送</text>
</g>
<!-- RaftClient&#45;&gt;ThreadPool -->
<g id="edge29" class="edge">
<title>RaftClient&#45;&gt;ThreadPool</title>
<path fill="none" stroke="#666666" d="M705.15,-695.22C735.47,-688.31 767,-681.12 795.35,-674.65"/>
<polygon fill="#666666" stroke="#666666" points="796.27,-678.04 805.24,-672.4 794.71,-671.21 796.27,-678.04"/>
</g>
<!-- Queue -->
<g id="node5" class="node">
<title>Queue</title>
<path fill="none" stroke="#1c2123" d="M1419.5,-695C1419.5,-695 1598.5,-695 1598.5,-695 1604.5,-695 1610.5,-701 1610.5,-707 1610.5,-707 1610.5,-866 1610.5,-866 1610.5,-872 1604.5,-878 1598.5,-878 1598.5,-878 1419.5,-878 1419.5,-878 1413.5,-878 1407.5,-872 1407.5,-866 1407.5,-866 1407.5,-707 1407.5,-707 1407.5,-701 1413.5,-695 1419.5,-695"/>
<text text-anchor="middle" x="1509" y="-862.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">Queue</text>
<polyline fill="none" stroke="#1c2123" points="1407.5,-855 1610.5,-855 "/>
<text text-anchor="start" x="1415.5" y="-839.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">store_id, conn_id的</text>
<text text-anchor="start" x="1415.5" y="-824.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 消息发送队列</text>
<polyline fill="none" stroke="#1c2123" points="1407.5,-817 1610.5,-817 "/>
<text text-anchor="start" x="1415.5" y="-801.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">消息先放入buf</text>
<text text-anchor="start" x="1415.5" y="-786.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 等队列满或者flush时</text>
<text text-anchor="start" x="1415.5" y="-771.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> notify waker pop处理消息</text>
<polyline fill="none" stroke="#1c2123" points="1407.5,-764 1610.5,-764 "/>
<text text-anchor="start" x="1415.5" y="-748.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">buf: ArrayQueue&lt;RaftMessage&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1407.5,-741 1610.5,-741 "/>
<text text-anchor="start" x="1415.5" y="-725.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">connected: AtomicBool,</text>
<polyline fill="none" stroke="#1c2123" points="1407.5,-718 1610.5,-718 "/>
<text text-anchor="start" x="1415.5" y="-702.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">waker: Mutex&lt;Option&lt;Waker&gt;&gt;,</text>
</g>
<!-- ConnectionPool&#45;&gt;Queue -->
<g id="edge25" class="edge">
<title>ConnectionPool&#45;&gt;Queue</title>
<path fill="none" stroke="#666666" d="M1046.1,-1030.75C1132.63,-1039.21 1240.88,-1037.42 1328,-996.5 1377.81,-973.1 1419.1,-928.56 1449.51,-886.5"/>
<polygon fill="#666666" stroke="#666666" points="1452.52,-888.31 1455.45,-878.13 1446.81,-884.26 1452.52,-888.31"/>
</g>
<!-- CachedQueue&#45;&gt;Queue -->
<g id="edge14" class="edge">
<title>CachedQueue&#45;&gt;Queue</title>
<path fill="none" stroke="#666666" d="M1270.79,-892.54C1307.84,-875.97 1355.32,-854.75 1398.05,-835.65"/>
<polygon fill="#666666" stroke="#666666" points="1399.67,-838.76 1407.37,-831.48 1396.81,-832.37 1399.67,-838.76"/>
</g>
<!-- RaftMessage -->
<g id="node24" class="node">
<title>RaftMessage</title>
<path fill="none" stroke="#1c2123" d="M1852,-804.5C1852,-804.5 1788,-804.5 1788,-804.5 1782,-804.5 1776,-798.5 1776,-792.5 1776,-792.5 1776,-780.5 1776,-780.5 1776,-774.5 1782,-768.5 1788,-768.5 1788,-768.5 1852,-768.5 1852,-768.5 1858,-768.5 1864,-774.5 1864,-780.5 1864,-780.5 1864,-792.5 1864,-792.5 1864,-798.5 1858,-804.5 1852,-804.5"/>
<text text-anchor="middle" x="1820" y="-782.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftMessage</text>
</g>
<!-- Queue&#45;&gt;RaftMessage -->
<g id="edge18" class="edge">
<title>Queue&#45;&gt;RaftMessage</title>
<path fill="none" stroke="#666666" d="M1610.75,-786.5C1662.33,-786.5 1723.03,-786.5 1765.55,-786.5"/>
<polygon fill="#666666" stroke="#666666" points="1765.68,-790 1775.68,-786.5 1765.68,-783 1765.68,-790"/>
</g>
<!-- ConnectionBuilder&#45;&gt;StoreAddrResolver -->
<g id="edge1" class="edge">
<title>ConnectionBuilder&#45;&gt;StoreAddrResolver</title>
<path fill="none" stroke="#666666" d="M1322.58,-198.01C1336.42,-191.18 1350.45,-184.53 1364,-178.5 1385.67,-168.85 1409.65,-159.4 1431.72,-151.16"/>
<polygon fill="#666666" stroke="#666666" points="1433.21,-154.34 1441.38,-147.59 1430.78,-147.78 1433.21,-154.34"/>
</g>
<!-- SecurityManager -->
<g id="node17" class="node">
<title>SecurityManager</title>
<path fill="none" stroke="#1c2123" d="M1466,-188.5C1466,-188.5 1552,-188.5 1552,-188.5 1558,-188.5 1564,-194.5 1564,-200.5 1564,-200.5 1564,-222.5 1564,-222.5 1564,-228.5 1558,-234.5 1552,-234.5 1552,-234.5 1466,-234.5 1466,-234.5 1460,-234.5 1454,-228.5 1454,-222.5 1454,-222.5 1454,-200.5 1454,-200.5 1454,-194.5 1460,-188.5 1466,-188.5"/>
<text text-anchor="middle" x="1509" y="-219.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">SecurityManager</text>
<polyline fill="none" stroke="#1c2123" points="1454,-211.5 1564,-211.5 "/>
<text text-anchor="middle" x="1509" y="-196.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">管理ssl证书</text>
</g>
<!-- ConnectionBuilder&#45;&gt;SecurityManager -->
<g id="edge2" class="edge">
<title>ConnectionBuilder&#45;&gt;SecurityManager</title>
<path fill="none" stroke="#666666" d="M1322.76,-241.56C1363.85,-234.89 1408.51,-227.64 1443.69,-221.93"/>
<polygon fill="#666666" stroke="#666666" points="1444.5,-225.35 1453.81,-220.29 1443.38,-218.44 1444.5,-225.35"/>
</g>
<!-- ChannelBuilder -->
<g id="node19" class="node">
<title>ChannelBuilder</title>
<path fill="none" stroke="#1c2123" d="M1376,-292.5C1376,-292.5 1642,-292.5 1642,-292.5 1648,-292.5 1654,-298.5 1654,-304.5 1654,-304.5 1654,-372.5 1654,-372.5 1654,-378.5 1648,-384.5 1642,-384.5 1642,-384.5 1376,-384.5 1376,-384.5 1370,-384.5 1364,-378.5 1364,-372.5 1364,-372.5 1364,-304.5 1364,-304.5 1364,-298.5 1370,-292.5 1376,-292.5"/>
<text text-anchor="middle" x="1509" y="-369.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">grpcio/ChannelBuilder</text>
<polyline fill="none" stroke="#1c2123" points="1364,-361.5 1654,-361.5 "/>
<text text-anchor="start" x="1372" y="-346.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">创建grpc channel 会引用env</text>
<polyline fill="none" stroke="#1c2123" points="1364,-338.5 1654,-338.5 "/>
<text text-anchor="start" x="1372" y="-323.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">env: Arc&lt;Environment&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1364,-315.5 1654,-315.5 "/>
<text text-anchor="start" x="1372" y="-300.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">options: HashMap&lt;Cow&lt;&#39;static, [u8]&gt;, Options&gt;,</text>
</g>
<!-- ConnectionBuilder&#45;&gt;ChannelBuilder -->
<g id="edge3" class="edge">
<title>ConnectionBuilder&#45;&gt;ChannelBuilder</title>
<path fill="none" stroke="#666666" d="M1322.76,-290.66C1332.95,-293.29 1343.36,-295.98 1353.79,-298.67"/>
<polygon fill="#666666" stroke="#666666" points="1353.23,-302.14 1363.78,-301.25 1354.98,-295.36 1353.23,-302.14"/>
</g>
<!-- Environment -->
<g id="node20" class="node">
<title>Environment</title>
<path fill="none" stroke="#1c2123" d="M1732,-286.5C1732,-286.5 1908,-286.5 1908,-286.5 1914,-286.5 1920,-292.5 1920,-298.5 1920,-298.5 1920,-366.5 1920,-366.5 1920,-372.5 1914,-378.5 1908,-378.5 1908,-378.5 1732,-378.5 1732,-378.5 1726,-378.5 1720,-372.5 1720,-366.5 1720,-366.5 1720,-298.5 1720,-298.5 1720,-292.5 1726,-286.5 1732,-286.5"/>
<text text-anchor="middle" x="1820" y="-363.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Environment</text>
<polyline fill="none" stroke="#1c2123" points="1720,-355.5 1920,-355.5 "/>
<text text-anchor="start" x="1728" y="-340.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">cqs: Vec&lt;CompletionQueue&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1720,-332.5 1920,-332.5 "/>
<text text-anchor="start" x="1728" y="-317.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">idx: AtomicUsize,</text>
<polyline fill="none" stroke="#1c2123" points="1720,-309.5 1920,-309.5 "/>
<text text-anchor="start" x="1728" y="-294.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">_handles: Vec&lt;JoinHandle&lt;()&gt;&gt;,</text>
</g>
<!-- ConnectionBuilder&#45;&gt;Environment -->
<g id="edge4" class="edge">
<title>ConnectionBuilder&#45;&gt;Environment</title>
<path fill="none" stroke="#666666" d="M1322.89,-258.44C1413.8,-258.72 1542.75,-263.21 1654,-282.5 1672.25,-285.66 1691.32,-290.22 1709.74,-295.31"/>
<polygon fill="#666666" stroke="#666666" points="1709.03,-298.74 1719.6,-298.1 1710.93,-292.01 1709.03,-298.74"/>
</g>
<!-- ConnectionBuilder&#45;&gt;RaftStoreRouter -->
<g id="edge5" class="edge">
<title>ConnectionBuilder&#45;&gt;RaftStoreRouter</title>
<path fill="none" stroke="#666666" d="M1320.49,-367.8C1334.48,-377.54 1349.12,-386.39 1364,-393.5 1389.46,-405.67 1419.85,-412.55 1446.14,-416.44"/>
<polygon fill="#666666" stroke="#666666" points="1445.99,-419.95 1456.37,-417.84 1446.94,-413.02 1445.99,-419.95"/>
</g>
<!-- TaskExtras -->
<g id="node7" class="node">
<title>TaskExtras</title>
<path fill="none" stroke="#1c2123" d="M1702,-1042C1702,-1042 1938,-1042 1938,-1042 1944,-1042 1950,-1048 1950,-1054 1950,-1054 1950,-1099 1950,-1099 1950,-1105 1944,-1111 1938,-1111 1938,-1111 1702,-1111 1702,-1111 1696,-1111 1690,-1105 1690,-1099 1690,-1099 1690,-1054 1690,-1054 1690,-1048 1696,-1042 1702,-1042"/>
<text text-anchor="middle" x="1820" y="-1095.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">TaskExtras</text>
<polyline fill="none" stroke="#1c2123" points="1690,-1088 1950,-1088 "/>
<text text-anchor="start" x="1698" y="-1072.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">extras: Extras,</text>
<polyline fill="none" stroke="#1c2123" points="1690,-1065 1950,-1065 "/>
<text text-anchor="start" x="1698" y="-1049.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">remote: Option&lt;WeakRemote&lt;TaskCell&gt;&gt;,</text>
</g>
<!-- Task -->
<g id="node8" class="node">
<title>Task</title>
<path fill="none" stroke="#1c2123" d="M1422,-1015.5C1422,-1015.5 1596,-1015.5 1596,-1015.5 1602,-1015.5 1608,-1021.5 1608,-1027.5 1608,-1027.5 1608,-1125.5 1608,-1125.5 1608,-1131.5 1602,-1137.5 1596,-1137.5 1596,-1137.5 1422,-1137.5 1422,-1137.5 1416,-1137.5 1410,-1131.5 1410,-1125.5 1410,-1125.5 1410,-1027.5 1410,-1027.5 1410,-1021.5 1416,-1015.5 1422,-1015.5"/>
<text text-anchor="middle" x="1509" y="-1122.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Task</text>
<polyline fill="none" stroke="#1c2123" points="1410,-1114.5 1608,-1114.5 "/>
<text text-anchor="start" x="1418" y="-1099.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">status: AtomicU8,</text>
<polyline fill="none" stroke="#1c2123" points="1410,-1091.5 1608,-1091.5 "/>
<text text-anchor="start" x="1418" y="-1076.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">extras: UnsafeCell&lt;TaskExtras&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1410,-1068.5 1608,-1068.5 "/>
<text text-anchor="start" x="1418" y="-1053.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">future: UnsafeCell&lt;Pin</text>
<text text-anchor="start" x="1418" y="-1038.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> &lt;Box&lt;dyn Future&lt;Output = ()&gt;</text>
<text text-anchor="start" x="1418" y="-1023.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> + Send + &#39;static&gt;&gt;&gt;,</text>
</g>
<!-- Task&#45;&gt;TaskExtras -->
<g id="edge16" class="edge">
<title>Task&#45;&gt;TaskExtras</title>
<path fill="none" stroke="#666666" d="M1608.19,-1076.5C1630.92,-1076.5 1655.54,-1076.5 1679.66,-1076.5"/>
<polygon fill="#666666" stroke="#666666" points="1679.95,-1080 1689.95,-1076.5 1679.95,-1073 1679.95,-1080"/>
</g>
<!-- TaskCell&#45;&gt;Task -->
<g id="edge15" class="edge">
<title>TaskCell&#45;&gt;Task</title>
<path fill="none" stroke="#666666" d="M1304.89,-1076.5C1335.18,-1076.5 1368.66,-1076.5 1399.55,-1076.5"/>
<polygon fill="#666666" stroke="#666666" points="1399.92,-1080 1409.92,-1076.5 1399.92,-1073 1399.92,-1080"/>
</g>
<!-- LruCache&#45;&gt;CachedQueue -->
<g id="edge17" class="edge">
<title>LruCache&#45;&gt;CachedQueue</title>
<path fill="none" stroke="#666666" d="M1015.05,-848.24C1053.68,-863.22 1095.3,-879.36 1129.63,-892.66"/>
<polygon fill="#666666" stroke="#666666" points="1128.51,-895.99 1139.1,-896.34 1131.05,-889.46 1128.51,-895.99"/>
</g>
<!-- StreamBackEnd&#45;&gt;Queue -->
<g id="edge19" class="edge">
<title>StreamBackEnd&#45;&gt;Queue</title>
<path fill="none" stroke="#666666" d="M998.25,-488.7C1090.72,-460.15 1226.7,-435.75 1328,-492.5 1401.05,-533.43 1448.02,-617.45 1475.6,-685.22"/>
<polygon fill="#666666" stroke="#666666" points="1472.41,-686.67 1479.36,-694.67 1478.91,-684.08 1472.41,-686.67"/>
</g>
<!-- StreamBackEnd&#45;&gt;ConnectionBuilder -->
<g id="edge20" class="edge">
<title>StreamBackEnd&#45;&gt;ConnectionBuilder</title>
<path fill="none" stroke="#666666" d="M998.12,-480.71C1014.83,-471.09 1031.42,-460.27 1046,-448.5 1072.27,-427.3 1097.41,-401.23 1119.6,-375.33"/>
<polygon fill="#666666" stroke="#666666" points="1122.3,-377.56 1126.08,-367.67 1116.95,-373.04 1122.3,-377.56"/>
</g>
<!-- RaftCall -->
<g id="node16" class="node">
<title>RaftCall</title>
<path fill="none" stroke="#1c2123" d="M1094,-501.5C1094,-501.5 1316,-501.5 1316,-501.5 1322,-501.5 1328,-507.5 1328,-513.5 1328,-513.5 1328,-825.5 1328,-825.5 1328,-831.5 1322,-837.5 1316,-837.5 1316,-837.5 1094,-837.5 1094,-837.5 1088,-837.5 1082,-831.5 1082,-825.5 1082,-825.5 1082,-513.5 1082,-513.5 1082,-507.5 1088,-501.5 1094,-501.5"/>
<text text-anchor="middle" x="1205" y="-822.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RaftCall</text>
<polyline fill="none" stroke="#1c2123" points="1082,-814.5 1328,-814.5 "/>
<text text-anchor="start" x="1090" y="-799.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">用来管理batch_raft/raft rpc调用</text>
<text text-anchor="start" x="1090" y="-784.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> sender/receiver 为</text>
<text text-anchor="start" x="1090" y="-769.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> grpc stream的输入输出</text>
<polyline fill="none" stroke="#1c2123" points="1082,-761.5 1328,-761.5 "/>
<text text-anchor="start" x="1090" y="-746.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">被poll时不断的Queue中pop消息</text>
<text text-anchor="start" x="1090" y="-731.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 发到sender, 然后poll receiver</text>
<text text-anchor="start" x="1090" y="-716.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> router用来broadcast store unreachable</text>
<polyline fill="none" stroke="#1c2123" points="1082,-708.5 1328,-708.5 "/>
<text text-anchor="start" x="1090" y="-693.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">sender: ClientCStreamSender&lt;M&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1082,-685.5 1328,-685.5 "/>
<text text-anchor="start" x="1090" y="-670.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">receiver: ClientCStreamReceiver&lt;Done&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1082,-662.5 1328,-662.5 "/>
<text text-anchor="start" x="1090" y="-647.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">queue: Arc&lt;Queue&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1082,-639.5 1328,-639.5 "/>
<text text-anchor="start" x="1090" y="-624.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">buffer: B,</text>
<polyline fill="none" stroke="#1c2123" points="1082,-616.5 1328,-616.5 "/>
<text text-anchor="start" x="1090" y="-601.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">router: R,</text>
<polyline fill="none" stroke="#1c2123" points="1082,-593.5 1328,-593.5 "/>
<text text-anchor="start" x="1090" y="-578.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">snap_scheduler: Scheduler&lt;SnapTask&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1082,-570.5 1328,-570.5 "/>
<text text-anchor="start" x="1090" y="-555.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">lifetime: Option&lt;oneshot::Sender&lt;()&gt;&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1082,-547.5 1328,-547.5 "/>
<text text-anchor="start" x="1090" y="-532.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">store_id: u64,</text>
<polyline fill="none" stroke="#1c2123" points="1082,-524.5 1328,-524.5 "/>
<text text-anchor="start" x="1090" y="-509.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">addr: String,</text>
</g>
<!-- StreamBackEnd&#45;&gt;RaftCall -->
<g id="edge30" class="edge">
<title>StreamBackEnd&#45;&gt;RaftCall</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M998.42,-575.84C1022.27,-586.71 1047.94,-598.4 1072.77,-609.72"/>
<polygon fill="green" stroke="green" points="1071.33,-612.9 1081.88,-613.87 1074.23,-606.53 1071.33,-612.9"/>
</g>
<!-- StreamBackEnd&#45;&gt;ChannelBuilder -->
<g id="edge21" class="edge">
<title>StreamBackEnd&#45;&gt;ChannelBuilder</title>
<path fill="none" stroke="#666666" d="M998.1,-488.08C1025.24,-477.97 1054.59,-467.46 1082,-458.5 1171.3,-429.31 1272.49,-400.62 1353.83,-378.62"/>
<polygon fill="#666666" stroke="#666666" points="1354.91,-381.96 1363.65,-375.97 1353.08,-375.2 1354.91,-381.96"/>
</g>
<!-- PdStoreAddrResolver -->
<g id="node13" class="node">
<title>PdStoreAddrResolver</title>
<path fill="none" stroke="#1c2123" d="M1726,-88C1726,-88 1914,-88 1914,-88 1920,-88 1926,-94 1926,-100 1926,-100 1926,-137 1926,-137 1926,-143 1920,-149 1914,-149 1914,-149 1726,-149 1726,-149 1720,-149 1714,-143 1714,-137 1714,-137 1714,-100 1714,-100 1714,-94 1720,-88 1726,-88"/>
<text text-anchor="middle" x="1820" y="-133.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">PdStoreAddrResolver</text>
<polyline fill="none" stroke="#1c2123" points="1714,-126 1926,-126 "/>
<text text-anchor="start" x="1722" y="-110.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">去Pd服务请求store_id对应的addr</text>
<text text-anchor="start" x="1722" y="-95.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> sched: Scheduler&lt;Task&gt;,</text>
</g>
<!-- StoreAddrResolver&#45;&gt;PdStoreAddrResolver -->
<g id="edge22" class="edge">
<title>StoreAddrResolver&#45;&gt;PdStoreAddrResolver</title>
<path fill="none" stroke="#666666" d="M1586.78,-123.01C1621.97,-122.33 1664.44,-121.5 1703.39,-120.74"/>
<polygon fill="#666666" stroke="#666666" points="1703.81,-124.24 1713.74,-120.54 1703.67,-117.24 1703.81,-124.24"/>
</g>
<!-- resolve_Task -->
<g id="node14" class="node">
<title>resolve_Task</title>
<path fill="none" stroke="#1c2123" d="M2031.5,-149.5C2031.5,-149.5 2174.5,-149.5 2174.5,-149.5 2180.5,-149.5 2186.5,-155.5 2186.5,-161.5 2186.5,-161.5 2186.5,-183.5 2186.5,-183.5 2186.5,-189.5 2180.5,-195.5 2174.5,-195.5 2174.5,-195.5 2031.5,-195.5 2031.5,-195.5 2025.5,-195.5 2019.5,-189.5 2019.5,-183.5 2019.5,-183.5 2019.5,-161.5 2019.5,-161.5 2019.5,-155.5 2025.5,-149.5 2031.5,-149.5"/>
<text text-anchor="middle" x="2103" y="-180.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">resolve.rs/Task</text>
<polyline fill="none" stroke="#1c2123" points="2019.5,-172.5 2186.5,-172.5 "/>
<text text-anchor="middle" x="2103" y="-157.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">store_id: u64, cb: Callback,</text>
</g>
<!-- PdStoreAddrResolver&#45;&gt;resolve_Task -->
<g id="edge23" class="edge">
<title>PdStoreAddrResolver&#45;&gt;resolve_Task</title>
<path fill="none" stroke="#666666" d="M1926.03,-138.68C1953.4,-143.94 1982.69,-149.57 2009.37,-154.7"/>
<polygon fill="#666666" stroke="#666666" points="2008.97,-158.19 2019.45,-156.64 2010.3,-151.31 2008.97,-158.19"/>
</g>
<!-- Scheduler -->
<g id="node15" class="node">
<title>Scheduler</title>
<path fill="none" stroke="#1c2123" d="M1998,-0.5C1998,-0.5 2208,-0.5 2208,-0.5 2214,-0.5 2220,-6.5 2220,-12.5 2220,-12.5 2220,-118.5 2220,-118.5 2220,-124.5 2214,-130.5 2208,-130.5 2208,-130.5 1998,-130.5 1998,-130.5 1992,-130.5 1986,-124.5 1986,-118.5 1986,-118.5 1986,-12.5 1986,-12.5 1986,-6.5 1992,-0.5 1998,-0.5"/>
<text text-anchor="middle" x="2103" y="-115.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Scheduler</text>
<polyline fill="none" stroke="#1c2123" points="1986,-107.5 2220,-107.5 "/>
<text text-anchor="start" x="1994" y="-92.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">使用sender向worker线程发送task</text>
<text text-anchor="start" x="1994" y="-77.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> counter: Arc&lt;AtomicUsize&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1986,-69.5 2220,-69.5 "/>
<text text-anchor="start" x="1994" y="-54.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">sender: UnboundedSender&lt;Msg&lt;T&gt;&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="1986,-46.5 2220,-46.5 "/>
<text text-anchor="start" x="1994" y="-31.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pending_capacity: usize,</text>
<polyline fill="none" stroke="#1c2123" points="1986,-23.5 2220,-23.5 "/>
<text text-anchor="start" x="1994" y="-8.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">metrics_pending_task_count: IntGauge,</text>
</g>
<!-- PdStoreAddrResolver&#45;&gt;Scheduler -->
<g id="edge24" class="edge">
<title>PdStoreAddrResolver&#45;&gt;Scheduler</title>
<path fill="none" stroke="#666666" d="M1926.03,-98.69C1942.17,-95.65 1958.97,-92.48 1975.52,-89.36"/>
<polygon fill="#666666" stroke="#666666" points="1976.6,-92.71 1985.78,-87.42 1975.3,-85.84 1976.6,-92.71"/>
</g>
<!-- RaftCall&#45;&gt;Queue -->
<g id="edge26" class="edge">
<title>RaftCall&#45;&gt;Queue</title>
<path fill="none" stroke="#666666" d="M1328.4,-716.92C1351.29,-725.79 1375.09,-735.01 1397.59,-743.73"/>
<polygon fill="#666666" stroke="#666666" points="1396.56,-747.08 1407.15,-747.43 1399.09,-740.55 1396.56,-747.08"/>
</g>
<!-- RaftCall&#45;&gt;RaftStoreRouter -->
<g id="edge27" class="edge">
<title>RaftCall&#45;&gt;RaftStoreRouter</title>
<path fill="none" stroke="#666666" d="M1328.4,-568.99C1383.19,-523.99 1443.21,-474.71 1478.13,-446.03"/>
<polygon fill="#666666" stroke="#666666" points="1480.52,-448.6 1486.03,-439.54 1476.08,-443.19 1480.52,-448.6"/>
</g>
<!-- SecurityConfig -->
<g id="node18" class="node">
<title>SecurityConfig</title>
<path fill="none" stroke="#1c2123" d="M1764.5,-168.5C1764.5,-168.5 1875.5,-168.5 1875.5,-168.5 1881.5,-168.5 1887.5,-174.5 1887.5,-180.5 1887.5,-180.5 1887.5,-248.5 1887.5,-248.5 1887.5,-254.5 1881.5,-260.5 1875.5,-260.5 1875.5,-260.5 1764.5,-260.5 1764.5,-260.5 1758.5,-260.5 1752.5,-254.5 1752.5,-248.5 1752.5,-248.5 1752.5,-180.5 1752.5,-180.5 1752.5,-174.5 1758.5,-168.5 1764.5,-168.5"/>
<text text-anchor="middle" x="1820" y="-245.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">SecurityConfig</text>
<polyline fill="none" stroke="#1c2123" points="1752.5,-237.5 1887.5,-237.5 "/>
<text text-anchor="start" x="1760.5" y="-222.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub ca_path: String,</text>
<polyline fill="none" stroke="#1c2123" points="1752.5,-214.5 1887.5,-214.5 "/>
<text text-anchor="start" x="1760.5" y="-199.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub cert_path: String,</text>
<polyline fill="none" stroke="#1c2123" points="1752.5,-191.5 1887.5,-191.5 "/>
<text text-anchor="start" x="1760.5" y="-176.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pub key_path: String,</text>
</g>
<!-- SecurityManager&#45;&gt;SecurityConfig -->
<g id="edge31" class="edge">
<title>SecurityManager&#45;&gt;SecurityConfig</title>
<path fill="none" stroke="#666666" d="M1564.18,-212.03C1613.55,-212.51 1687,-213.22 1742.38,-213.76"/>
<polygon fill="#666666" stroke="#666666" points="1742.47,-217.26 1752.5,-213.85 1742.53,-210.26 1742.47,-217.26"/>
</g>
<!-- ChannelBuilder&#45;&gt;Environment -->
<g id="edge32" class="edge">
<title>ChannelBuilder&#45;&gt;Environment</title>
<path fill="none" stroke="#666666" d="M1654.1,-335.7C1672.73,-335.34 1691.56,-334.97 1709.51,-334.63"/>
<polygon fill="#666666" stroke="#666666" points="1709.74,-338.12 1719.67,-334.43 1709.61,-331.12 1709.74,-338.12"/>
</g>
<!-- ThreadPool&#45;&gt;TaskCell -->
<g id="edge34" class="edge">
<title>ThreadPool&#45;&gt;TaskCell</title>
<path fill="none" stroke="#666666" d="M981.81,-662.42C1005.93,-669.4 1029.88,-681.07 1046,-700.5 1130.61,-802.5 1012.09,-883.92 1082,-996.5 1095.68,-1018.53 1117.94,-1035.74 1139.72,-1048.45"/>
<polygon fill="#666666" stroke="#666666" points="1138.23,-1051.63 1148.67,-1053.45 1141.65,-1045.52 1138.23,-1051.63"/>
</g>
<!-- ThreadPool&#45;&gt;RaftCall -->
<g id="edge33" class="edge">
<title>ThreadPool&#45;&gt;RaftCall</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M981.54,-657.28C1009.49,-658.82 1041.11,-660.55 1071.55,-662.23"/>
<polygon fill="green" stroke="green" points="1071.65,-665.74 1081.83,-662.79 1072.03,-658.75 1071.65,-665.74"/>
</g>
<!-- Server -->
<g id="node22" class="node">
<title>Server</title>
<path fill="none" stroke="#1c2123" d="M12,-354.5C12,-354.5 169,-354.5 169,-354.5 175,-354.5 181,-360.5 181,-366.5 181,-366.5 181,-426.5 181,-426.5 181,-432.5 175,-438.5 169,-438.5 169,-438.5 12,-438.5 12,-438.5 6,-438.5 0,-432.5 0,-426.5 0,-426.5 0,-366.5 0,-366.5 0,-360.5 6,-354.5 12,-354.5"/>
<text text-anchor="middle" x="90.5" y="-423.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">Server</text>
<polyline fill="none" stroke="#1c2123" points="0,-415.5 181,-415.5 "/>
<text text-anchor="start" x="8" y="-400.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">env: Arc&lt;Environment&gt;,</text>
<polyline fill="none" stroke="#1c2123" points="0,-392.5 181,-392.5 "/>
<text text-anchor="start" x="8" y="-377.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">trans: ServerTransport&lt;T, S&gt;,</text>
<text text-anchor="start" x="8" y="-362.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> ...</text>
</g>
<!-- Server&#45;&gt;ServerTransport -->
<g id="edge35" class="edge">
<title>Server&#45;&gt;ServerTransport</title>
<path fill="none" stroke="#666666" d="M181,-396.5C189.56,-396.5 198.27,-396.5 206.9,-396.5"/>
<polygon fill="#666666" stroke="#666666" points="206.98,-400 216.98,-396.5 206.98,-393 206.98,-400"/>
</g>
</g>
</svg>
