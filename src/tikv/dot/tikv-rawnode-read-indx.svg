<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.1 (20200629.0846)
 -->
<!-- Title: read_index Pages: 1 -->
<svg width="1808pt" height="867pt"
 viewBox="0.00 0.00 1808.00 867.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 863)">
<title>read_index</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-863 1804,-863 1804,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_RaftRs</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M539,-55C539,-55 900,-55 900,-55 906,-55 912,-61 912,-67 912,-67 912,-182 912,-182 912,-188 906,-194 900,-194 900,-194 539,-194 539,-194 533,-194 527,-188 527,-182 527,-182 527,-67 527,-67 527,-61 533,-55 539,-55"/>
<text text-anchor="middle" x="719.5" y="-174" font-family="Times,serif" font-size="20.00">raft&#45;rs</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_ReadIndexQueue</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M1297,-8C1297,-8 1780,-8 1780,-8 1786,-8 1792,-14 1792,-20 1792,-20 1792,-182 1792,-182 1792,-188 1786,-194 1780,-194 1780,-194 1297,-194 1297,-194 1291,-194 1285,-188 1285,-182 1285,-182 1285,-20 1285,-20 1285,-14 1291,-8 1297,-8"/>
<text text-anchor="middle" x="1538.5" y="-174" font-family="Times,serif" font-size="20.00">ReadIndexQueue</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_Peer</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M20,-202C20,-202 1498,-202 1498,-202 1504,-202 1510,-208 1510,-214 1510,-214 1510,-839 1510,-839 1510,-845 1504,-851 1498,-851 1498,-851 20,-851 20,-851 14,-851 8,-845 8,-839 8,-839 8,-214 8,-214 8,-208 14,-202 20,-202"/>
<text text-anchor="middle" x="759" y="-831" font-family="Times,serif" font-size="20.00">Peer</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_pending_reads</title>
<path fill="none" stroke="slategrey" stroke-dasharray="5,2" d="M761,-517C761,-517 1490,-517 1490,-517 1496,-517 1502,-523 1502,-529 1502,-529 1502,-649 1502,-649 1502,-655 1496,-661 1490,-661 1490,-661 761,-661 761,-661 755,-661 749,-655 749,-649 749,-649 749,-529 749,-529 749,-523 755,-517 761,-517"/>
<text text-anchor="middle" x="1125.5" y="-641" font-family="Times,serif" font-size="20.00">pending_reads</text>
</g>
<!-- raft_group_raft_pending_read_count -->
<g id="node1" class="node">
<title>raft_group_raft_pending_read_count</title>
<path fill="none" stroke="#1c2123" d="M547,-119C547,-119 672,-119 672,-119 678,-119 684,-125 684,-131 684,-131 684,-143 684,-143 684,-149 678,-155 672,-155 672,-155 547,-155 547,-155 541,-155 535,-149 535,-143 535,-143 535,-131 535,-131 535,-125 541,-119 547,-119"/>
<text text-anchor="middle" x="609.5" y="-133.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">raft.pending_read_count</text>
</g>
<!-- raft_group_raft_ready_read_count -->
<g id="node2" class="node">
<title>raft_group_raft_ready_read_count</title>
<path fill="none" stroke="#1c2123" d="M553.5,-64C553.5,-64 665.5,-64 665.5,-64 671.5,-64 677.5,-70 677.5,-76 677.5,-76 677.5,-88 677.5,-88 677.5,-94 671.5,-100 665.5,-100 665.5,-100 553.5,-100 553.5,-100 547.5,-100 541.5,-94 541.5,-88 541.5,-88 541.5,-76 541.5,-76 541.5,-70 547.5,-64 553.5,-64"/>
<text text-anchor="middle" x="609.5" y="-78.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">raft.ready_read_count</text>
</g>
<!-- raft_group_read_index -->
<g id="node3" class="node">
<title>raft_group_read_index</title>
<path fill="none" stroke="#1c2123" d="M778,-63.5C778,-63.5 892,-63.5 892,-63.5 898,-63.5 904,-69.5 904,-75.5 904,-75.5 904,-142.5 904,-142.5 904,-148.5 898,-154.5 892,-154.5 892,-154.5 778,-154.5 778,-154.5 772,-154.5 766,-148.5 766,-142.5 766,-142.5 766,-75.5 766,-75.5 766,-69.5 772,-63.5 778,-63.5"/>
<text text-anchor="start" x="774" y="-139.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">read_index</text>
<polyline fill="none" stroke="#1c2123" points="766,-131.5 904,-131.5 "/>
<text text-anchor="start" x="774" y="-116.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">调用raft的read_index</text>
<text text-anchor="start" x="774" y="-101.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 后面调用ready</text>
<text text-anchor="start" x="774" y="-86.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 根据read_states字段</text>
<text text-anchor="start" x="774" y="-71.3" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 获取可以read的id</text>
</g>
<!-- ReadIndexQueue -->
<g id="node4" class="node">
<title>ReadIndexQueue</title>
<path fill="#79d8ce" stroke="#60b5ac" d="M1542,-17C1542,-17 1772,-17 1772,-17 1778,-17 1784,-23 1784,-29 1784,-29 1784,-143 1784,-143 1784,-149 1778,-155 1772,-155 1772,-155 1542,-155 1542,-155 1536,-155 1530,-149 1530,-143 1530,-143 1530,-29 1530,-29 1530,-23 1536,-17 1542,-17"/>
<text text-anchor="middle" x="1657" y="-139.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">ReadIndexQueue</text>
<polyline fill="none" stroke="#60b5ac" points="1530,-132 1784,-132 "/>
<text text-anchor="start" x="1538" y="-116.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">reads: VecDeque&lt;ReadIndexRequest&lt;S&gt;&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="1530,-109 1784,-109 "/>
<text text-anchor="start" x="1538" y="-93.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">ready_cnt: usize,</text>
<polyline fill="none" stroke="#60b5ac" points="1530,-86 1784,-86 "/>
<text text-anchor="start" x="1538" y="-70.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">handled_cnt: usize,</text>
<polyline fill="none" stroke="#60b5ac" points="1530,-63 1784,-63 "/>
<text text-anchor="start" x="1538" y="-47.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">contexts: HashMap&lt;Uuid, usize&gt;,</text>
<polyline fill="none" stroke="#60b5ac" points="1530,-40 1784,-40 "/>
<text text-anchor="start" x="1538" y="-24.8" font-family="Times,serif" font-size="14.00" fill="#5d6179">retry_countdown: usize,</text>
</g>
<!-- context_insert -->
<g id="node5" class="node">
<title>context_insert</title>
<path fill="none" stroke="#1c2123" d="M1382.5,-81C1382.5,-81 1313.5,-81 1313.5,-81 1307.5,-81 1301.5,-75 1301.5,-69 1301.5,-69 1301.5,-57 1301.5,-57 1301.5,-51 1307.5,-45 1313.5,-45 1313.5,-45 1382.5,-45 1382.5,-45 1388.5,-45 1394.5,-51 1394.5,-57 1394.5,-57 1394.5,-69 1394.5,-69 1394.5,-75 1388.5,-81 1382.5,-81"/>
<text text-anchor="middle" x="1348" y="-59.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">context_insert</text>
</g>
<!-- context_insert&#45;&gt;ReadIndexQueue -->
<g id="edge1" class="edge">
<title>context_insert&#45;&gt;ReadIndexQueue:context</title>
<path fill="none" stroke="#666666" d="M1394.69,-58.29C1428.61,-55.17 1476.34,-51.57 1519.9,-51.06"/>
<polygon fill="#666666" stroke="#666666" points="1520.02,-54.56 1530,-51 1519.98,-47.56 1520.02,-54.56"/>
</g>
<!-- reads_push_back -->
<g id="node6" class="node">
<title>reads_push_back</title>
<path fill="none" stroke="#1c2123" d="M1391,-147C1391,-147 1305,-147 1305,-147 1299,-147 1293,-141 1293,-135 1293,-135 1293,-123 1293,-123 1293,-117 1299,-111 1305,-111 1305,-111 1391,-111 1391,-111 1397,-111 1403,-117 1403,-123 1403,-123 1403,-135 1403,-135 1403,-141 1397,-147 1391,-147"/>
<text text-anchor="middle" x="1348" y="-125.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">reads_push_back</text>
</g>
<!-- reads_push_back&#45;&gt;ReadIndexQueue -->
<g id="edge2" class="edge">
<title>reads_push_back&#45;&gt;ReadIndexQueue:reads</title>
<path fill="none" stroke="#666666" d="M1403.23,-125.35C1436.36,-123.41 1479.92,-121.35 1519.92,-121.04"/>
<polygon fill="#666666" stroke="#666666" points="1520.01,-124.54 1530,-121 1519.99,-117.54 1520.01,-124.54"/>
</g>
<!-- propose -->
<g id="node7" class="node">
<title>propose</title>
<path fill="none" stroke="#1c2123" d="M63,-515C63,-515 28,-515 28,-515 22,-515 16,-509 16,-503 16,-503 16,-491 16,-491 16,-485 22,-479 28,-479 28,-479 63,-479 63,-479 69,-479 75,-485 75,-491 75,-491 75,-503 75,-503 75,-509 69,-515 63,-515"/>
<text text-anchor="middle" x="45.5" y="-493.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">propose</text>
</g>
<!-- read_index -->
<g id="node8" class="node">
<title>read_index</title>
<path fill="none" stroke="#1c2123" d="M463,-479C463,-479 410,-479 410,-479 404,-479 398,-473 398,-467 398,-467 398,-455 398,-455 398,-449 404,-443 410,-443 410,-443 463,-443 463,-443 469,-443 475,-449 475,-455 475,-455 475,-467 475,-467 475,-473 469,-479 463,-479"/>
<text text-anchor="middle" x="436.5" y="-457.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">read_index</text>
</g>
<!-- propose&#45;&gt;read_index -->
<g id="edge3" class="edge">
<title>propose&#45;&gt;read_index</title>
<path fill="none" stroke="#666666" d="M75.14,-484.23C86.23,-479.49 99.11,-474.24 111,-470 216.68,-432.33 250.61,-429.56 362,-443 370.44,-444.02 379.3,-445.67 387.84,-447.57"/>
<polygon fill="#666666" stroke="#666666" points="387.14,-451 397.67,-449.9 388.75,-444.19 387.14,-451"/>
</g>
<!-- read_local -->
<g id="node9" class="node">
<title>read_local</title>
<path fill="none" stroke="#1c2123" d="M461,-551C461,-551 412,-551 412,-551 406,-551 400,-545 400,-539 400,-539 400,-527 400,-527 400,-521 406,-515 412,-515 412,-515 461,-515 461,-515 467,-515 473,-521 473,-527 473,-527 473,-539 473,-539 473,-545 467,-551 461,-551"/>
<text text-anchor="middle" x="436.5" y="-529.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">read_local</text>
</g>
<!-- propose&#45;&gt;read_local -->
<g id="edge4" class="edge">
<title>propose&#45;&gt;read_local</title>
<path fill="none" stroke="#666666" d="M75.14,-509.77C86.23,-514.51 99.11,-519.76 111,-524 216.68,-561.67 250.61,-564.44 362,-551 371.2,-549.89 380.9,-548.03 390.14,-545.91"/>
<polygon fill="#666666" stroke="#666666" points="391.04,-549.29 399.93,-543.53 389.39,-542.49 391.04,-549.29"/>
</g>
<!-- inspect -->
<g id="node10" class="node">
<title>inspect</title>
<path fill="none" stroke="#1c2123" d="M154,-515C154,-515 123,-515 123,-515 117,-515 111,-509 111,-503 111,-503 111,-491 111,-491 111,-485 117,-479 123,-479 123,-479 154,-479 154,-479 160,-479 166,-485 166,-491 166,-491 166,-503 166,-503 166,-509 160,-515 154,-515"/>
<text text-anchor="middle" x="138.5" y="-493.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">inspect</text>
</g>
<!-- propose&#45;&gt;inspect -->
<g id="edge5" class="edge">
<title>propose&#45;&gt;inspect</title>
<path fill="none" stroke="#666666" d="M75.29,-497C83.36,-497 92.25,-497 100.71,-497"/>
<polygon fill="#666666" stroke="#666666" points="100.75,-500.5 110.75,-497 100.75,-493.5 100.75,-500.5"/>
</g>
<!-- read_index&#45;&gt;raft_group_raft_pending_read_count -->
<g id="edge10" class="edge">
<title>read_index&#45;&gt;raft_group_raft_pending_read_count</title>
<path fill="none" stroke="#b83b5e" d="M438.18,-442.78C440.74,-397.07 452.94,-275.64 511,-198 522.7,-182.35 539.71,-169.75 556.25,-160.16"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="558.29,-163.03 565.36,-155.13 554.91,-156.9 558.29,-163.03"/>
</g>
<!-- read_index&#45;&gt;raft_group_raft_ready_read_count -->
<g id="edge11" class="edge">
<title>read_index&#45;&gt;raft_group_raft_ready_read_count</title>
<path fill="none" stroke="#b83b5e" d="M438.86,-442.94C444.08,-378.28 464.91,-159.6 511,-110 516.9,-103.65 524.14,-98.7 531.98,-94.86"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="533.6,-97.98 541.42,-90.84 530.85,-91.54 533.6,-97.98"/>
</g>
<!-- read_index&#45;&gt;raft_group_read_index -->
<g id="edge12" class="edge">
<title>read_index&#45;&gt;raft_group_read_index</title>
<path fill="none" stroke="#b83b5e" d="M437.85,-442.66C439.66,-370.25 450.39,-105.63 511,-55 579.42,2.15 685.19,-30.97 756.9,-65.21"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="755.39,-68.37 765.91,-69.6 758.45,-62.08 755.39,-68.37"/>
</g>
<!-- pre_read_index -->
<g id="node13" class="node">
<title>pre_read_index</title>
<path fill="none" stroke="#1c2123" d="M571,-535C571,-535 648,-535 648,-535 654,-535 660,-541 660,-547 660,-547 660,-569 660,-569 660,-575 654,-581 648,-581 648,-581 571,-581 571,-581 565,-581 559,-575 559,-569 559,-569 559,-547 559,-547 559,-541 565,-535 571,-535"/>
<text text-anchor="middle" x="609.5" y="-565.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pre_read_index</text>
<polyline fill="none" stroke="#1c2123" points="559,-558 660,-558 "/>
<text text-anchor="middle" x="609.5" y="-542.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">做一些检查</text>
</g>
<!-- read_index&#45;&gt;pre_read_index -->
<g id="edge13" class="edge">
<title>read_index&#45;&gt;pre_read_index</title>
<path fill="none" stroke="#b83b5e" d="M456.58,-479.03C470.76,-491.73 491.02,-508.46 511,-520 522.96,-526.91 536.42,-533.07 549.43,-538.31"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="548.21,-541.59 558.8,-541.97 550.75,-535.07 548.21,-541.59"/>
</g>
<!-- is_leader -->
<g id="node14" class="node">
<title>is_leader</title>
<path fill="none" stroke="#1c2123" d="M630,-705C630,-705 589,-705 589,-705 583,-705 577,-699 577,-693 577,-693 577,-681 577,-681 577,-675 583,-669 589,-669 589,-669 630,-669 630,-669 636,-669 642,-675 642,-681 642,-681 642,-693 642,-693 642,-699 636,-705 630,-705"/>
<text text-anchor="middle" x="609.5" y="-683.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">is_leader</text>
</g>
<!-- read_index&#45;&gt;is_leader -->
<g id="edge14" class="edge">
<title>read_index&#45;&gt;is_leader</title>
<path fill="none" stroke="#b83b5e" d="M455.95,-479.37C462.78,-487.06 470.06,-496.42 475,-506 503.84,-561.96 470.35,-594.93 511,-643 525.36,-659.98 547.62,-670.71 567.25,-677.31"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="566.34,-680.69 576.93,-680.31 568.41,-674 566.34,-680.69"/>
</g>
<!-- inspect_lease -->
<g id="node15" class="node">
<title>inspect_lease</title>
<path fill="none" stroke="#1c2123" d="M867.5,-813C867.5,-813 802.5,-813 802.5,-813 796.5,-813 790.5,-807 790.5,-801 790.5,-801 790.5,-789 790.5,-789 790.5,-783 796.5,-777 802.5,-777 802.5,-777 867.5,-777 867.5,-777 873.5,-777 879.5,-783 879.5,-789 879.5,-789 879.5,-801 879.5,-801 879.5,-807 873.5,-813 867.5,-813"/>
<text text-anchor="middle" x="835" y="-791.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">inspect_lease</text>
</g>
<!-- read_index&#45;&gt;inspect_lease -->
<g id="edge15" class="edge">
<title>read_index&#45;&gt;inspect_lease</title>
<path fill="none" stroke="#b83b5e" d="M456.48,-479.12C463.39,-486.76 470.58,-496.17 475,-506 518.86,-603.58 435.6,-668.11 511,-744 581.55,-815.01 708.15,-812.4 780.12,-803.89"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="780.85,-807.33 790.33,-802.6 779.97,-800.38 780.85,-807.33"/>
</g>
<!-- get_store_commit_index -->
<g id="node16" class="node">
<title>get_store_commit_index</title>
<path fill="none" stroke="#1c2123" d="M899,-705C899,-705 771,-705 771,-705 765,-705 759,-699 759,-693 759,-693 759,-681 759,-681 759,-675 765,-669 771,-669 771,-669 899,-669 899,-669 905,-669 911,-675 911,-681 911,-681 911,-693 911,-693 911,-699 905,-705 899,-705"/>
<text text-anchor="middle" x="835" y="-683.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">get_store_commit_index</text>
</g>
<!-- read_index&#45;&gt;get_store_commit_index -->
<g id="edge16" class="edge">
<title>read_index&#45;&gt;get_store_commit_index</title>
<path fill="none" stroke="#b83b5e" d="M455.28,-479.1C462.18,-486.88 469.68,-496.39 475,-506 499.91,-551.01 472.86,-581.49 511,-616 512.13,-617.02 653.36,-647.82 748.68,-668.51"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="748.1,-671.97 758.62,-670.67 749.59,-665.13 748.1,-671.97"/>
</g>
<!-- pending_reads_back_mut -->
<g id="node17" class="node">
<title>pending_reads_back_mut</title>
<path fill="none" stroke="#1c2123" d="M901,-623C901,-623 769,-623 769,-623 763,-623 757,-617 757,-611 757,-611 757,-599 757,-599 757,-593 763,-587 769,-587 769,-587 901,-587 901,-587 907,-587 913,-593 913,-599 913,-599 913,-611 913,-611 913,-617 907,-623 901,-623"/>
<text text-anchor="middle" x="835" y="-601.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pending_reads_back_mut</text>
</g>
<!-- read_index&#45;&gt;pending_reads_back_mut -->
<g id="edge17" class="edge">
<title>read_index&#45;&gt;pending_reads_back_mut</title>
<path fill="none" stroke="#b83b5e" d="M454.87,-479.33C461.71,-487.15 469.28,-496.62 475,-506 496.36,-541.03 477.3,-567.61 511,-591 579.67,-638.66 677.75,-635.61 747.79,-624.72"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="748.61,-628.13 757.91,-623.06 747.48,-621.22 748.61,-628.13"/>
</g>
<!-- read_push_command -->
<g id="node18" class="node">
<title>read_push_command</title>
<path fill="none" stroke="#1c2123" d="M890,-759C890,-759 780,-759 780,-759 774,-759 768,-753 768,-747 768,-747 768,-735 768,-735 768,-729 774,-723 780,-723 780,-723 890,-723 890,-723 896,-723 902,-729 902,-735 902,-735 902,-747 902,-747 902,-753 896,-759 890,-759"/>
<text text-anchor="middle" x="835" y="-737.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">read_push_command</text>
</g>
<!-- read_index&#45;&gt;read_push_command -->
<g id="edge18" class="edge">
<title>read_index&#45;&gt;read_push_command</title>
<path fill="none" stroke="#b83b5e" d="M456.38,-479.17C463.27,-486.82 470.48,-496.22 475,-506 514.37,-591.16 441.81,-650.64 511,-714 576.8,-774.25 684.98,-770.23 757.82,-758.44"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="758.58,-761.86 767.85,-756.73 757.4,-754.96 758.58,-761.86"/>
</g>
<!-- bcast_wake_up_message -->
<g id="node19" class="node">
<title>bcast_wake_up_message</title>
<path fill="none" stroke="#1c2123" d="M674,-246C674,-246 545,-246 545,-246 539,-246 533,-240 533,-234 533,-234 533,-222 533,-222 533,-216 539,-210 545,-210 545,-210 674,-210 674,-210 680,-210 686,-216 686,-222 686,-222 686,-234 686,-234 686,-240 680,-246 674,-246"/>
<text text-anchor="middle" x="609.5" y="-224.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">bcast_wake_up_message</text>
</g>
<!-- read_index&#45;&gt;bcast_wake_up_message -->
<g id="edge19" class="edge">
<title>read_index&#45;&gt;bcast_wake_up_message</title>
<path fill="none" stroke="#b83b5e" d="M438.55,-442.87C441.88,-402.88 455.53,-306.59 511,-255 514.84,-251.43 519.11,-248.32 523.66,-245.62"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="525.45,-248.64 532.71,-240.92 522.22,-242.42 525.45,-248.64"/>
</g>
<!-- PdTask_QueryRegionLeader -->
<g id="node20" class="node">
<title>PdTask_QueryRegionLeader</title>
<path fill="none" stroke="#1c2123" d="M684.5,-300C684.5,-300 534.5,-300 534.5,-300 528.5,-300 522.5,-294 522.5,-288 522.5,-288 522.5,-276 522.5,-276 522.5,-270 528.5,-264 534.5,-264 534.5,-264 684.5,-264 684.5,-264 690.5,-264 696.5,-270 696.5,-276 696.5,-276 696.5,-288 696.5,-288 696.5,-294 690.5,-300 684.5,-300"/>
<text text-anchor="middle" x="609.5" y="-278.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">PdTask_QueryRegionLeader</text>
</g>
<!-- read_index&#45;&gt;PdTask_QueryRegionLeader -->
<g id="edge20" class="edge">
<title>read_index&#45;&gt;PdTask_QueryRegionLeader</title>
<path fill="none" stroke="#b83b5e" d="M441.17,-442.76C448.57,-410.77 468.35,-344.58 511,-309 512.39,-307.84 513.83,-306.73 515.31,-305.67"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="517.57,-308.38 524.16,-300.08 513.84,-302.45 517.57,-308.38"/>
</g>
<!-- pd_scheduler_schedule -->
<g id="node21" class="node">
<title>pd_scheduler_schedule</title>
<path fill="none" stroke="#1c2123" d="M669,-354C669,-354 550,-354 550,-354 544,-354 538,-348 538,-342 538,-342 538,-330 538,-330 538,-324 544,-318 550,-318 550,-318 669,-318 669,-318 675,-318 681,-324 681,-330 681,-330 681,-342 681,-342 681,-348 675,-354 669,-354"/>
<text text-anchor="middle" x="609.5" y="-332.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">pd_scheduler_schedule</text>
</g>
<!-- read_index&#45;&gt;pd_scheduler_schedule -->
<g id="edge21" class="edge">
<title>read_index&#45;&gt;pd_scheduler_schedule</title>
<path fill="none" stroke="#b83b5e" d="M446.29,-442.93C457.99,-420.77 480.78,-383.62 511,-363 516.33,-359.36 522.14,-356.21 528.18,-353.49"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="529.9,-356.56 537.83,-349.54 527.25,-350.09 529.9,-356.56"/>
</g>
<!-- should_wake_up -->
<g id="node22" class="node">
<title>should_wake_up</title>
<path fill="none" stroke="#1c2123" d="M651.5,-408C651.5,-408 567.5,-408 567.5,-408 561.5,-408 555.5,-402 555.5,-396 555.5,-396 555.5,-384 555.5,-384 555.5,-378 561.5,-372 567.5,-372 567.5,-372 651.5,-372 651.5,-372 657.5,-372 663.5,-378 663.5,-384 663.5,-384 663.5,-396 663.5,-396 663.5,-402 657.5,-408 651.5,-408"/>
<text text-anchor="middle" x="609.5" y="-386.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">should_wake_up</text>
</g>
<!-- read_index&#45;&gt;should_wake_up -->
<g id="edge22" class="edge">
<title>read_index&#45;&gt;should_wake_up</title>
<path fill="none" stroke="#b83b5e" d="M464.57,-442.97C478.09,-434.54 494.96,-424.87 511,-418 521.94,-413.32 533.9,-409.15 545.58,-405.56"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="546.7,-408.88 555.29,-402.69 544.71,-402.17 546.7,-408.88"/>
</g>
<!-- Uuid_new_v4 -->
<g id="node23" class="node">
<title>Uuid_new_v4</title>
<path fill="#feed9b" stroke="#f7e495" d="M523,-427C523,-427 696,-427 696,-427 702,-427 708,-433 708,-439 708,-439 708,-483 708,-483 708,-489 702,-495 696,-495 696,-495 523,-495 523,-495 517,-495 511,-489 511,-483 511,-483 511,-439 511,-439 511,-433 517,-427 523,-427"/>
<text text-anchor="start" x="519" y="-479.8" font-family="Times,serif" font-size="14.00" fill="#40575d">id = Uuid::new_v4()</text>
<text text-anchor="start" x="519" y="-464.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> 生成唯一的id</text>
<text text-anchor="start" x="519" y="-449.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> 作为readctx传入raft中</text>
<text text-anchor="start" x="519" y="-434.8" font-family="Times,serif" font-size="14.00" fill="#40575d"> 在ready时候，raft会回传回来</text>
</g>
<!-- read_index&#45;&gt;Uuid_new_v4 -->
<g id="edge23" class="edge">
<title>read_index&#45;&gt;Uuid_new_v4</title>
<path fill="none" stroke="#b83b5e" d="M475.03,-461C482.97,-461 491.73,-461 500.85,-461"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="500.86,-464.5 510.86,-461 500.86,-457.5 500.86,-464.5"/>
</g>
<!-- ReadIndexRequest -->
<g id="node24" class="node">
<title>ReadIndexRequest</title>
<path fill="#feed9b" stroke="#f7e495" d="M756,-210.5C756,-210.5 914,-210.5 914,-210.5 920,-210.5 926,-216.5 926,-222.5 926,-222.5 926,-305.5 926,-305.5 926,-311.5 920,-317.5 914,-317.5 914,-317.5 756,-317.5 756,-317.5 750,-317.5 744,-311.5 744,-305.5 744,-305.5 744,-222.5 744,-222.5 744,-216.5 750,-210.5 756,-210.5"/>
<text text-anchor="middle" x="835" y="-302.3" font-family="Times,serif" font-size="14.00" fill="#40575d">ReadIndexRequest</text>
<polyline fill="none" stroke="#f7e495" points="744,-294.5 926,-294.5 "/>
<text text-anchor="start" x="752" y="-279.3" font-family="Times,serif" font-size="14.00" fill="#40575d">id</text>
<polyline fill="none" stroke="#f7e495" points="744,-271.5 926,-271.5 "/>
<text text-anchor="start" x="752" y="-256.3" font-family="Times,serif" font-size="14.00" fill="#40575d">req: RaftCmdRequest</text>
<polyline fill="none" stroke="#f7e495" points="744,-248.5 926,-248.5 "/>
<text text-anchor="start" x="752" y="-233.3" font-family="Times,serif" font-size="14.00" fill="#40575d">cb: Callback</text>
<text text-anchor="start" x="752" y="-218.3" font-family="Times,serif" font-size="14.00" fill="#40575d"> renew_lease_time: TimeSpec</text>
</g>
<!-- read_index&#45;&gt;ReadIndexRequest -->
<g id="edge24" class="edge">
<title>read_index&#45;&gt;ReadIndexRequest</title>
<path fill="none" stroke="#b83b5e" d="M460.49,-479.2C474.28,-488.93 492.65,-499.93 511,-505 553.2,-516.66 674.1,-532.7 708,-505 770.16,-454.21 700.23,-395.3 744,-328 744.43,-327.34 744.87,-326.68 745.32,-326.03"/>
<polygon fill="#b83b5e" stroke="#b83b5e" points="748.32,-327.86 751.64,-317.8 742.77,-323.6 748.32,-327.86"/>
</g>
<!-- RequestPolicy_ReadLocal -->
<g id="node11" class="node">
<title>RequestPolicy_ReadLocal</title>
<path fill="none" stroke="#1c2123" d="M350,-542C350,-542 214,-542 214,-542 208,-542 202,-536 202,-530 202,-530 202,-518 202,-518 202,-512 208,-506 214,-506 214,-506 350,-506 350,-506 356,-506 362,-512 362,-518 362,-518 362,-530 362,-530 362,-536 356,-542 350,-542"/>
<text text-anchor="middle" x="282" y="-520.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RequestPolicy_ReadLocal</text>
</g>
<!-- inspect&#45;&gt;RequestPolicy_ReadLocal -->
<g id="edge6" class="edge">
<title>inspect&#45;&gt;RequestPolicy_ReadLocal</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M166.12,-502.08C173.84,-503.55 182.73,-505.25 192.08,-507.03"/>
<polygon fill="green" stroke="green" points="191.47,-510.48 201.95,-508.92 192.79,-503.6 191.47,-510.48"/>
</g>
<!-- RequestPolicy_ReadIndex -->
<g id="node12" class="node">
<title>RequestPolicy_ReadIndex</title>
<path fill="none" stroke="#1c2123" d="M350,-488C350,-488 214,-488 214,-488 208,-488 202,-482 202,-476 202,-476 202,-464 202,-464 202,-458 208,-452 214,-452 214,-452 350,-452 350,-452 356,-452 362,-458 362,-464 362,-464 362,-476 362,-476 362,-482 356,-488 350,-488"/>
<text text-anchor="middle" x="282" y="-466.3" font-family="Times,serif" font-size="14.00" fill="#2f3638">RequestPolicy_ReadIndex</text>
</g>
<!-- inspect&#45;&gt;RequestPolicy_ReadIndex -->
<g id="edge7" class="edge">
<title>inspect&#45;&gt;RequestPolicy_ReadIndex</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M166.12,-491.92C173.84,-490.45 182.73,-488.75 192.08,-486.97"/>
<polygon fill="green" stroke="green" points="192.79,-490.4 201.95,-485.08 191.47,-483.52 192.79,-490.4"/>
</g>
<!-- RequestPolicy_ReadLocal&#45;&gt;read_local -->
<g id="edge9" class="edge">
<title>RequestPolicy_ReadLocal&#45;&gt;read_local</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M362.38,-528.68C371.74,-529.24 381.04,-529.79 389.71,-530.3"/>
<polygon fill="green" stroke="green" points="389.75,-533.81 399.94,-530.9 390.17,-526.82 389.75,-533.81"/>
</g>
<!-- RequestPolicy_ReadIndex&#45;&gt;read_index -->
<g id="edge8" class="edge">
<title>RequestPolicy_ReadIndex&#45;&gt;read_index</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M362.38,-465.32C370.93,-464.81 379.43,-464.31 387.45,-463.84"/>
<polygon fill="green" stroke="green" points="387.9,-467.32 397.68,-463.23 387.49,-460.33 387.9,-467.32"/>
</g>
<!-- is_splitting -->
<g id="node27" class="node">
<title>is_splitting</title>
<path fill="none" stroke="#1c2123" d="M762,-432C762,-432 908,-432 908,-432 914,-432 920,-438 920,-444 920,-444 920,-496 920,-496 920,-502 914,-508 908,-508 908,-508 762,-508 762,-508 756,-508 750,-502 750,-496 750,-496 750,-444 750,-444 750,-438 756,-432 762,-432"/>
<text text-anchor="middle" x="835" y="-492.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">if is_splitting()</text>
<polyline fill="none" stroke="#1c2123" points="750,-485 920,-485 "/>
<text text-anchor="start" x="758" y="-469.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果正在splitting</text>
<text text-anchor="start" x="758" y="-454.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 返回错误</text>
<text text-anchor="middle" x="835" y="-439.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> Error::ReadIndexNotReady</text>
</g>
<!-- pre_read_index&#45;&gt;is_splitting -->
<g id="edge37" class="edge">
<title>pre_read_index&#45;&gt;is_splitting</title>
<path fill="none" stroke="#666666" d="M660.12,-538.73C675.48,-532.75 692.45,-526.12 708,-520 718.5,-515.87 729.49,-511.53 740.42,-507.21"/>
<polygon fill="#666666" stroke="#666666" points="741.98,-510.36 749.99,-503.42 739.4,-503.85 741.98,-510.36"/>
</g>
<!-- is_merging -->
<g id="node28" class="node">
<title>is_merging</title>
<path fill="none" stroke="#1c2123" d="M762,-337C762,-337 908,-337 908,-337 914,-337 920,-343 920,-349 920,-349 920,-401 920,-401 920,-407 914,-413 908,-413 908,-413 762,-413 762,-413 756,-413 750,-407 750,-401 750,-401 750,-349 750,-349 750,-343 756,-337 762,-337"/>
<text text-anchor="middle" x="835" y="-397.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">if self.is_merging()</text>
<polyline fill="none" stroke="#1c2123" points="750,-390 920,-390 "/>
<text text-anchor="start" x="758" y="-374.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">如果正在splitting</text>
<text text-anchor="start" x="758" y="-359.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 返回错误</text>
<text text-anchor="start" x="758" y="-344.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> Error::ReadIndexNotReady</text>
</g>
<!-- pre_read_index&#45;&gt;is_merging -->
<g id="edge38" class="edge">
<title>pre_read_index&#45;&gt;is_merging</title>
<path fill="none" stroke="#666666" d="M660.04,-547.55C677.06,-541.84 695.07,-533.14 708,-520 740.25,-487.22 713.74,-457.63 744,-423 744.85,-422.02 745.73,-421.07 746.63,-420.12"/>
<polygon fill="#666666" stroke="#666666" points="749.07,-422.63 753.93,-413.22 744.26,-417.55 749.07,-422.63"/>
</g>
<!-- is_leader&#45;&gt;inspect_lease -->
<g id="edge28" class="edge">
<title>is_leader&#45;&gt;inspect_lease</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M636.02,-705.19C662.13,-723.14 704.37,-750.38 744,-768 755.53,-773.13 768.3,-777.62 780.52,-781.39"/>
<polygon fill="green" stroke="green" points="779.58,-784.76 790.16,-784.26 781.58,-778.06 779.58,-784.76"/>
</g>
<!-- is_leader&#45;&gt;get_store_commit_index -->
<g id="edge29" class="edge">
<title>is_leader&#45;&gt;get_store_commit_index</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M642.05,-687C669.65,-687 711.06,-687 748.36,-687"/>
<polygon fill="green" stroke="green" points="748.76,-690.5 758.76,-687 748.76,-683.5 748.76,-690.5"/>
</g>
<!-- is_leader&#45;&gt;pending_reads_back_mut -->
<g id="edge30" class="edge">
<title>is_leader&#45;&gt;pending_reads_back_mut</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M642.21,-670.77C668.84,-657.61 708.19,-639.31 744,-627 745.03,-626.65 746.06,-626.3 747.1,-625.95"/>
<polygon fill="green" stroke="green" points="748.17,-629.28 756.65,-622.93 746.06,-622.61 748.17,-629.28"/>
</g>
<!-- is_leader&#45;&gt;read_push_command -->
<g id="edge31" class="edge">
<title>is_leader&#45;&gt;read_push_command</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M642.05,-694.62C672,-701.86 718.19,-713.02 757.76,-722.58"/>
<polygon fill="green" stroke="green" points="757.12,-726.03 767.66,-724.97 758.77,-719.22 757.12,-726.03"/>
</g>
<!-- pending_reads -->
<g id="node26" class="node">
<title>pending_reads</title>
<path fill="#feed9b" stroke="#f7e495" d="M1214,-541C1214,-541 1482,-541 1482,-541 1488,-541 1494,-547 1494,-553 1494,-553 1494,-575 1494,-575 1494,-581 1488,-587 1482,-587 1482,-587 1214,-587 1214,-587 1208,-587 1202,-581 1202,-575 1202,-575 1202,-553 1202,-553 1202,-547 1208,-541 1214,-541"/>
<text text-anchor="middle" x="1348" y="-571.8" font-family="Times,serif" font-size="14.00" fill="#40575d">pending_reads</text>
<polyline fill="none" stroke="#f7e495" points="1202,-564 1494,-564 "/>
<text text-anchor="start" x="1210" y="-548.8" font-family="Times,serif" font-size="14.00" fill="#40575d">pending_reads: ReadIndexQueue&lt;EK::Snapshot&gt;,</text>
</g>
<!-- pending_reads_back_mut&#45;&gt;pending_reads -->
<g id="edge35" class="edge">
<title>pending_reads_back_mut&#45;&gt;pending_reads</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M913.27,-609.97C929.37,-610.82 946.23,-611.56 962,-612 1052.63,-614.52 1076.09,-623.72 1166,-612 1199.6,-607.62 1235.84,-598.85 1267,-589.99"/>
<polygon fill="green" stroke="green" points="1268.3,-593.26 1276.93,-587.12 1266.35,-586.54 1268.3,-593.26"/>
</g>
<!-- Uuid_new_v4&#45;&gt;raft_group_read_index -->
<g id="edge25" class="edge">
<title>Uuid_new_v4&#45;&gt;raft_group_read_index</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M698.9,-426.8C702.22,-423.79 705.29,-420.53 708,-417 768.08,-338.77 698.72,-285.63 744,-198 750.64,-185.15 759.81,-173.03 769.78,-162.1"/>
<polygon fill="green" stroke="green" points="772.43,-164.4 776.78,-154.74 767.36,-159.57 772.43,-164.4"/>
</g>
<!-- Uuid_new_v4&#45;&gt;ReadIndexRequest -->
<g id="edge26" class="edge">
<title>Uuid_new_v4&#45;&gt;ReadIndexRequest</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M697.08,-426.7C700.98,-423.71 704.65,-420.48 708,-417 737.57,-386.24 717.55,-361.48 744,-328 744.8,-326.98 745.62,-325.98 746.47,-324.98"/>
<polygon fill="green" stroke="green" points="749.11,-327.27 753.25,-317.52 743.93,-322.56 749.11,-327.27"/>
</g>
<!-- pending_reads_push_back -->
<g id="node25" class="node">
<title>pending_reads_push_back</title>
<path fill="none" stroke="#1c2123" d="M974,-526C974,-526 1154,-526 1154,-526 1160,-526 1166,-532 1166,-538 1166,-538 1166,-590 1166,-590 1166,-596 1160,-602 1154,-602 1154,-602 974,-602 974,-602 968,-602 962,-596 962,-590 962,-590 962,-538 962,-538 962,-532 968,-526 974,-526"/>
<text text-anchor="middle" x="1064" y="-586.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">pending_reads_push_back</text>
<polyline fill="none" stroke="#1c2123" points="962,-579 1166,-579 "/>
<text text-anchor="start" x="970" y="-563.8" font-family="Times,serif" font-size="14.00" fill="#2f3638">将ReadIndexRequest放入队列中</text>
<text text-anchor="start" x="970" y="-548.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> 并且放入ctx Hashmap中</text>
<text text-anchor="start" x="970" y="-533.8" font-family="Times,serif" font-size="14.00" fill="#2f3638"> key为id</text>
</g>
<!-- ReadIndexRequest&#45;&gt;pending_reads_push_back -->
<g id="edge27" class="edge">
<title>ReadIndexRequest&#45;&gt;pending_reads_push_back</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M915.7,-317.64C919.31,-321 922.77,-324.46 926,-328 978.18,-385.22 1019.58,-465.59 1042.69,-516.22"/>
<polygon fill="green" stroke="green" points="1039.63,-517.94 1046.93,-525.62 1046.01,-515.07 1039.63,-517.94"/>
</g>
<!-- pending_reads_push_back&#45;&gt;context_insert -->
<g id="edge33" class="edge">
<title>pending_reads_push_back&#45;&gt;context_insert</title>
<path fill="none" stroke="#666666" d="M1064.58,-525.77C1065.76,-437.79 1081.44,-219.52 1202,-102 1225.65,-78.95 1261.4,-69.16 1291.48,-65.15"/>
<polygon fill="#666666" stroke="#666666" points="1291.91,-68.63 1301.44,-64.01 1291.11,-61.68 1291.91,-68.63"/>
</g>
<!-- pending_reads_push_back&#45;&gt;reads_push_back -->
<g id="edge34" class="edge">
<title>pending_reads_push_back&#45;&gt;reads_push_back</title>
<path fill="none" stroke="#666666" d="M1089.78,-525.78C1145.84,-439.29 1281.3,-230.34 1329.56,-155.9"/>
<polygon fill="#666666" stroke="#666666" points="1332.76,-157.4 1335.26,-147.1 1326.89,-153.59 1332.76,-157.4"/>
</g>
<!-- pending_reads_push_back&#45;&gt;pending_reads -->
<g id="edge36" class="edge">
<title>pending_reads_push_back&#45;&gt;pending_reads</title>
<path fill="none" stroke="green" stroke-dasharray="5,2" d="M1166.01,-564C1174.42,-564 1183.03,-564 1191.72,-564"/>
<polygon fill="green" stroke="green" points="1191.94,-567.5 1201.94,-564 1191.94,-560.5 1191.94,-567.5"/>
</g>
<!-- pending_reads&#45;&gt;ReadIndexQueue -->
<g id="edge32" class="edge">
<title>pending_reads&#45;&gt;ReadIndexQueue</title>
<path fill="none" stroke="#666666" d="M1363.81,-540.95C1407.06,-473.61 1534.64,-274.96 1606.08,-163.72"/>
<polygon fill="#666666" stroke="#666666" points="1609.09,-165.51 1611.55,-155.21 1603.2,-161.73 1609.09,-165.51"/>
</g>
</g>
</svg>
