#include "styles.h"
digraph async_commit_execute {
  node[shape=box;style="rounded";color="#1c2123";fontcolor="#2f3638"];
  edge[color=gray40];
  newrank=true;
  rankdir=LR;

  subgraph cluster_twoPhaseCommitter {
    graph[label="twoPhaseCommitter";fontsize=20;style="rounded,dashed";color="slategrey"]
    execute -> {
      checkAsyncCommit;
      setAsyncCommit;
      prewriteMutations;
      go_commitMutations;
    }
    checkAsyncCommit -> setAsyncCommit[style_edge_data];
    go_commitMutations[style_func;label="{{
      go commitMutations|
      新起一个go routine 执行\l
      commitMutations\l
    }}"]
    go_commitMutations -> commitMutations;
    prewriteMutations[style_func;label="{{
      prewriteMutations|
      在prewriteMutation完成之后\l
      就可以告诉client事务\l 
      提交成功了\l
    }}"]
  }
}
